<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>CTF-WP-1 | hahbiubiubiu</title><meta name="keywords" content="Reverse,CTF"><meta name="author" content="hahbiubiubiu"><meta name="copyright" content="hahbiubiubiu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="巅峰极客2023wp1:巅峰极客 2023 逆向 Writeup - s11nk - 博客园 (cnblogs.com) g0Re还原特征码   即可upx脱壳。 程序逻辑首先是一个AES加密，调试可以得出加密函数：   然后一个换表了的base64：  最后与key异或，然后比较：  exp123456789101112131415161718192021222324252627import b">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF-WP-1">
<meta property="og:url" content="http://hahbiubiubiu.github.io/2023/11/21/CTF-wp-1/index.html">
<meta property="og:site_name" content="hahbiubiubiu">
<meta property="og:description" content="巅峰极客2023wp1:巅峰极客 2023 逆向 Writeup - s11nk - 博客园 (cnblogs.com) g0Re还原特征码   即可upx脱壳。 程序逻辑首先是一个AES加密，调试可以得出加密函数：   然后一个换表了的base64：  最后与key异或，然后比较：  exp123456789101112131415161718192021222324252627import b">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://hahbiubiubiu.github.io/img/preview.jpg">
<meta property="article:published_time" content="2023-11-21T03:49:36.000Z">
<meta property="article:modified_time" content="2023-11-21T05:35:56.694Z">
<meta property="article:author" content="hahbiubiubiu">
<meta property="article:tag" content="Reverse">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://hahbiubiubiu.github.io/img/preview.jpg"><link rel="shortcut icon" href="/./img/Valkyrie.jpg"><link rel="canonical" href="http://hahbiubiubiu.github.io/2023/11/21/CTF-wp-1/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":100},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CTF-WP-1',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-11-21 13:35:56'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./img/Valkyrie.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa fa-sitemap"></i><span> 站点</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://0x3.com"><i class="fa-fw fa fa-paper-plane"></i><span> 我的导航</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.bilibili.com/"><i class="fa-fw fa fa fa-window-restore"></i><span> BilBil</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-bookmark"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/./img/preview.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">hahbiubiubiu</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa fa-sitemap"></i><span> 站点</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://0x3.com"><i class="fa-fw fa fa-paper-plane"></i><span> 我的导航</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.bilibili.com/"><i class="fa-fw fa fa fa-window-restore"></i><span> BilBil</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-bookmark"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">CTF-WP-1</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-11-21T03:49:36.000Z" title="发表于 2023-11-21 11:49:36">2023-11-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-11-21T05:35:56.694Z" title="更新于 2023-11-21 13:35:56">2023-11-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Reverse/">Reverse</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="CTF-WP-1"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="巅峰极客2023"><a href="#巅峰极客2023" class="headerlink" title="巅峰极客2023"></a>巅峰极客2023</h1><p>wp1:<a target="_blank" rel="noopener" href="https://www.cnblogs.com/gaoyucan/p/17577858.html">巅峰极客 2023 逆向 Writeup - s11nk - 博客园 (cnblogs.com)</a></p>
<h2 id="g0Re"><a href="#g0Re" class="headerlink" title="g0Re"></a>g0Re</h2><h3 id="还原特征码"><a href="#还原特征码" class="headerlink" title="还原特征码"></a>还原特征码</h3><p><img src="/2023/11/21/CTF-wp-1/image-20230801125708417.png" alt="1"></p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230801125740785.png" alt="2"></p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230801125759270.png" alt="3"></p>
<p>即可upx脱壳。</p>
<h3 id="程序逻辑"><a href="#程序逻辑" class="headerlink" title="程序逻辑"></a>程序逻辑</h3><p>首先是一个AES加密，调试可以得出加密函数：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230801170924313.png" alt="加密"></p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230801170937909.png" alt="加密"></p>
<p>然后一个换表了的base64：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230801164047334.png" alt="base64实现部分逻辑"></p>
<p>最后与key异或，然后比较：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230801165034002.png" alt="异或、比较"></p>
<h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">key = [</span><br><span class="line">    <span class="number">0x77</span>, <span class="number">0x76</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x74</span>, <span class="number">0x62</span>, <span class="number">0x79</span>, <span class="number">0x67</span>, <span class="number">0x77</span>, <span class="number">0x62</span>,</span><br><span class="line">    <span class="number">0x6B</span>, <span class="number">0x32</span>, <span class="number">0x62</span>, <span class="number">0x34</span>, <span class="number">0x36</span>, <span class="number">0x64</span></span><br><span class="line">]</span><br><span class="line">uni_base64 = <span class="string">&#x27;456789&#125;#IJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123ABCDEFGH&#x27;</span></span><br><span class="line">std_base64 = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">data = [</span><br><span class="line">    <span class="number">0xC9F5C5CFC889CEE6</span>, <span class="number">0xCCAC7FCE91C0D9D2</span>,</span><br><span class="line">    <span class="number">0x92EAD496C0B7CFE9</span>, <span class="number">0x93AEA5CB84DFD7E2</span>,</span><br><span class="line">    <span class="number">0xC9F0CEDF97BECAA6</span>, <span class="number">0xDB65B1C46BAEE1B7</span>,</span><br><span class="line">    <span class="number">0xC3ED8CD69392EDCE</span>, <span class="number">0xA7B5B2AAA594DAA3</span></span><br><span class="line">]</span><br><span class="line">result = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    result += struct.pack(<span class="string">&#x27;&lt;Q&#x27;</span>, data[i])</span><br><span class="line">result = <span class="built_in">list</span>(result)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)):</span><br><span class="line">    result[i] -= key[i % <span class="number">16</span>]</span><br><span class="line">    result[i] ^= <span class="number">0x1A</span></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> result)</span><br><span class="line">result = result.translate(<span class="built_in">str</span>.maketrans(uni_base64, std_base64))</span><br><span class="line">result = base64.b64decode(result)</span><br><span class="line">result = AES.new(<span class="built_in">bytearray</span>(key), mode=AES.MODE_ECB).decrypt(result)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<h2 id="ezlua"><a href="#ezlua" class="headerlink" title="ezlua"></a>ezlua</h2><p>跟着<a target="_blank" rel="noopener" href="https://www.cnblogs.com/gaoyucan/p/17577858.html">巅峰极客 2023 逆向 Writeup</a>走</p>
<h3 id="程序逻辑-1"><a href="#程序逻辑-1" class="headerlink" title="程序逻辑"></a>程序逻辑</h3><p>程序获取输入，验证是否都为十六进制字符，之后每两位输入组成两位十六进制数放入<code>lua_code[0x59b9:0x59CE]</code>，</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20231013164203497.png"></p>
<p>输入后为<code>lua_code[0x59b9:0x59CE]</code>下断点，在这里被读取了，是<code>lj_buf_ruleb128</code></p>
<p><img src="/2023/11/21/CTF-wp-1/image-20231013170345369.png"></p>
<p>来到其上层函数：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20231013170840450.png"></p>
<p><img src="/2023/11/21/CTF-wp-1/image-20231013170901540.png" alt="师傅的思路"></p>
<p>现输⼊的数据其实是两个 u64 类型的数字使⽤ uleb128 编码成 4 个 32bit 的值，判断依据是 tp 的值均为 3。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20231013173740146.png"></p>
<p>猜测是调用<code>lua</code>变化输入，然后再获取结果，进行比较。</p>
<h3 id="反编译luajit"><a href="#反编译luajit" class="headerlink" title="反编译luajit"></a>反编译luajit</h3><p>将<code>lua_code</code>保存为二进制文件，用<a target="_blank" rel="noopener" href="https://github.com/Dr-MTN/luajit-decompiler">luajit-decompiler</a>反编译。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20231013171232784.png"></p>
<p>查看结果显示的数据是浮点数，根据wp更改，注释掉两行（<code>./luajit-decompiler/ljd/rawdump/constants.py</code>）再次反编译，即可。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20231013171350002.png"></p>
<p>反编译后逻辑很简单，但有虚假控制流，可以改为python代码，打印下<code>slot2</code>。<br>每一步操作的逻辑：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">slot6 = bit.rshift(slot1, 8)</span><br><span class="line">slot7 = bit.lshift(slot1, 56)</span><br><span class="line">slot4 = bit.bor(slot6, slot7)</span><br><span class="line">slot1 = slot0 + slot4</span><br><span class="line">slot1 = bit.bxor(slot1, slot2)</span><br><span class="line"></span><br><span class="line">slot6 = bit.lshift(slot0, 3)</span><br><span class="line">slot7 = bit.rshift(slot0, 61)</span><br><span class="line">slot4 = bit.bor(slot6, slot7)</span><br><span class="line">slot0 = bit.xor(slot4, slot1)</span><br></pre></td></tr></table></figure>

<h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> leb128</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">u64_to_uleb128</span>(<span class="params">u</span>):</span><br><span class="line">    high = u &gt;&gt; <span class="number">32</span></span><br><span class="line">    low = u &amp; <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">return</span> leb128.u.encode(low).<span class="built_in">hex</span>() + leb128.u.encode(high).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">s0, s1, s2</span>):</span><br><span class="line">    s0 = ((s0 ^ s1) &lt;&lt; <span class="number">61</span> | (s0 ^ s1) &gt;&gt; <span class="number">3</span>) &amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">    t = ((s1 ^ s2) - s0) &amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">    s1 = (t &gt;&gt; <span class="number">56</span> | t &lt;&lt; <span class="number">8</span>) &amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">    <span class="keyword">return</span> s0, s1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">slot2 = [</span><br><span class="line">    <span class="number">0xdeadbeef12345678</span>,</span><br><span class="line">    <span class="number">0x28539dc5904d8141</span>,</span><br><span class="line">    <span class="number">0xf2ac321ccf237a7b</span>,</span><br><span class="line">    <span class="number">0xf03df21e866b1a36</span>,</span><br><span class="line">    <span class="number">0x584cde754c325b4b</span>,</span><br><span class="line">    <span class="number">0x97407269ac231f8b</span>,</span><br><span class="line">    <span class="number">0xd2960ba60ee82d09</span>,</span><br><span class="line">    <span class="number">0xb34efc0e8d197592</span>,</span><br><span class="line">    <span class="number">0x15011adba4d8613d</span>,</span><br><span class="line">    <span class="number">0x1598470b72677cea</span>,</span><br><span class="line">    <span class="number">0xb497efc6db87c606</span>,</span><br><span class="line">    <span class="number">0xae0f3ba8a4eeb218</span>,</span><br><span class="line">    <span class="number">0xab6036ab64121254</span>,</span><br><span class="line">    <span class="number">0x663ae5cc72c5eb7f</span>,</span><br><span class="line">    <span class="number">0x71af0f7e9c371b0e</span>,</span><br><span class="line">    <span class="number">0xeb97fc6b58f9eb33</span>,</span><br><span class="line">    <span class="number">0x774108a83f7c75f6</span>,</span><br><span class="line">    <span class="number">0x5a6542d5c9968681</span>,</span><br><span class="line">    <span class="number">0x5e6fb973117ccfb1</span>,</span><br><span class="line">    <span class="number">0xea8134ba653ce534</span>,</span><br><span class="line">    <span class="number">0xfc92946aa1cc9678</span>,</span><br><span class="line">    <span class="number">0x38af8cc9553071e4</span>,</span><br><span class="line">    <span class="number">0x99f7a1b258084992</span>,</span><br><span class="line">    <span class="number">0x82e920e890bb99da</span>,</span><br><span class="line">    <span class="number">0xc67f72528ed05d6c</span>,</span><br><span class="line">    <span class="number">0x4cab3a53d2598281</span>,</span><br><span class="line">    <span class="number">0x517358620b3249f9</span>,</span><br><span class="line">    <span class="number">0xcf3d41fd5e5e0786</span>,</span><br><span class="line">    <span class="number">0x626be66ab995efe3</span>,</span><br><span class="line">    <span class="number">0x24d85b01f54e2ab1</span>,</span><br><span class="line">    <span class="number">0xe9cd3a65e3f95992</span>,</span><br><span class="line">    <span class="number">0x4bf5996751882d17</span></span><br><span class="line">]</span><br><span class="line">s0, s1 = <span class="number">0xDD26C29515A28396</span>, <span class="number">0xBD722D4BAF99B9C7</span></span><br><span class="line">slot2.reverse()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(slot2)):</span><br><span class="line">    s0, s1 = dec(s0, s1, slot2[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(u64_to_uleb128(s1) + u64_to_uleb128(s0))</span><br></pre></td></tr></table></figure>


<h1 id="CTF2023"><a href="#CTF2023" class="headerlink" title="*CTF2023"></a>*CTF2023</h1><p>wp1:<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_51280668/article/details/132056750">*CTF2023Reverse逆向详解wp_柒傑的博客-CSDN博客</a></p>
<p>wp2:<a target="_blank" rel="noopener" href="http://blog.xmcve.com/2023/07/31/starCTF-2023-Writeup/">*CTF 2023 Writeup - 星盟安全团队 (xmcve.com)</a></p>
<h2 id="ezcode"><a href="#ezcode" class="headerlink" title="ezcode"></a>ezcode</h2><p>更改文件后缀名为ps1，使用PowerShell ISE调试。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230808171225215.png" alt="image-20230808171225215"></p>
<p>单步调试可以看到：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230808171412038.png" alt="image-20230808171412038"></p>
<p>打印前面一长串char可以看到：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230808171449081.png" alt="image-20230808171449081"></p>
<p>再次调试，在使用shift+f10跳出之后，输入：${@*}</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230808171702324.png" alt="image-20230808171702324"></p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230808171643262.png" alt="image-20230808171643262"></p>
<p>打印获取的一长串char，即可看到主逻辑：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">chiper</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.d = <span class="number">0x87654321</span></span><br><span class="line">        k0 = <span class="number">0x67452301</span></span><br><span class="line">        k1 = <span class="number">0xefcdab89</span></span><br><span class="line">        k2 = <span class="number">0x98badcfe</span></span><br><span class="line">        k3 = <span class="number">0x10325476</span></span><br><span class="line">        self.k = [k0, k1, k2, k3]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">e</span>(<span class="params">self, n, v</span>):</span><br><span class="line">        <span class="keyword">from</span> ctypes <span class="keyword">import</span> c_uint32</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">MX</span>(<span class="params">z, y, total, key, p, e</span>):</span><br><span class="line">            temp1 = (z.value &gt;&gt; <span class="number">6</span> ^ y.value &lt;&lt; <span class="number">4</span>) + \</span><br><span class="line">                (y.value &gt;&gt; <span class="number">2</span> ^ z.value &lt;&lt; <span class="number">5</span>)</span><br><span class="line">            temp2 = (total.value ^ y.value) + \</span><br><span class="line">                (key[(p &amp; <span class="number">3</span>) ^ e.value] ^ z.value)</span><br><span class="line">            <span class="keyword">return</span> c_uint32(temp1 ^ temp2)</span><br><span class="line">        key = self.k</span><br><span class="line">        delta = self.d</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>//n</span><br><span class="line">        total = c_uint32(<span class="number">0</span>)</span><br><span class="line">        z = c_uint32(v[n-<span class="number">1</span>])</span><br><span class="line">        e = c_uint32(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> rounds &gt; <span class="number">0</span>:</span><br><span class="line">            total.value += delta</span><br><span class="line">            e.value = (total.value &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">            <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>):</span><br><span class="line">                y = c_uint32(v[p+<span class="number">1</span>])</span><br><span class="line">                v[p] = c_uint32(v[p] + MX(z, y, total, key, p, e).value).value</span><br><span class="line">                z.value = v[p]</span><br><span class="line">            y = c_uint32(v[<span class="number">0</span>])</span><br><span class="line">            v[n-<span class="number">1</span>] = c_uint32(v[n-<span class="number">1</span>] + MX(z, y, total,</span><br><span class="line">                              key, n-<span class="number">1</span>, e).value).value</span><br><span class="line">            z.value = v[n-<span class="number">1</span>]</span><br><span class="line">            rounds -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bytes2ints</span>(<span class="params">self,cs:<span class="built_in">bytes</span></span>)-&gt;<span class="built_in">list</span>:</span><br><span class="line">        new_length=<span class="built_in">len</span>(cs)+(<span class="number">8</span>-<span class="built_in">len</span>(cs)%<span class="number">8</span>)%<span class="number">8</span></span><br><span class="line">        barray=cs.ljust(new_length,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">        i=<span class="number">0</span></span><br><span class="line">        v=[]</span><br><span class="line">        <span class="keyword">while</span> i &lt; new_length:</span><br><span class="line">            v0 = <span class="built_in">int</span>.from_bytes(barray[i:i+<span class="number">4</span>], <span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">            v1 = <span class="built_in">int</span>.from_bytes(barray[i+<span class="number">4</span>:i+<span class="number">8</span>], <span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">            v.append(v0)</span><br><span class="line">            v.append(v1)</span><br><span class="line">            i += <span class="number">8</span></span><br><span class="line">        <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">instr:<span class="built_in">str</span>,checklist:<span class="built_in">list</span></span>)-&gt;<span class="built_in">int</span>:</span><br><span class="line">    length=<span class="built_in">len</span>(instr)</span><br><span class="line">    <span class="keyword">if</span> length%<span class="number">8</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Incorrect format.&quot;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line">    c=chiper()</span><br><span class="line">    v = c.bytes2ints(instr.encode())</span><br><span class="line">    output=<span class="built_in">list</span>(c.e(<span class="built_in">len</span>(v),v))</span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span>(i&lt;<span class="built_in">len</span>(checklist)):</span><br><span class="line">        <span class="keyword">if</span> i&lt;<span class="built_in">len</span>(output) <span class="keyword">and</span> output[i]==checklist[i]:</span><br><span class="line">            i+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> i==<span class="built_in">len</span>(checklist):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    ans=[<span class="number">1374278842</span>, <span class="number">2136006540</span>, <span class="number">4191056815</span>, <span class="number">3248881376</span>]</span><br><span class="line">    <span class="comment"># generateRes()</span></span><br><span class="line">    flag=<span class="built_in">input</span>(<span class="string">&#x27;Please input flag:&#x27;</span>)</span><br><span class="line">    res=check(flag,ans)</span><br><span class="line">    <span class="keyword">if</span> res:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Congratulations, you&#x27;ve got the flag!&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Flag is *ctf&#123;your_input&#125;!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Nope,try again!&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="flagfile"><a href="#flagfile" class="headerlink" title="flagfile"></a>flagfile</h2><h4 id="方法1"><a href="#方法1" class="headerlink" title="方法1"></a>方法1</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用file -d选项调试检测</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(<span class="string">&#x27;flag&#123;&#x27;</span> + <span class="string">&#x27;*&#x27;</span> * (<span class="number">64</span> - <span class="built_in">len</span>(<span class="string">&#x27;flag&#123;&#x27;</span>)))</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">34</span>):</span><br><span class="line">    text = subprocess.run([<span class="string">&#x27;file&#x27;</span>, <span class="string">&#x27;-m&#x27;</span>, <span class="string">&#x27;flag.mgc&#x27;</span>, <span class="string">&#x27;-d&#x27;</span>, <span class="string">&#x27;flag&#x27;</span>],</span><br><span class="line">                          capture_output=<span class="literal">True</span>, text=<span class="literal">True</span>, check=<span class="literal">True</span>).stderr</span><br><span class="line">    <span class="comment"># print(&quot;text:\n&quot;, text, &quot;\ntext end\n&quot;)</span></span><br><span class="line">    <span class="comment"># 2: &gt;&gt; 64 leshort^00000076,=111,&quot;&quot;]</span></span><br><span class="line">    data = re.findall(<span class="string">f&#x27;<span class="subst">&#123;i&#125;</span>: &gt;* (\d+) leshort\^([\da-f]+),=(\d+),&quot;&quot;]&#x27;</span>, text)</span><br><span class="line">    <span class="built_in">print</span>(i, <span class="string">&quot;offset:&quot;</span>, data[<span class="number">0</span>][<span class="number">0</span>], <span class="string">&quot;data:&quot;</span>, data)</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;ab&#x27;</span>)</span><br><span class="line">    f.write((<span class="built_in">int</span>(data[<span class="number">0</span>][<span class="number">1</span>], <span class="number">16</span>) ^ <span class="built_in">int</span>(data[<span class="number">0</span>][<span class="number">2</span>])).to_bytes(<span class="number">2</span>, <span class="string">&#x27;little&#x27;</span>))</span><br><span class="line">    f.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">34</span>, <span class="number">100</span>):</span><br><span class="line">    text = subprocess.run([<span class="string">&#x27;file&#x27;</span>, <span class="string">&#x27;-m&#x27;</span>, <span class="string">&#x27;flag.mgc&#x27;</span>, <span class="string">&#x27;-d&#x27;</span>, <span class="string">&#x27;flag&#x27;</span>],</span><br><span class="line">                          capture_output=<span class="literal">True</span>, text=<span class="literal">True</span>, check=<span class="literal">True</span>).stderr</span><br><span class="line">    <span class="comment"># print(&quot;text:\n&quot;, text, &quot;\ntext end\n&quot;)</span></span><br><span class="line">    <span class="comment"># 34: &gt;&gt; 64(byte,&amp;0), byte^ffffffffffffff8a,=-20,&quot;&quot;]</span></span><br><span class="line">    <span class="comment"># mget/128 @25:</span></span><br><span class="line">    data = re.findall(<span class="string">f&#x27;<span class="subst">&#123;i&#125;</span>: &gt;* \d+\(byte,&amp;0\), byte\^([\da-f]+),=([-\d]+),&quot;&quot;]&#x27;</span>, text)</span><br><span class="line">    off = re.findall(<span class="string">f&#x27;mget/128 @(\d+):&#x27;</span>, text)</span><br><span class="line">    <span class="built_in">print</span>(i, <span class="string">&quot;offset:&quot;</span>, off[-<span class="number">1</span>], <span class="string">&quot;data:&quot;</span>, data)</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;rb+&#x27;</span>)</span><br><span class="line">    f.seek(<span class="built_in">int</span>(off[-<span class="number">1</span>]))</span><br><span class="line">    f.write(((<span class="built_in">int</span>(data[<span class="number">0</span>][<span class="number">0</span>], <span class="number">16</span>) ^ <span class="built_in">int</span>(data[<span class="number">0</span>][<span class="number">1</span>])) &amp; <span class="number">0xff</span>).to_bytes(<span class="number">1</span>, <span class="string">&#x27;little&#x27;</span>))</span><br><span class="line">    f.close()</span><br></pre></td></tr></table></figure>

<h4 id="方法2"><a href="#方法2" class="headerlink" title="方法2"></a>方法2</h4><p>解析mgc文件：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdarg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/param.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span>    <span class="comment">/* Include that here, to make sure __P gets defined */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span>    <span class="comment">/* For open and flags */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXDESC    64        <span class="comment">/* max len of text description/MIME type */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXMIME    80        <span class="comment">/* max len of text MIME type */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXstring 128    </span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">VALUETYPE</span> &#123;</span></span><br><span class="line">    <span class="type">uint8_t</span> b;</span><br><span class="line">    <span class="type">uint16_t</span> h;</span><br><span class="line">    <span class="type">uint32_t</span> l;</span><br><span class="line">    <span class="type">uint64_t</span> q;</span><br><span class="line">    <span class="type">uint8_t</span> hs[<span class="number">2</span>];    <span class="comment">/* 2 bytes of a fixed-endian &quot;short&quot; */</span></span><br><span class="line">    <span class="type">uint8_t</span> hl[<span class="number">4</span>];    <span class="comment">/* 4 bytes of a fixed-endian &quot;long&quot; */</span></span><br><span class="line">    <span class="type">uint8_t</span> hq[<span class="number">8</span>];    <span class="comment">/* 8 bytes of a fixed-endian &quot;quad&quot; */</span></span><br><span class="line">    <span class="type">char</span> s[MAXstring];    <span class="comment">/* the search string or regex pattern */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> us[MAXstring];</span><br><span class="line">    <span class="type">uint64_t</span> guid[<span class="number">2</span>];</span><br><span class="line">    <span class="type">float</span> f;</span><br><span class="line">    <span class="type">double</span> d;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">magic</span> &#123;</span></span><br><span class="line">    <span class="comment">/* Word 1 */</span></span><br><span class="line">    <span class="type">uint16_t</span> cont_level;    <span class="comment">/* level of &quot;&gt;&quot; */</span></span><br><span class="line">    <span class="type">uint8_t</span> flag;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INDIR        0x01    <span class="comment">/* if &#x27;(...)&#x27; appears */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> OFFADD        0x02    <span class="comment">/* if &#x27;&gt;&amp;&#x27; or &#x27;&gt;...(&amp;&#x27; appears */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INDIROFFADD    0x04    <span class="comment">/* if &#x27;&gt;&amp;(&#x27; appears */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> UNSIGNED    0x08    <span class="comment">/* comparison is unsigned */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> NOSPACE        0x10    <span class="comment">/* suppress space character before output */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BINTEST        0x20    <span class="comment">/* test is for a binary type (set only</span></span></span><br><span class="line"><span class="comment"><span class="meta">                   for top-level tests) */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TEXTTEST    0x40    <span class="comment">/* for passing to file_softmagic */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> OFFNEGATIVE    0x80    <span class="comment">/* relative to the end of file */</span></span></span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> factor;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Word 2 */</span></span><br><span class="line">    <span class="type">uint8_t</span> reln;        <span class="comment">/* relation (0=eq, &#x27;&gt;&#x27;=gt, etc) */</span></span><br><span class="line">    <span class="type">uint8_t</span> vallen;        <span class="comment">/* length of string value, if any */</span></span><br><span class="line">    <span class="type">uint8_t</span> type;        <span class="comment">/* comparison type (FILE_*) */</span></span><br><span class="line">    <span class="type">uint8_t</span> in_type;    <span class="comment">/* type of indirection */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>             FILE_INVALID    0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>             FILE_BYTE    1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_SHORT    2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_DEFAULT    3</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_LONG    4</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_STRING    5</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_DATE    6</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_BESHORT    7</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_BELONG    8</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_BEDATE    9</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_LESHORT    10</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_LELONG    11</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_LEDATE    12</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_PSTRING    13</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_LDATE    14</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_BELDATE    15</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_LELDATE    16</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_REGEX    17</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_BESTRING16    18</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_LESTRING16    19</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_SEARCH    20</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_MEDATE    21</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_MELDATE    22</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_MELONG    23</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_QUAD    24</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_LEQUAD    25</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_BEQUAD    26</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_QDATE    27</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_LEQDATE    28</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_BEQDATE    29</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_QLDATE    30</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_LEQLDATE    31</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_BEQLDATE    32</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_FLOAT    33</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_BEFLOAT    34</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_LEFLOAT    35</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_DOUBLE    36</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_BEDOUBLE    37</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_LEDOUBLE    38</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_BEID3    39</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_LEID3    40</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_INDIRECT    41</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_QWDATE    42</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_LEQWDATE    43</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_BEQWDATE    44</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_NAME    45</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_USE    46</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_CLEAR    47</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_DER    48</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_GUID    49</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_OFFSET    50</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_NAMES_SIZE    51 <span class="comment">/* size of array to contain all names */</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IS_STRING(t) \</span></span><br><span class="line"><span class="meta">    ((t) == FILE_STRING || \</span></span><br><span class="line"><span class="meta">     (t) == FILE_PSTRING || \</span></span><br><span class="line"><span class="meta">     (t) == FILE_BESTRING16 || \</span></span><br><span class="line"><span class="meta">     (t) == FILE_LESTRING16 || \</span></span><br><span class="line"><span class="meta">     (t) == FILE_REGEX || \</span></span><br><span class="line"><span class="meta">     (t) == FILE_SEARCH || \</span></span><br><span class="line"><span class="meta">     (t) == FILE_INDIRECT || \</span></span><br><span class="line"><span class="meta">     (t) == FILE_NAME || \</span></span><br><span class="line"><span class="meta">     (t) == FILE_USE)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FILE_FMT_NONE 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FILE_FMT_NUM  1 <span class="comment">/* &quot;cduxXi&quot; */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FILE_FMT_STR  2 <span class="comment">/* &quot;s&quot; */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FILE_FMT_QUAD 3 <span class="comment">/* &quot;ll&quot; */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FILE_FMT_FLOAT 4 <span class="comment">/* &quot;eEfFgG&quot; */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FILE_FMT_DOUBLE 5 <span class="comment">/* &quot;eEfFgG&quot; */</span></span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Word 3 */</span></span><br><span class="line">    <span class="type">uint8_t</span> in_op;        <span class="comment">/* operator for indirection */</span></span><br><span class="line">    <span class="type">uint8_t</span> mask_op;    <span class="comment">/* operator for mask */</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ENABLE_CONDITIONALS</span></span><br><span class="line">    <span class="type">uint8_t</span> cond;        <span class="comment">/* conditional type */</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">    <span class="type">uint8_t</span> dummy;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">uint8_t</span> factor_op;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span>        FILE_FACTOR_OP_PLUS    <span class="string">&#x27;+&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>        FILE_FACTOR_OP_MINUS    <span class="string">&#x27;-&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>        FILE_FACTOR_OP_TIMES    <span class="string">&#x27;*&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>        FILE_FACTOR_OP_DIV    <span class="string">&#x27;/&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>        FILE_FACTOR_OP_NONE    <span class="string">&#x27;\0&#x27;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_OPS    <span class="string">&quot;&amp;|^+-*/%&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_OPAND    0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_OPOR    1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_OPXOR    2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_OPADD    3</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_OPMINUS    4</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_OPMULTIPLY    5</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_OPDIVIDE    6</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_OPMODULO    7</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_OPS_MASK    0x07 <span class="comment">/* mask for above ops */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_UNUSED_1    0x08</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_UNUSED_2    0x10</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_OPSIGNED    0x20</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_OPINVERSE    0x40</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                FILE_OPINDIRECT    0x80</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ENABLE_CONDITIONALS</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                COND_NONE    0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                COND_IF        1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                COND_ELIF    2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>                COND_ELSE    3</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">/* ENABLE_CONDITIONALS */</span></span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Word 4 */</span></span><br><span class="line">    <span class="type">int32_t</span> offset;        <span class="comment">/* offset to magic number */</span></span><br><span class="line">    <span class="comment">/* Word 5 */</span></span><br><span class="line">    <span class="type">int32_t</span> in_offset;    <span class="comment">/* offset from indirection */</span></span><br><span class="line">    <span class="comment">/* Word 6 */</span></span><br><span class="line">    <span class="type">uint32_t</span> lineno;    <span class="comment">/* line number in magic file */</span></span><br><span class="line">    <span class="comment">/* Word 7,8 */</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">        <span class="type">uint64_t</span> _mask;    <span class="comment">/* for use with numeric and date types */</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">            <span class="type">uint32_t</span> _count;    <span class="comment">/* repeat/line count */</span></span><br><span class="line">            <span class="type">uint32_t</span> _flags;    <span class="comment">/* modifier flags */</span></span><br><span class="line">        &#125; _s;        <span class="comment">/* for use with string types */</span></span><br><span class="line">    &#125; _u;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> num_mask _u._mask</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> str_range _u._s._count</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> str_flags _u._s._flags</span></span><br><span class="line">    <span class="comment">/* Words 9-24 */</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> <span class="title">VALUETYPE</span> <span class="title">value</span>;</span>    <span class="comment">/* either number or string */</span></span><br><span class="line">    <span class="comment">/* Words 25-40 */</span></span><br><span class="line">    <span class="type">char</span> desc[MAXDESC];    <span class="comment">/* description */</span></span><br><span class="line">    <span class="comment">/* Words 41-60 */</span></span><br><span class="line">    <span class="type">char</span> mimetype[MAXMIME]; <span class="comment">/* MIME type */</span></span><br><span class="line">    <span class="comment">/* Words 61-62 */</span></span><br><span class="line">    <span class="type">char</span> apple[<span class="number">8</span>];        <span class="comment">/* APPLE CREATOR/TYPE */</span></span><br><span class="line">    <span class="comment">/* Words 63-78 */</span></span><br><span class="line">    <span class="type">char</span> ext[<span class="number">64</span>];        <span class="comment">/* Popular extensions */</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> ffff = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">10000</span>];</span><br><span class="line">    <span class="type">int</span> fd = open(<span class="string">&quot;flag.mgc&quot;</span>, <span class="number">0</span>);</span><br><span class="line">    read(fd, buf, <span class="number">0x170</span> + <span class="number">8</span>);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">magic</span> <span class="title">a</span>[100];</span></span><br><span class="line">    <span class="type">int</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> test[<span class="number">1000</span>];</span><br><span class="line">    <span class="built_in">memset</span>(test, <span class="number">0</span>, <span class="number">1000</span>);</span><br><span class="line">    <span class="type">char</span> flag[<span class="number">100</span>];</span><br><span class="line">    <span class="keyword">while</span> (read(fd, &amp;a[index], <span class="keyword">sizeof</span>(<span class="keyword">struct</span> magic)) &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        index += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; index; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">magic</span> <span class="title">temp</span> =</span> a[i];</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;lineno: %d\n&quot;</span>, temp.lineno);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;type: %d\n&quot;</span>, temp.type);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;reln: %c\n&quot;</span>, temp.reln);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;in_offset: %d\n&quot;</span>, temp.in_offset);</span><br><span class="line">        <span class="keyword">if</span> (((<span class="type">int</span>)(temp.type)) == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ffff = (temp.offset - <span class="number">63</span>) / <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;offset: %d\n&quot;</span>, (test[ffff]));</span><br><span class="line">            <span class="type">char</span> ttt = ((temp.value.b) &amp; <span class="number">0xff</span>) ^ ((temp._u._mask) &amp; <span class="number">0xff</span>);</span><br><span class="line">            flag[test[ffff]] = ttt;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;offset: %d\n&quot;</span>, temp.offset);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;b: %llx\n&quot;</span>, temp.value.b);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;q: %llx\n&quot;</span>, temp.value.q);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;_mask: %llx\n&quot;</span>, temp._u._mask);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;mask_op: %llx\n&quot;</span>, temp.mask_op);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;in_op: %llx\n&quot;</span>, temp.in_op);</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> tes = temp._u._mask ^ temp.value.q;</span><br><span class="line">        test[i] = tes;</span><br><span class="line">        <span class="keyword">if</span> (temp.offset &lt; <span class="number">64</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;aaaa!!!!!!!!!!!!!\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n=======================\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; index; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%llx,&quot;</span>, test[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n\n\n&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">40</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, flag[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="NepCTF2023"><a href="#NepCTF2023" class="headerlink" title="NepCTF2023"></a>NepCTF2023</h1><h2 id="eeeeerte"><a href="#eeeeerte" class="headerlink" title="eeeeerte"></a>eeeeerte</h2><h3 id="安装易语言反编译模块"><a href="#安装易语言反编译模块" class="headerlink" title="安装易语言反编译模块"></a>安装易语言反编译模块</h3><p>更改ida.cfg文件，使其可显示中文字符：</p>
<blockquote>
<p>NameChars &#x3D;<br>        “$?@”           &#x2F;&#x2F; asm specific character<br>        “_0123456789”<br>        “ABCDEFGHIJKLMNOPQRSTUVWXYZ”<br>        “abcdefghijklmnopqrstuvwxyz”,<br>        &#x2F;&#x2F; This would enable common Chinese characters in identifiers:<br>        Culture_CJK_Unified_Ideographs,<br>        CURRENT_CULTURE;</p>
</blockquote>
<p>更改ida64.dll和ida.dll，使其可在反编译代码中显示中文字符：（nop掉该语句）</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230812122020491.png" alt="image-20230812122020491"></p>
<h3 id="主逻辑"><a href="#主逻辑" class="headerlink" title="主逻辑"></a>主逻辑</h3><p>由参数名，来进行逆向，对点击数判断的地方下断点。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230819173629954.png" alt="函数名"></p>
<h4 id="加密函数"><a href="#加密函数" class="headerlink" title="加密函数"></a>加密函数</h4><p>第一个点击数判断，是一个加密函数，需要输入key，然后加密其给出的数据。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230819173853434.png"></p>
<p>encrypt函数先将fake_flag分为几组四个字的数组，进行SKIPJACK解密：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230819174136526.png"></p>
<p>具体加密逻辑，通过调试可知：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">f, k, d</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> &lt;= i &lt; <span class="number">8</span> <span class="keyword">or</span> <span class="number">16</span> &lt;= i &lt; <span class="number">24</span>:</span><br><span class="line">            temp = [f[<span class="number">1</span>], f[<span class="number">0</span>]]</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span> * i, <span class="number">4</span> * i + <span class="number">4</span>):</span><br><span class="line">                t = k[j % <span class="number">10</span>] ^ temp[j &amp; <span class="number">1</span>]</span><br><span class="line">                temp[(j + <span class="number">1</span>) &amp; <span class="number">1</span>] = temp[(j + <span class="number">1</span>) &amp; <span class="number">1</span>] ^ d[t]</span><br><span class="line">            f[<span class="number">7</span>] ^= (i + <span class="number">1</span>)</span><br><span class="line">            f = f[<span class="number">6</span>:<span class="number">8</span>] + f[<span class="number">0</span>:<span class="number">6</span>]</span><br><span class="line">            f[<span class="number">3</span>], f[<span class="number">2</span>] = temp[<span class="number">0</span>], temp[<span class="number">1</span>]</span><br><span class="line">            f[<span class="number">0</span>] ^= f[<span class="number">2</span>]</span><br><span class="line">            f[<span class="number">1</span>] ^= f[<span class="number">3</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            temp = [f[<span class="number">1</span>], f[<span class="number">0</span>]]</span><br><span class="line">            tp = temp</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span> * i, <span class="number">4</span> * i + <span class="number">4</span>):</span><br><span class="line">                t = k[j % <span class="number">10</span>] ^ temp[j &amp; <span class="number">1</span>]</span><br><span class="line">                temp[(j + <span class="number">1</span>) &amp; <span class="number">1</span>] = temp[(j + <span class="number">1</span>) &amp; <span class="number">1</span>] ^ d[t]</span><br><span class="line">            f = f[<span class="number">6</span>:<span class="number">8</span>] + [temp[<span class="number">1</span>], temp[<span class="number">0</span>]] + [f[<span class="number">2</span>] ^ f[<span class="number">0</span>], f[<span class="number">3</span>] ^ f[<span class="number">1</span>] ^ (i + <span class="number">1</span>)] + f[<span class="number">4</span>:<span class="number">6</span>]</span><br><span class="line">    <span class="keyword">return</span> f</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    fake_flag = [<span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x4D</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x64</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x65</span>, <span class="number">0x63</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>,</span><br><span class="line">                 <span class="number">0x3F</span>, <span class="number">0x4D</span>, <span class="number">0x79</span>, <span class="number">0x73</span>, <span class="number">0x74</span>, <span class="number">0x65</span>, <span class="number">0x72</span>, <span class="number">0x69</span>, <span class="number">0x6F</span>, <span class="number">0x75</span>, <span class="number">0x73</span>, <span class="number">0x4A</span>, <span class="number">0x61</span>, <span class="number">0x63</span>, <span class="number">0x6B</span>, <span class="number">0x3F</span>, <span class="number">0x46</span>,</span><br><span class="line">                 <span class="number">0x41</span>, <span class="number">0x41</span>, <span class="number">0x41</span>, <span class="number">0x4B</span>, <span class="number">0x45</span>, <span class="number">0x7D</span>]</span><br><span class="line">    key = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&quot;1234567890&quot;</span>]</span><br><span class="line">    data = [<span class="number">0xA3</span>, <span class="number">0xD7</span>, <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0xF8</span>, <span class="number">0x48</span>, <span class="number">0xF6</span>, <span class="number">0xF4</span>, <span class="number">0xB3</span> ...]</span><br><span class="line">    a = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(fake_flag) // <span class="number">8</span>):</span><br><span class="line">        a += enc(fake_flag[i * <span class="number">8</span>:i * <span class="number">8</span> + <span class="number">8</span>], key, data)</span><br><span class="line">    result = base64.b64encode(<span class="built_in">bytearray</span>(a))</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<h4 id="提供了密文"><a href="#提供了密文" class="headerlink" title="提供了密文"></a>提供了密文</h4><p>第二个点击数判断，直接该判断即可获取密文：</p>
<p><code>[0, 210, 114, 206, 231, 30, 77, 164, 142, 14, 221, 165, 158, 132, 69, 180, 38, 41, 54, 87, 225, 45, 192, 204, 188, 253, 143, 85, 21, 169, 162, 191, 234, 150, 35, 74, 100, 173, 175, 176]</code></p>
<h4 id="画密钥"><a href="#画密钥" class="headerlink" title="画密钥"></a>画密钥</h4><p>第三个点击数判断，获取密钥。</p>
<h5 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h5><p>出题师傅说的，在<code>CreateWindowExA</code>下断点，更改其长和宽的参数。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">HWND <span class="title function_">CreateWindowExW</span><span class="params">(</span></span><br><span class="line"><span class="params">  [in]           DWORD     dwExStyle,</span></span><br><span class="line"><span class="params">  [in, optional] LPCWSTR   lpClassName,</span></span><br><span class="line"><span class="params">  [in, optional] LPCWSTR   lpWindowName,</span></span><br><span class="line"><span class="params">  [in]           DWORD     dwStyle,</span></span><br><span class="line"><span class="params">  [in]           <span class="type">int</span>       X,</span></span><br><span class="line"><span class="params">  [in]           <span class="type">int</span>       Y,</span></span><br><span class="line"><span class="params">  [in]           <span class="type">int</span>       nWidth,</span></span><br><span class="line"><span class="params">  [in]           <span class="type">int</span>       nHeight,</span></span><br><span class="line"><span class="params">  [in, optional] HWND      hWndParent,</span></span><br><span class="line"><span class="params">  [in, optional] HMENU     hMenu,</span></span><br><span class="line"><span class="params">  [in, optional] HINSTANCE hInstance,</span></span><br><span class="line"><span class="params">  [in, optional] LPVOID    lpParam</span></span><br><span class="line"><span class="params">)</span>;</span><br></pre></td></tr></table></figure>

<p><code>CreateWindowExA</code>一共被调用了四次，大概试一试，知道第四个是有关画密钥的窗口。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230819173105703.png" alt="密钥窗口X、Y的位置"></p>
<p>将其都改为0，即可。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230819171855885.png" alt="密钥"></p>
<h5 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h5><p>根据参数，自行画图：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230819173422763.png" alt="画图参数"></p>
<h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">f, k, d</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> &lt;= i &lt; <span class="number">8</span> <span class="keyword">or</span> <span class="number">16</span> &lt;= i &lt; <span class="number">24</span>:</span><br><span class="line">            temp = [f[<span class="number">3</span>], f[<span class="number">2</span>]]</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span> * i + <span class="number">3</span>, <span class="number">4</span> * i - <span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">                t = k[j % <span class="number">10</span>] ^ temp[j &amp; <span class="number">1</span>]</span><br><span class="line">                temp[(j + <span class="number">1</span>) &amp; <span class="number">1</span>] ^= d[t]</span><br><span class="line">            new_f = [temp[<span class="number">1</span>], temp[<span class="number">0</span>]] + f[<span class="number">4</span>:<span class="number">6</span>] + f[<span class="number">6</span>:<span class="number">8</span>] + [f[<span class="number">2</span>] ^ f[<span class="number">0</span>], f[<span class="number">3</span>] ^ f[<span class="number">1</span>] ^ (i + <span class="number">1</span>)]</span><br><span class="line">            f = new_f</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            temp = [f[<span class="number">3</span>], f[<span class="number">2</span>]]</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span> * i + <span class="number">3</span>, <span class="number">4</span> * i - <span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">                t = k[j % <span class="number">10</span>] ^ temp[j &amp; <span class="number">1</span>]</span><br><span class="line">                temp[(j + <span class="number">1</span>) &amp; <span class="number">1</span>] ^= d[t]</span><br><span class="line">            new_f = [temp[<span class="number">1</span>], temp[<span class="number">0</span>]] + [f[<span class="number">4</span>] ^ temp[<span class="number">1</span>], f[<span class="number">5</span>] ^ temp[<span class="number">0</span>] ^ (i + <span class="number">1</span>)] + f[<span class="number">6</span>:<span class="number">8</span>] + f[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">            f = new_f</span><br><span class="line">    <span class="keyword">return</span> f</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    data = [<span class="number">0xA3</span>, <span class="number">0xD7</span>, <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0xF8</span>, <span class="number">0x48</span>, <span class="number">0xF6</span>, <span class="number">0xF4</span>, <span class="number">0xB3</span>, <span class="number">0x21</span>, <span class="number">0x15</span>, <span class="number">0x78</span>, <span class="number">0x99</span>, <span class="number">0xB1</span>, <span class="number">0xAF</span>, <span class="number">0xF9</span>, <span class="number">0xE7</span>, <span class="number">0x2D</span>,</span><br><span class="line">            <span class="number">0x4D</span>, <span class="number">0x8A</span>, <span class="number">0xCE</span>, <span class="number">0x4C</span>, <span class="number">0xCA</span>, <span class="number">0x2E</span>, <span class="number">0x52</span>, <span class="number">0x95</span>, <span class="number">0xD9</span>, <span class="number">0x1E</span>, <span class="number">0x4E</span>, <span class="number">0x38</span>, <span class="number">0x44</span>, <span class="number">0x28</span>, <span class="number">0x0A</span>, <span class="number">0xDF</span>, <span class="number">0x02</span>, <span class="number">0xA0</span>,</span><br><span class="line">            <span class="number">0x17</span>, <span class="number">0xF1</span>, <span class="number">0x60</span>, <span class="number">0x68</span>, <span class="number">0x12</span>, <span class="number">0xB7</span>, <span class="number">0x7A</span>, <span class="number">0xC3</span>, <span class="number">0xE9</span>, <span class="number">0xFA</span>, <span class="number">0x3D</span>, <span class="number">0x53</span>, <span class="number">0x96</span>, <span class="number">0x84</span>, <span class="number">0x6B</span>, <span class="number">0xBA</span>, <span class="number">0xF2</span>, <span class="number">0x63</span>,</span><br><span class="line">            <span class="number">0x9A</span>, <span class="number">0x19</span>, <span class="number">0x7C</span>, <span class="number">0xAE</span>, <span class="number">0xE5</span>, <span class="number">0xF5</span>, <span class="number">0xF7</span>, <span class="number">0x16</span>, <span class="number">0x6A</span>, <span class="number">0xA2</span>, <span class="number">0x39</span>, <span class="number">0xB6</span>, <span class="number">0x7B</span>, <span class="number">0x0F</span>, <span class="number">0xC1</span>, <span class="number">0x93</span>, <span class="number">0x81</span>, <span class="number">0x1B</span>,</span><br><span class="line">            <span class="number">0xEE</span>, <span class="number">0xB4</span>, <span class="number">0x1A</span>, <span class="number">0xEA</span>, <span class="number">0xD0</span>, <span class="number">0x91</span>, <span class="number">0x2F</span>, <span class="number">0xB8</span>, <span class="number">0x55</span>, <span class="number">0xB9</span>, <span class="number">0xDA</span>, <span class="number">0x85</span>, <span class="number">0x3F</span>, <span class="number">0x41</span>, <span class="number">0xBF</span>, <span class="number">0xE0</span>, <span class="number">0x5A</span>, <span class="number">0x58</span>,</span><br><span class="line">            <span class="number">0x80</span>, <span class="number">0x5F</span>, <span class="number">0x66</span>, <span class="number">0x0B</span>, <span class="number">0xD8</span>, <span class="number">0x90</span>, <span class="number">0x35</span>, <span class="number">0xD5</span>, <span class="number">0xC0</span>, <span class="number">0xA7</span>, <span class="number">0x33</span>, <span class="number">0x06</span>, <span class="number">0x65</span>, <span class="number">0x69</span>, <span class="number">0x45</span>, <span class="number">0x00</span>, <span class="number">0x94</span>, <span class="number">0x56</span>,</span><br><span class="line">            <span class="number">0x6D</span>, <span class="number">0x98</span>, <span class="number">0x9B</span>, <span class="number">0x76</span>, <span class="number">0x97</span>, <span class="number">0xFC</span>, <span class="number">0xB2</span>, <span class="number">0xC2</span>, <span class="number">0xB0</span>, <span class="number">0xFE</span>, <span class="number">0xDB</span>, <span class="number">0x20</span>, <span class="number">0xE1</span>, <span class="number">0xEB</span>, <span class="number">0xD6</span>, <span class="number">0xE4</span>, <span class="number">0xDD</span>, <span class="number">0x47</span>,</span><br><span class="line">            <span class="number">0x4A</span>, <span class="number">0x1D</span>, <span class="number">0x42</span>, <span class="number">0xED</span>, <span class="number">0x9E</span>, <span class="number">0x6E</span>, <span class="number">0x49</span>, <span class="number">0x3C</span>, <span class="number">0xCD</span>, <span class="number">0x43</span>, <span class="number">0x27</span>, <span class="number">0xD2</span>, <span class="number">0x07</span>, <span class="number">0xD4</span>, <span class="number">0xDE</span>, <span class="number">0xC7</span>, <span class="number">0x67</span>, <span class="number">0x18</span>,</span><br><span class="line">            <span class="number">0x89</span>, <span class="number">0xCB</span>, <span class="number">0x30</span>, <span class="number">0x1F</span>, <span class="number">0x8D</span>, <span class="number">0xC6</span>, <span class="number">0x8F</span>, <span class="number">0xAA</span>, <span class="number">0xC8</span>, <span class="number">0x74</span>, <span class="number">0xDC</span>, <span class="number">0xC9</span>, <span class="number">0x5D</span>, <span class="number">0x5C</span>, <span class="number">0x31</span>, <span class="number">0xA4</span>, <span class="number">0x70</span>, <span class="number">0x88</span>,</span><br><span class="line">            <span class="number">0x61</span>, <span class="number">0x2C</span>, <span class="number">0x9F</span>, <span class="number">0x0D</span>, <span class="number">0x2B</span>, <span class="number">0x87</span>, <span class="number">0x50</span>, <span class="number">0x82</span>, <span class="number">0x54</span>, <span class="number">0x64</span>, <span class="number">0x26</span>, <span class="number">0x7D</span>, <span class="number">0x03</span>, <span class="number">0x40</span>, <span class="number">0x34</span>, <span class="number">0x4B</span>, <span class="number">0x1C</span>, <span class="number">0x73</span>,</span><br><span class="line">            <span class="number">0xD1</span>, <span class="number">0xC4</span>, <span class="number">0xFD</span>, <span class="number">0x3B</span>, <span class="number">0xCC</span>, <span class="number">0xFB</span>, <span class="number">0x7F</span>, <span class="number">0xAB</span>, <span class="number">0xE6</span>, <span class="number">0x3E</span>, <span class="number">0x5B</span>, <span class="number">0xA5</span>, <span class="number">0xAD</span>, <span class="number">0x04</span>, <span class="number">0x23</span>, <span class="number">0x9C</span>, <span class="number">0x14</span>, <span class="number">0x51</span>,</span><br><span class="line">            <span class="number">0x22</span>, <span class="number">0xF0</span>, <span class="number">0x29</span>, <span class="number">0x79</span>, <span class="number">0x71</span>, <span class="number">0x7E</span>, <span class="number">0xFF</span>, <span class="number">0x8C</span>, <span class="number">0x0E</span>, <span class="number">0xE2</span>, <span class="number">0x0C</span>, <span class="number">0xEF</span>, <span class="number">0xBC</span>, <span class="number">0x72</span>, <span class="number">0x75</span>, <span class="number">0x6F</span>, <span class="number">0x37</span>, <span class="number">0xA1</span>,</span><br><span class="line">            <span class="number">0xEC</span>, <span class="number">0xD3</span>, <span class="number">0x8E</span>, <span class="number">0x62</span>, <span class="number">0x8B</span>, <span class="number">0x86</span>, <span class="number">0x10</span>, <span class="number">0xE8</span>, <span class="number">0x08</span>, <span class="number">0x77</span>, <span class="number">0x11</span>, <span class="number">0xBE</span>, <span class="number">0x92</span>, <span class="number">0x4F</span>, <span class="number">0x24</span>, <span class="number">0xC5</span>, <span class="number">0x32</span>, <span class="number">0x36</span>,</span><br><span class="line">            <span class="number">0x9D</span>, <span class="number">0xCF</span>, <span class="number">0xF3</span>, <span class="number">0xA6</span>, <span class="number">0xBB</span>, <span class="number">0xAC</span>, <span class="number">0x5E</span>, <span class="number">0x6C</span>, <span class="number">0xA9</span>, <span class="number">0x13</span>, <span class="number">0x57</span>, <span class="number">0x25</span>, <span class="number">0xB5</span>, <span class="number">0xE3</span>, <span class="number">0xBD</span>, <span class="number">0xA8</span>, <span class="number">0x3A</span>, <span class="number">0x01</span>,</span><br><span class="line">            <span class="number">0x05</span>, <span class="number">0x59</span>, <span class="number">0x2A</span>, <span class="number">0x46</span>, <span class="number">0xAB</span>, <span class="number">0xAB</span>, <span class="number">0xAB</span>, <span class="number">0xAB</span>, <span class="number">0xAB</span>, <span class="number">0xAB</span>, <span class="number">0xAB</span>]</span><br><span class="line">    <span class="comment"># 解密</span></span><br><span class="line">    secret = <span class="string">&#x27;xmxO93Sn8YjfoWqaFS6poLf6n1q7bWrIyXbLAdcSjygWfs/jAVc4leFrTDZYdFoL&#x27;</span></span><br><span class="line">    secret = base64.b64decode(secret)</span><br><span class="line">    secret = <span class="built_in">list</span>(secret)</span><br><span class="line">    key = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&quot;NITORI2413&quot;</span>]</span><br><span class="line">    flag = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(secret) // <span class="number">8</span>):</span><br><span class="line">        flag += dec(secret[i * <span class="number">8</span>:i * <span class="number">8</span> + <span class="number">8</span>], key, data)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytearray</span>(flag))</span><br><span class="line">    <span class="comment"># NepCTF&#123;3456789TQKA2,Jack_was_skipped_by_EPL&#125;</span></span><br></pre></td></tr></table></figure>





<h2 id="九龙拉棺"><a href="#九龙拉棺" class="headerlink" title="九龙拉棺"></a>九龙拉棺</h2><p>跟着<a target="_blank" rel="noopener" href="https://m1n9yu3.github.io/2023/08/14/NepCTF2023-%E4%B9%9D%E9%BE%99%E6%8B%89%E6%A3%BAwp">出题师傅的wp</a>走的。</p>
<p>UPX壳，直接脱壳。</p>
<h3 id="文件映射对象"><a href="#文件映射对象" class="headerlink" title="文件映射对象"></a>文件映射对象</h3><p>创建文件映射对象，存储输入的字符串，使之后创建的进程可以获取输入。</p>
<p>此操作先于main执行。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230817113121855.png" alt="创建文件映射对象"></p>
<h3 id="反调试"><a href="#反调试" class="headerlink" title="反调试"></a>反调试</h3><ol>
<li><p>每个线程都或多或少执行了一个反调试的函数。</p>
</li>
<li><p>检测调式寄存器Dr7是否为正常值。</p>
</li>
</ol>
<p><img src="/2023/11/21/CTF-wp-1/image-20230817120021597.png" alt="反调试函数"></p>
<ol start="3">
<li>子进程中也有反调试：<code>NtCurrentPeb()-&gt;BeingDebugged</code></li>
</ol>
<h3 id="八个线程"><a href="#八个线程" class="headerlink" title="八个线程"></a>八个线程</h3><p>main中启动了八个线程。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230817113501023.png" alt="八个线程"></p>
<p>每个进程依靠全局变量<code>CriticalLevel</code>来控制执行顺序，<code>CriticalLevel</code>初始值为0。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230817113631442.png" alt="以其中一个线程为例"></p>
<p>main中获取完输入，将其写入文件映射对象中，然后将<code>CriticalLevel</code>置为1，等待其他线程。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230817114314606.png" alt="等待其他线程"></p>
<h4 id="第一个线程：Rc4解密"><a href="#第一个线程：Rc4解密" class="headerlink" title="第一个线程：Rc4解密"></a>第一个线程：Rc4解密</h4><p><img src="/2023/11/21/CTF-wp-1/image-20230817120347247.png" alt="Rc4"></p>
<h4 id="第二个线程：base32解析"><a href="#第二个线程：base32解析" class="headerlink" title="第二个线程：base32解析"></a>第二个线程：base32解析</h4><p>主要依靠base32表和字符串看出是base32，前面更新数据长度的部分也可以联想到base32（但有点疑惑为什么是除五乘八）。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230817120514823.png" alt="base32——1"></p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230817120613443.png" alt="base32——2"></p>
<h4 id="第三个线程：base58"><a href="#第三个线程：base58" class="headerlink" title="第三个线程：base58"></a>第三个线程：base58</h4><p>主要转化式子可以辨认。</p>
<p>也可以依靠长度变化来辨别。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230817123703036.png" alt="base58"></p>
<h4 id="第四个线程：base64"><a href="#第四个线程：base64" class="headerlink" title="第四个线程：base64"></a>第四个线程：base64</h4><p><img src="/2023/11/21/CTF-wp-1/image-20230817123811046.png" alt="base64"></p>
<h4 id="第五个线程：StartAddress"><a href="#第五个线程：StartAddress" class="headerlink" title="第五个线程：StartAddress"></a>第五个线程：StartAddress</h4><p>前面四个线程处理的数据得到的是一个可执行文件数据，本线程就是将其写入exe，并执行。</p>
<p>具体细节还得再搞搞。</p>
<h4 id="第六个线程：tea、compare"><a href="#第六个线程：tea、compare" class="headerlink" title="第六个线程：tea、compare"></a>第六个线程：tea、compare</h4><p>明显的tea和比较：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230817124803097.png" alt="tea、compare"></p>
<p>这里解密tea可得到一部分的输入数据：NepCTF{c9cdnwdi3iu41m0pv3x7kllzu8pdq6mt9n2nwjdp6kat8ent4dhn5r158</p>
<h4 id="第七个线程：最终结果"><a href="#第七个线程：最终结果" class="headerlink" title="第七个线程：最终结果"></a>第七个线程：最终结果</h4><p><img src="/2023/11/21/CTF-wp-1/image-20230817130243540.png" alt="最后的比较"></p>
<p>注意到<code>MyshareMemory</code>的位置在主程序中一直只存放了输入，且输入的位置为<code>MyshareMemoroy+随机数的位置</code>，因此判断成功的条件在子程序中写入。</p>
<h4 id="第八个线程：反调试"><a href="#第八个线程：反调试" class="headerlink" title="第八个线程：反调试"></a>第八个线程：反调试</h4><blockquote>
<ul>
<li>1个线程用于反调试<ul>
<li>反调试动态读取.text(第一个段)并通过累加的方式，不断读取对比的方式，来实现反调试。如果程序一开始就存在断点，则该反调试无效，若在调试中突然增加int3断点，则该程序直接退出。</li>
</ul>
</li>
</ul>
</blockquote>
<h5 id="获取text段地址"><a href="#获取text段地址" class="headerlink" title="获取text段地址"></a>获取text段地址</h5><ul>
<li><p>ModuleHandle &#x3D; GetModuleHandleW(0)  获取exe基地址：0x100000</p>
</li>
<li><p>0x100000 + 0x3C：AddressOfNewExeHeader（0xF8）</p>
</li>
<li><p>0x100000 + AddressOfNewExeHeader：NtHeader</p>
</li>
<li><p>NtHeader + 0x14：SizeOfOptionalHeader（0xE0）</p>
</li>
<li><p>NtHeader + SizeOfOptionnalHeader + 0x28：SectionHeader[0]（即<code>.text</code>段）-&gt;Misc-&gt;SizeofRawData</p>
</li>
<li><p>ModuleHandleW + AddressOfNewHeader + SizeOfOptionnalHeader：DelayLoadImportDescriptors</p>
</li>
<li><p>ModuleHandleW + DelayLoadImportDescriptors + 0x24：VirtualAddress（0x101000）此时指向了.text&#96;段</p>
</li>
</ul>
<p><img src="/2023/11/21/CTF-wp-1/image-20230817155611561.png" alt="获取text段地址"></p>
<h5 id="压缩数据，形成一个整数（类似校验码）"><a href="#压缩数据，形成一个整数（类似校验码）" class="headerlink" title="压缩数据，形成一个整数（类似校验码）"></a>压缩数据，形成一个整数（类似校验码）</h5><p>对text段的数据生成校验码。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230817155831982.png" alt="生成校验码"></p>
<h5 id="循环比对"><a href="#循环比对" class="headerlink" title="循环比对"></a>循环比对</h5><p>生成校验码后，线程进入死循环，不断重复生成校验码，并与之前的校验码进行比对。</p>
<p>如果不同，则意味着text段被修改了，可能是在程序中下了int3断点导致，就结束。</p>
<h3 id="子进程"><a href="#子进程" class="headerlink" title="子进程"></a>子进程</h3><p>看着wp里的变量命名大概看懂了。</p>
<h4 id="FindFunction"><a href="#FindFunction" class="headerlink" title="FindFunction"></a>FindFunction</h4><p><img src="/2023/11/21/CTF-wp-1/image-20230817163911477.png" alt="找寻函数地址"></p>
<h4 id="tea"><a href="#tea" class="headerlink" title="tea"></a>tea</h4><p>类似的一个tea解密函数，直接解密可得：iu41m0pv3x7kllzu8pdq6mt9n2nwjdp6kat8ent4dhn5r158iz2f0cmr0u7yxyq}，与之前的明文结合一下就是flag了。</p>
<h4 id="main"><a href="#main" class="headerlink" title="main"></a>main</h4><p>通过获取kernel32的地址，来获取所需函数的地址</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230817164545707.png" alt="获取函数地址"></p>
<p>子进程通过文件映射对象获取<code>MyshareMemory</code>然后将其中的输入进去与tea函数解密比对，</p>
<p>最后，比对成功，将成功条件写入<code>MyshareMemory</code>中。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230817163753534.png" alt="找寻父进程的MyshareMemory，并写入成功条件"></p>
<h1 id="WMCTF2023"><a href="#WMCTF2023" class="headerlink" title="WMCTF2023"></a>WMCTF2023</h1><h2 id="RightBack"><a href="#RightBack" class="headerlink" title="RightBack"></a>RightBack</h2><h3 id="反编译pyc"><a href="#反编译pyc" class="headerlink" title="反编译pyc"></a>反编译pyc</h3><p>用pycdas看一下pyc字节码，主要是这里的字节码导致无法正确反编译：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230820220905451.png"></p>
<p>把所有这样的部分都patch掉（直接更改那部分代码的二进制数据）：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230820222158534.png"></p>
<p>获取字节码的二进制数据：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230820222120078.png"></p>
<p>用pycdc获取反编译：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230820221036623.png"></p>
<h3 id="分析逻辑"><a href="#分析逻辑" class="headerlink" title="分析逻辑"></a>分析逻辑</h3><ol>
<li>p1：RC4密钥初始化；</li>
<li>p3：RC4解密；</li>
<li>p2：类似AES的密钥初始化；</li>
<li>Have：获取输入；</li>
<li>执行虚拟机，验证。</li>
</ol>
<p>执行以下获取opcode、extendKey。</p>
<p>模拟执行一下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">F1</span>(<span class="params">part1, part2</span>):</span><br><span class="line">    <span class="keyword">global</span> REG</span><br><span class="line">    REG = &#123;<span class="string">&#x27;EAX&#x27;</span>: part1, <span class="string">&#x27;EBX&#x27;</span>: part2, <span class="string">&#x27;ECX&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;EDX&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;R8&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;CNT&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;EIP&#x27;</span>: <span class="number">0</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据v1的值来更改v2（值由v3决定）</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">F2</span>(<span class="params">v1, v2, v3</span>):</span><br><span class="line">    <span class="built_in">print</span>(opcode[REG[<span class="string">&#x27;EIP&#x27;</span>]], end=<span class="string">&#x27; : &#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> v1 == <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v2)]&#125;</span> = extendKey[<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v3)]&#125;</span>]:<span class="subst">&#123;extendKey[REG[reg_table[<span class="built_in">str</span>(v3)]]]&#125;</span>&#x27;</span>)</span><br><span class="line">        REG[reg_table[<span class="built_in">str</span>(v2)]] = extendKey[REG[reg_table[<span class="built_in">str</span>(v3)]]]</span><br><span class="line">    <span class="keyword">elif</span> v1 == <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v2)]&#125;</span> = <span class="subst">&#123;reg_table[<span class="built_in">str</span>(v3)]&#125;</span>&#x27;</span>)</span><br><span class="line">        REG[reg_table[<span class="built_in">str</span>(v2)]] = REG[reg_table[<span class="built_in">str</span>(v3)]]</span><br><span class="line">    <span class="keyword">elif</span> v1 == <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v2)]&#125;</span> = <span class="subst">&#123;<span class="built_in">str</span>(v3)&#125;</span>&#x27;</span>)</span><br><span class="line">        REG[reg_table[<span class="built_in">str</span>(v2)]] = v3</span><br><span class="line">    REG[<span class="string">&#x27;EIP&#x27;</span>] += <span class="number">4</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据v1的值使 v2 加上 由v3决定的值</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">F3</span>(<span class="params">v1, v2, v3</span>):</span><br><span class="line">    <span class="built_in">print</span>(opcode[REG[<span class="string">&#x27;EIP&#x27;</span>]], end=<span class="string">&#x27; : &#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> v1 == <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v2)]&#125;</span> += extendKey[<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v3)]&#125;</span>]:<span class="subst">&#123;extendKey[REG[reg_table[<span class="built_in">str</span>(v3)]]]&#125;</span>&#x27;</span>)</span><br><span class="line">        REG[reg_table[<span class="built_in">str</span>(v2)]] = REG[reg_table[<span class="built_in">str</span>(v2)]] + extendKey[REG[reg_table[<span class="built_in">str</span>(v3)]]] &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">elif</span> v1 == <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v2)]&#125;</span> += <span class="subst">&#123;reg_table[<span class="built_in">str</span>(v3)]&#125;</span>&#x27;</span>)</span><br><span class="line">        REG[reg_table[<span class="built_in">str</span>(v2)]] = REG[reg_table[<span class="built_in">str</span>(v2)]] + REG[reg_table[<span class="built_in">str</span>(v3)]] &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">elif</span> v1 == <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v2)]&#125;</span> += <span class="subst">&#123;<span class="built_in">str</span>(v3)&#125;</span>&#x27;</span>)</span><br><span class="line">        REG[reg_table[<span class="built_in">str</span>(v2)]] = REG[reg_table[<span class="built_in">str</span>(v2)]] + v3 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    REG[<span class="string">&#x27;EIP&#x27;</span>] += <span class="number">4</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">F4</span>(<span class="params">v1, v2</span>):</span><br><span class="line">    <span class="built_in">print</span>(opcode[REG[<span class="string">&#x27;EIP&#x27;</span>]], end=<span class="string">&#x27; : &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v1)]&#125;</span> ^= <span class="subst">&#123;reg_table[<span class="built_in">str</span>(v2)]&#125;</span>:<span class="subst">&#123;REG[reg_table[<span class="built_in">str</span>(v2)]]&#125;</span>&#x27;</span>)</span><br><span class="line">    REG[reg_table[<span class="built_in">str</span>(v1)]] ^= REG[reg_table[<span class="built_in">str</span>(v2)]]</span><br><span class="line">    REG[<span class="string">&#x27;EIP&#x27;</span>] += <span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">F5</span>(<span class="params">v1, v2</span>):</span><br><span class="line">    <span class="built_in">print</span>(opcode[REG[<span class="string">&#x27;EIP&#x27;</span>]], end=<span class="string">&#x27; : &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v1)]&#125;</span> &amp;= <span class="subst">&#123;v2&#125;</span>&#x27;</span>)</span><br><span class="line">    REG[reg_table[<span class="built_in">str</span>(v1)]] &amp;= v2</span><br><span class="line">    REG[<span class="string">&#x27;EIP&#x27;</span>] += <span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据v1的值使 v2 减去 由v3决定的值</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">F6</span>(<span class="params">v1, v2, v3</span>):</span><br><span class="line">    <span class="built_in">print</span>(opcode[REG[<span class="string">&#x27;EIP&#x27;</span>]], end=<span class="string">&#x27; : &#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> v1 == <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v2)]&#125;</span> -= extendKey[<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v3)]&#125;</span>]:<span class="subst">&#123;extendKey[REG[reg_table[<span class="built_in">str</span>(v3)]]]&#125;</span>&#x27;</span>)</span><br><span class="line">        REG[reg_table[<span class="built_in">str</span>(v2)]] -= extendKey[v3]</span><br><span class="line">    <span class="keyword">elif</span> v1 == <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v2)]&#125;</span> -= <span class="subst">&#123;reg_table[<span class="built_in">str</span>(v3)]&#125;</span>&#x27;</span>)</span><br><span class="line">        REG[reg_table[<span class="built_in">str</span>(v2)]] -= REG[reg_table[<span class="built_in">str</span>(v3)]]</span><br><span class="line">    <span class="keyword">elif</span> v1 == <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v2)]&#125;</span> -= <span class="subst">&#123;<span class="built_in">str</span>(v3)&#125;</span>&#x27;</span>)</span><br><span class="line">        REG[reg_table[<span class="built_in">str</span>(v2)]] -= v3</span><br><span class="line">    REG[<span class="string">&#x27;EIP&#x27;</span>] += <span class="number">4</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">F7</span>(<span class="params">v1, v2</span>):</span><br><span class="line">    <span class="built_in">print</span>(opcode[REG[<span class="string">&#x27;EIP&#x27;</span>]], end=<span class="string">&#x27; : &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v1)]&#125;</span> |= <span class="subst">&#123;reg_table[<span class="built_in">str</span>(v2)]&#125;</span>&#x27;</span>)</span><br><span class="line">    REG[reg_table[<span class="built_in">str</span>(v1)]] |= REG[reg_table[<span class="built_in">str</span>(v2)]]</span><br><span class="line">    REG[<span class="string">&#x27;EIP&#x27;</span>] += <span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">F8</span>(<span class="params">v1, v2</span>):</span><br><span class="line">    <span class="built_in">print</span>(opcode[REG[<span class="string">&#x27;EIP&#x27;</span>]], end=<span class="string">&#x27; : &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v1)]&#125;</span> &gt;&gt;= <span class="subst">&#123;reg_table[<span class="built_in">str</span>(v2)]&#125;</span>&#x27;</span>)</span><br><span class="line">    REG[reg_table[<span class="built_in">str</span>(v1)]] = REG[reg_table[<span class="built_in">str</span>(v1)]] &gt;&gt; REG[reg_table[<span class="built_in">str</span>(v2)]] &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    REG[<span class="string">&#x27;EIP&#x27;</span>] += <span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">F9</span>(<span class="params">v1, v2</span>):</span><br><span class="line">    <span class="built_in">print</span>(opcode[REG[<span class="string">&#x27;EIP&#x27;</span>]], end=<span class="string">&#x27; : &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v1)]&#125;</span> &lt;&lt;= <span class="subst">&#123;reg_table[<span class="built_in">str</span>(v2)]&#125;</span>&#x27;</span>)</span><br><span class="line">    REG[reg_table[<span class="built_in">str</span>(v1)]] = REG[reg_table[<span class="built_in">str</span>(v1)]] &lt;&lt; REG[reg_table[<span class="built_in">str</span>(v2)]] &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    REG[<span class="string">&#x27;EIP&#x27;</span>] += <span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">FA</span>(<span class="params">v1, v2, v3</span>):</span><br><span class="line">    <span class="built_in">print</span>(opcode[REG[<span class="string">&#x27;EIP&#x27;</span>]], end=<span class="string">&#x27; : &#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> v1 == <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v2)]&#125;</span> *= extendKey[<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v3)]&#125;</span>]:<span class="subst">&#123;extendKey[REG[reg_table[<span class="built_in">str</span>(v3)]]]&#125;</span>&#x27;</span>)</span><br><span class="line">        REG[reg_table[<span class="built_in">str</span>(v2)]] *= extendKey[v3]</span><br><span class="line">    <span class="keyword">elif</span> v1 == <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v2)]&#125;</span> *= <span class="subst">&#123;reg_table[<span class="built_in">str</span>(v3)]&#125;</span>&#x27;</span>)</span><br><span class="line">        REG[reg_table[<span class="built_in">str</span>(v2)]] *= REG[reg_table[<span class="built_in">str</span>(v3)]]</span><br><span class="line">    <span class="keyword">elif</span> v1 == <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;reg_table[<span class="built_in">str</span>(v2)]&#125;</span> *= <span class="subst">&#123;<span class="built_in">str</span>(v3)&#125;</span>&#x27;</span>)</span><br><span class="line">        REG[reg_table[<span class="built_in">str</span>(v2)]] *= v3</span><br><span class="line">    REG[<span class="string">&#x27;EIP&#x27;</span>] += <span class="number">4</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">FB</span>():</span><br><span class="line">    <span class="built_in">print</span>(opcode[REG[<span class="string">&#x27;EIP&#x27;</span>]], end=<span class="string">&#x27; : &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(REG[<span class="string">&#x27;CNT&#x27;</span>], <span class="string">&#x27;test CNT&#x27;</span>)</span><br><span class="line">    REG[<span class="string">&#x27;R8&#x27;</span>] = REG[<span class="string">&#x27;CNT&#x27;</span>] == <span class="number">21</span></span><br><span class="line">    REG[<span class="string">&#x27;EIP&#x27;</span>] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">WC</span>():</span><br><span class="line">    <span class="built_in">print</span>(opcode[REG[<span class="string">&#x27;EIP&#x27;</span>]], end=<span class="string">&#x27; : &#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> REG[<span class="string">&#x27;R8&#x27;</span>]:</span><br><span class="line">        REG[<span class="string">&#x27;EIP&#x27;</span>] = <span class="number">16</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;R8:&quot;</span>, REG[<span class="string">&#x27;R8&#x27;</span>])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;eip = 16&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;R8:&quot;</span>, REG[<span class="string">&#x27;R8&#x27;</span>], <span class="string">&#x27;go&#x27;</span>)</span><br><span class="line">        REG[<span class="string">&#x27;EIP&#x27;</span>] += <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">opcode = [</span><br><span class="line">    <span class="number">80</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">29</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>,</span><br><span class="line">    <span class="number">80</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">29</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>,</span><br><span class="line">    <span class="number">29</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">113</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line">    <span class="number">80</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">80</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">2</span>,</span><br><span class="line">    <span class="number">114</span>, <span class="number">2</span>, <span class="number">31</span>,</span><br><span class="line">    <span class="number">41</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line">    <span class="number">80</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">32</span>,</span><br><span class="line">    <span class="number">150</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>,</span><br><span class="line">    <span class="number">116</span>, <span class="number">3</span>, <span class="number">4</span>,</span><br><span class="line">    <span class="number">87</span>, <span class="number">1</span>, <span class="number">3</span>,</span><br><span class="line">    <span class="number">80</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">6</span>,</span><br><span class="line">    <span class="number">220</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>,</span><br><span class="line">    <span class="number">80</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>,</span><br><span class="line">    <span class="number">29</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>,</span><br><span class="line">    <span class="number">80</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">5</span>,</span><br><span class="line">    <span class="number">113</span>, <span class="number">2</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">80</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>,</span><br><span class="line">    <span class="number">80</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">114</span>, <span class="number">4</span>, <span class="number">31</span>,</span><br><span class="line">    <span class="number">41</span>, <span class="number">2</span>, <span class="number">4</span>,</span><br><span class="line">    <span class="number">80</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">32</span>,</span><br><span class="line">    <span class="number">150</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">4</span>,</span><br><span class="line">    <span class="number">116</span>, <span class="number">3</span>, <span class="number">5</span>,</span><br><span class="line">    <span class="number">87</span>, <span class="number">2</span>, <span class="number">3</span>,</span><br><span class="line">    <span class="number">80</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>,</span><br><span class="line">    <span class="number">220</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>,</span><br><span class="line">    <span class="number">29</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">80</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>,</span><br><span class="line">    <span class="number">29</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>,</span><br><span class="line">    <span class="number">7</span>, <span class="number">153</span>, <span class="number">255</span>]</span><br><span class="line">EIP = <span class="number">0</span></span><br><span class="line">extendKey = [<span class="number">1835819331</span>, <span class="number">1853321028</span>, <span class="number">1768711490</span>, <span class="number">1432712805</span>, <span class="number">2177920767</span>, <span class="number">4020699579</span>, <span class="number">2261476601</span>, <span class="number">3551400604</span>, <span class="number">711874531</span>, <span class="number">3318306392</span>, <span class="number">1124217505</span>, <span class="number">2427199549</span>, <span class="number">3099853672</span>, <span class="number">2098025776</span>, <span class="number">1041196945</span>, <span class="number">2929936300</span>, <span class="number">246748610</span>, <span class="number">1941455090</span>, <span class="number">1303848803</span>, <span class="number">3809763535</span>, <span class="number">1395557789</span>, <span class="number">546751855</span>, <span class="number">1830937100</span>, <span class="number">2385871555</span>, <span class="number">2516030638</span>, <span class="number">3043054017</span>, <span class="number">3628118989</span>, <span class="number">1450520846</span>, <span class="number">1825094265</span>, <span class="number">3651791800</span>, <span class="number">32069749</span>, <span class="number">1469868411</span>, <span class="number">919887482</span>, <span class="number">4017993154</span>, <span class="number">4002737591</span>, <span class="number">3104343244</span>, <span class="number">4134211933</span>, <span class="number">420914335</span>, <span class="number">4152510760</span>, <span class="number">1317719524</span>, <span class="number">1990496755</span>, <span class="number">1873950060</span>, <span class="number">2553314372</span>, <span class="number">3602559392</span>]</span><br><span class="line">reg_table = &#123;</span><br><span class="line">        <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;EAX&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;2&#x27;</span>: <span class="string">&#x27;EBX&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;3&#x27;</span>: <span class="string">&#x27;ECX&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;EDX&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;5&#x27;</span>: <span class="string">&#x27;R8&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;6&#x27;</span>: <span class="string">&#x27;CNT&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;EIP&#x27;</span>&#125;</span><br><span class="line">REG = &#123;&#125;</span><br><span class="line"><span class="keyword">while</span> EIP &lt; <span class="built_in">len</span>(opcode):</span><br><span class="line">    F1(<span class="number">0x31323334</span>, <span class="number">0x35363738</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        EIP = REG[<span class="string">&#x27;EIP&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> opcode[EIP] == <span class="number">80</span>:</span><br><span class="line">            <span class="comment"># 根据v1的值来更改v2（值由v3决定）</span></span><br><span class="line">            F2(opcode[EIP + <span class="number">1</span>], opcode[EIP + <span class="number">2</span>], opcode[EIP + <span class="number">3</span>])</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> opcode[EIP] == <span class="number">29</span>:</span><br><span class="line">            <span class="comment"># 根据v1的值使 v2 加上 由v3决定的值</span></span><br><span class="line">            F3(opcode[EIP + <span class="number">1</span>], opcode[EIP + <span class="number">2</span>], opcode[EIP + <span class="number">3</span>])</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> opcode[EIP] == <span class="number">113</span>:</span><br><span class="line">            <span class="comment"># 异或</span></span><br><span class="line">            F4(opcode[EIP + <span class="number">1</span>], opcode[EIP + <span class="number">2</span>])</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> opcode[EIP] == <span class="number">114</span>:</span><br><span class="line">            <span class="comment"># 相与</span></span><br><span class="line">            F5(opcode[EIP + <span class="number">1</span>], opcode[EIP + <span class="number">2</span>])</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> opcode[EIP] == <span class="number">150</span>:</span><br><span class="line">            <span class="comment"># 根据v1的值使 v2 减去 由v3决定的值</span></span><br><span class="line">            F6(opcode[EIP + <span class="number">1</span>], opcode[EIP + <span class="number">2</span>], opcode[EIP + <span class="number">3</span>])</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> opcode[EIP] == <span class="number">87</span>:</span><br><span class="line">            <span class="comment"># 相或</span></span><br><span class="line">            F7(opcode[EIP + <span class="number">1</span>], opcode[EIP + <span class="number">2</span>])</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> opcode[EIP] == <span class="number">116</span>:</span><br><span class="line">            <span class="comment"># 右移</span></span><br><span class="line">            F8(opcode[EIP + <span class="number">1</span>], opcode[EIP + <span class="number">2</span>])</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> opcode[EIP] == <span class="number">41</span>:</span><br><span class="line">            <span class="comment"># 左移</span></span><br><span class="line">            F9(opcode[EIP + <span class="number">1</span>], opcode[EIP + <span class="number">2</span>])</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> opcode[EIP] == <span class="number">220</span>:</span><br><span class="line">            <span class="comment"># 根据v1的值使 v2 乘上 由v3决定的值</span></span><br><span class="line">            FA(opcode[EIP + <span class="number">1</span>], opcode[EIP + <span class="number">2</span>], opcode[EIP + <span class="number">3</span>])</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> opcode[EIP] == <span class="number">7</span>:</span><br><span class="line">            <span class="comment"># 检测CNt == 21，结果在R8</span></span><br><span class="line">            FB()</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> opcode[EIP] == <span class="number">153</span>:</span><br><span class="line">            <span class="comment"># 根据R8 判断是要跳去地址16</span></span><br><span class="line">            WC()</span><br><span class="line">            <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>

<p>得到验证逻辑：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">eax = input[0] + extendKey[0]</span><br><span class="line">ebx = input[1] + extendKey[1]</span><br><span class="line">while CNT != 21 </span><br><span class="line">	CNT += 1</span><br><span class="line">	r8 = ebx</span><br><span class="line">	temp = eax ^ ebx</span><br><span class="line">	# 交换temp前后位</span><br><span class="line">	ebx = ebx &amp; 31</span><br><span class="line">	ebx = temp &lt;&lt; ebx | temp &gt;&gt; (32 - ebx)</span><br><span class="line">	eax += extendKey[CNT * 2]</span><br><span class="line">	ebx = r8</span><br><span class="line">	temp = eax ^ ebx</span><br><span class="line">	edx = eax &amp; 31</span><br><span class="line">	ebx = temp &lt;&lt; edx | temp &gt;&gt; (32 - edx)</span><br><span class="line">	ebx += extendKey[CNT * 2 + 1]</span><br></pre></td></tr></table></figure>

<h3 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line">result = [<span class="number">4</span>, <span class="number">58</span>, <span class="number">242</span>, <span class="number">54</span>, <span class="number">86</span>, <span class="number">177</span>, <span class="number">154</span>, <span class="number">252</span>, <span class="number">247</span>, <span class="number">30</span>, <span class="number">33</span>, <span class="number">220</span>, <span class="number">219</span>, <span class="number">143</span>, <span class="number">142</span>, <span class="number">148</span>, <span class="number">77</span>, <span class="number">52</span>, <span class="number">231</span>, <span class="number">157</span>, <span class="number">156</span>, <span class="number">82</span>, <span class="number">12</span>, <span class="number">110</span>, <span class="number">251</span>, <span class="number">250</span>, <span class="number">213</span>, <span class="number">253</span>, <span class="number">50</span>, <span class="number">249</span>, <span class="number">120</span>, <span class="number">44</span>, <span class="number">187</span>, <span class="number">190</span>, <span class="number">57</span>, <span class="number">193</span>, <span class="number">217</span>, <span class="number">133</span>, <span class="number">117</span>, <span class="number">182</span>, <span class="number">40</span>, <span class="number">248</span>, <span class="number">204</span>, <span class="number">120</span>, <span class="number">164</span>, <span class="number">228</span>, <span class="number">133</span>, <span class="number">146</span>, <span class="number">14</span>, <span class="number">189</span>, <span class="number">114</span>, <span class="number">197</span>, <span class="number">175</span>, <span class="number">135</span>, <span class="number">145</span>, <span class="number">42</span>, <span class="number">139</span>, <span class="number">241</span>, <span class="number">239</span>, <span class="number">150</span>, <span class="number">22</span>, <span class="number">96</span>, <span class="number">209</span>, <span class="number">18</span>]</span><br><span class="line">extendKey = [<span class="number">1835819331</span>, <span class="number">1853321028</span>, <span class="number">1768711490</span>, <span class="number">1432712805</span>, <span class="number">2177920767</span>, <span class="number">4020699579</span>, <span class="number">2261476601</span>, <span class="number">3551400604</span>, <span class="number">711874531</span>, <span class="number">3318306392</span>, <span class="number">1124217505</span>, <span class="number">2427199549</span>, <span class="number">3099853672</span>, <span class="number">2098025776</span>, <span class="number">1041196945</span>, <span class="number">2929936300</span>, <span class="number">246748610</span>, <span class="number">1941455090</span>, <span class="number">1303848803</span>, <span class="number">3809763535</span>, <span class="number">1395557789</span>, <span class="number">546751855</span>, <span class="number">1830937100</span>, <span class="number">2385871555</span>, <span class="number">2516030638</span>, <span class="number">3043054017</span>, <span class="number">3628118989</span>, <span class="number">1450520846</span>, <span class="number">1825094265</span>, <span class="number">3651791800</span>, <span class="number">32069749</span>, <span class="number">1469868411</span>, <span class="number">919887482</span>, <span class="number">4017993154</span>, <span class="number">4002737591</span>, <span class="number">3104343244</span>, <span class="number">4134211933</span>, <span class="number">420914335</span>, <span class="number">4152510760</span>, <span class="number">1317719524</span>, <span class="number">1990496755</span>, <span class="number">1873950060</span>, <span class="number">2553314372</span>, <span class="number">3602559392</span>]</span><br><span class="line">flag = <span class="built_in">bytes</span>()</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">64</span>, <span class="number">8</span>):</span><br><span class="line">    part1 = struct.unpack(<span class="string">&#x27;&gt;I&#x27;</span>, <span class="built_in">bytes</span>(result[j + <span class="number">0</span>:j + <span class="number">4</span>]))[<span class="number">0</span>]</span><br><span class="line">    part2 = struct.unpack(<span class="string">&#x27;&gt;I&#x27;</span>, <span class="built_in">bytes</span>(result[j + <span class="number">4</span>:j + <span class="number">8</span>]))[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">21</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">        part2 = (part2 - extendKey[i * <span class="number">2</span> + <span class="number">1</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        num = part1 &amp; <span class="number">31</span></span><br><span class="line">        temp = ((part2 &gt;&gt; num) &amp; <span class="number">0xFFFFFFFF</span>) | ((part2 &lt;&lt; (<span class="number">32</span> - num)) &amp; <span class="number">0xFFFFFFFF</span>)</span><br><span class="line">        part2 = temp ^ part1</span><br><span class="line"></span><br><span class="line">        part1 = (part1 - extendKey[i * <span class="number">2</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        num = part2 &amp; <span class="number">31</span></span><br><span class="line">        temp = ((part1 &gt;&gt; num) &amp; <span class="number">0xFFFFFFFF</span>) | ((part1 &lt;&lt; (<span class="number">32</span> - num)) &amp; <span class="number">0xFFFFFFFF</span>)</span><br><span class="line">        part1 = temp ^ part2</span><br><span class="line">    part1 = (part1 - extendKey[<span class="number">0</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    part2 = (part2 - extendKey[<span class="number">1</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">if</span> j != <span class="number">0</span>:</span><br><span class="line">        part1 ^= struct.unpack(<span class="string">&#x27;&gt;I&#x27;</span>, <span class="built_in">bytes</span>(result[j - <span class="number">8</span>:j - <span class="number">4</span>]))[<span class="number">0</span>]</span><br><span class="line">        part2 ^= struct.unpack(<span class="string">&#x27;&gt;I&#x27;</span>, <span class="built_in">bytes</span>(result[j - <span class="number">4</span>:j]))[<span class="number">0</span>]</span><br><span class="line">    flag += struct.pack(<span class="string">&#x27;&gt;I&#x27;</span>, part1) + struct.pack(<span class="string">&#x27;&gt;I&#x27;</span>, part2)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># b&#x27;WMCTF&#123;G00dEv3ning!Y0uAreAwes0m3!!RightBackFromB1ackM1rr0r!WOW!!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="其他师傅的patch脚本"><a href="#其他师傅的patch脚本" class="headerlink" title="其他师傅的patch脚本"></a>其他师傅的patch脚本</h3><p>PZ师傅是将花指令删除，并且更改了代码段中跳转指令的参数，使其逻辑正确。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sliceCode</span>(<span class="params">code</span>):</span><br><span class="line">    code_attribute = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(code)):</span><br><span class="line">        <span class="comment"># 检测到0x73开头的部分，即代码段部分</span></span><br><span class="line">        <span class="keyword">if</span> code[i] == <span class="number">0x73</span>:</span><br><span class="line">            <span class="comment"># 获取代码段长度</span></span><br><span class="line">            size = <span class="built_in">int</span>(struct.unpack(<span class="string">&quot;&lt;I&quot;</span>, <span class="built_in">bytes</span>(code[i + <span class="number">1</span>:i + <span class="number">5</span>]))[<span class="number">0</span>])</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                num = <span class="number">3</span> + i</span><br><span class="line">                <span class="comment"># 代码段一般以 53 00 结尾（即 RETURN_VALUE），此时检测是否倒数第二个位置为53</span></span><br><span class="line">                <span class="keyword">if</span> code[size + num] == <span class="number">0x53</span>:</span><br><span class="line">                    <span class="comment"># 添加代码段起始位置和长度</span></span><br><span class="line">                    code_attribute.append(&#123;</span><br><span class="line">                        <span class="string">&#x27;index&#x27;</span>: i + <span class="number">5</span>,</span><br><span class="line">                        <span class="string">&#x27;len&#x27;</span>: size</span><br><span class="line">                    &#125;)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">    code_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(code_attribute)):</span><br><span class="line">        <span class="comment"># 添加代码段数据</span></span><br><span class="line">        code_list.append(code[code_attribute[i][<span class="string">&#x27;index&#x27;</span>]: code_attribute[i][<span class="string">&#x27;index&#x27;</span>] + code_attribute[i][<span class="string">&#x27;len&#x27;</span>]])</span><br><span class="line">    <span class="keyword">return</span> code_attribute, code_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">repairJump</span>(<span class="params">code</span>):</span><br><span class="line">    flower_target = [<span class="number">0x6E</span>, <span class="number">0x0</span>]  <span class="comment"># 花指令开头的两个字节</span></span><br><span class="line">    relative_jump_list = [<span class="number">0x6E</span>, <span class="number">0x78</span>, <span class="number">0x5D</span>]  <span class="comment"># 相对跳转指令 字节码</span></span><br><span class="line">    <span class="comment"># JUMP_FORWARD 0x6e</span></span><br><span class="line">    absolute_jump_list = [<span class="number">0x6F</span>, <span class="number">0x70</span>, <span class="number">0x71</span>, <span class="number">0x72</span>, <span class="number">0x73</span>, <span class="number">0x77</span>]  <span class="comment"># 绝对跳转指令 字节码</span></span><br><span class="line">    <span class="comment"># JUMP_IF_FALSE_OR_POP 0x6f</span></span><br><span class="line">    <span class="comment"># JUMP_IF_TRUE_OR_POP 0x70</span></span><br><span class="line">    <span class="comment"># JUMP_ABSOLUTE 0x71</span></span><br><span class="line">    <span class="comment"># POP_JUMP_IF_FALSE 0x72</span></span><br><span class="line">    <span class="comment"># POP_JUMP_IF_TRUE 0x73</span></span><br><span class="line">    <span class="comment"># RERAISE 0x77</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(code)):</span><br><span class="line">        <span class="keyword">if</span> code[i] <span class="keyword">in</span> relative_jump_list:</span><br><span class="line">            cnt = <span class="number">0</span></span><br><span class="line">            <span class="comment"># 跳转位置</span></span><br><span class="line">            jmp_range = code[i + <span class="number">1</span>] + i + <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> jmp_range &gt; <span class="built_in">len</span>(code):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">2</span>, jmp_range):</span><br><span class="line">                <span class="comment"># 检测是否是无效的跳转指令</span></span><br><span class="line">                <span class="keyword">if</span> code[j] == flower_target[<span class="number">0</span>] <span class="keyword">and</span> code[j + <span class="number">1</span>] == flower_target[<span class="number">1</span>] <span class="keyword">and</span> j % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                    cnt += <span class="number">1</span></span><br><span class="line">            <span class="comment"># 由于本题的花指令为12个字节，因此需要消除后并减去12</span></span><br><span class="line">            code[i + <span class="number">1</span>] -= cnt * <span class="number">12</span></span><br><span class="line">        <span class="keyword">elif</span> code[i] <span class="keyword">in</span> absolute_jump_list:</span><br><span class="line">            cnt = <span class="number">0</span></span><br><span class="line">            <span class="comment"># 跳转位置</span></span><br><span class="line">            jmp_range = code[i + <span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> jmp_range &gt; <span class="built_in">len</span>(code):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(jmp_range):</span><br><span class="line">                <span class="comment"># 检测是否是无效的跳转指令</span></span><br><span class="line">                <span class="keyword">if</span> code[j] == flower_target[<span class="number">0</span>] <span class="keyword">and</span> code[j + <span class="number">1</span>] == flower_target[<span class="number">1</span>] <span class="keyword">and</span> j % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                    cnt += <span class="number">1</span></span><br><span class="line">            code[i + <span class="number">1</span>] -= cnt * <span class="number">12</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> code</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">removeFlower</span>(<span class="params">code</span>):</span><br><span class="line">    org_code = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    flowerTarget = [<span class="number">0x6E</span>, <span class="number">0x0</span>]</span><br><span class="line">    flower_index = []</span><br><span class="line">    <span class="comment"># 检测无用跳转位置</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(code)):</span><br><span class="line">        <span class="keyword">if</span> code[i] == flowerTarget[<span class="number">0</span>] <span class="keyword">and</span> code[i + <span class="number">1</span>] == flowerTarget[<span class="number">1</span>] <span class="keyword">and</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            flower_index.append(i)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 去掉花指令，并拼接正确指令</span></span><br><span class="line">        org_code += <span class="built_in">bytes</span>(code[:flower_index[<span class="number">0</span>]])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(flower_index)):</span><br><span class="line">            org_code += <span class="built_in">bytes</span>(code[flower_index[i - <span class="number">1</span>] + <span class="number">12</span>:flower_index[i]])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            org_code += <span class="built_in">bytes</span>(code[flower_index[i] + <span class="number">12</span>:])</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        org_code = <span class="built_in">bytes</span>(code)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> org_code</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    filename = <span class="string">&quot;obf_RightBack.pyc&quot;</span></span><br><span class="line">    f = <span class="built_in">list</span>(<span class="built_in">open</span>(filename, <span class="string">&quot;rb&quot;</span>).read())</span><br><span class="line"></span><br><span class="line">    code_attribute, code_list = sliceCode(f)</span><br><span class="line">    file = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(code_attribute)):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(code_list[i]) &lt;= <span class="number">0x100</span>:</span><br><span class="line">            code_list[i] = repairJump(code_list[i])</span><br><span class="line">            code_list[i] = removeFlower(code_list[i])</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">            <span class="comment"># 拼接更改后的代码段：前面的数据 + 更改后的代码段长度 + 更改后的代码段</span></span><br><span class="line">            file += <span class="built_in">bytes</span>(f[:code_attribute[i][<span class="string">&#x27;index&#x27;</span>] - <span class="number">4</span>]) + struct.pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="built_in">len</span>(code_list[i])) + <span class="built_in">bytes</span>(</span><br><span class="line">                code_list[i])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            file += <span class="built_in">bytes</span>(</span><br><span class="line">                f[code_attribute[i - <span class="number">1</span>][<span class="string">&#x27;index&#x27;</span>] + code_attribute[i - <span class="number">1</span>][<span class="string">&#x27;len&#x27;</span>]:code_attribute[i][<span class="string">&#x27;index&#x27;</span>] - <span class="number">4</span>]</span><br><span class="line">            ) + struct.pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="built_in">len</span>(code_list[i])) + <span class="built_in">bytes</span>(code_list[i])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        file += <span class="built_in">bytes</span>(f[code_attribute[i][<span class="string">&#x27;index&#x27;</span>] + code_attribute[i][<span class="string">&#x27;len&#x27;</span>]:])</span><br><span class="line"></span><br><span class="line">    filename = <span class="string">&#x27;rev_&#x27;</span> + filename</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(file)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;OK!&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="ezAndroid"><a href="#ezAndroid" class="headerlink" title="ezAndroid"></a>ezAndroid</h2><h3 id="apk逻辑"><a href="#apk逻辑" class="headerlink" title="apk逻辑"></a>apk逻辑</h3><p>apk逻辑很简单，主要看两个so的函数：<code>check2、ChechUsername</code></p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230901200148197.png"></p>
<p>ida查看so没有看见这两个函数，wp说是JNI动态注册，可以使用frida将其hook。</p>
<h3 id="反frida"><a href="#反frida" class="headerlink" title="反frida"></a>反frida</h3><h4 id="大致逻辑"><a href="#大致逻辑" class="headerlink" title="大致逻辑"></a>大致逻辑</h4><p>在<code>.init_array</code>中有一个函数为反frida。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">a1 = [<span class="number">0xCF</span>, <span class="number">0xC3</span>, <span class="number">0xAD</span>, <span class="number">0xA8</span>, <span class="number">0x7A</span>, <span class="number">0x41</span>, <span class="number">0x6E</span>, <span class="number">0x9E</span>, <span class="number">0x61</span>, <span class="number">0x0F</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x55</span>, <span class="number">0xB5</span>, <span class="number">0x2D</span>, <span class="number">0x26</span>, <span class="number">0x60</span>, <span class="number">0x7F</span>, <span class="number">0xA4</span>,</span><br><span class="line">      <span class="number">0xFC</span>, <span class="number">0xCF</span>, <span class="number">0xB7</span>, <span class="number">0x5F</span>, <span class="number">0x33</span>, <span class="number">0xFF</span>, <span class="number">0x65</span>, <span class="number">0x02</span>, <span class="number">0x17</span>, <span class="number">0xBF</span>, <span class="number">0x95</span>, <span class="number">0x47</span>, <span class="number">0x6D</span>, <span class="number">0xC4</span>, <span class="number">0xAE</span>, <span class="number">0x5E</span>, <span class="number">0xC8</span>, <span class="number">0x4D</span>, <span class="number">0x54</span>,</span><br><span class="line">      <span class="number">0xD4</span>, <span class="number">0x69</span>, <span class="number">0xD8</span>, <span class="number">0xEE</span>, <span class="number">0x70</span>, <span class="number">0x43</span>, <span class="number">0x8D</span>, <span class="number">0x0A</span>, <span class="number">0x61</span>, <span class="number">0x38</span>, <span class="number">0xCC</span>, <span class="number">0xF0</span>, <span class="number">0x2B</span>, <span class="number">0x0B</span>, <span class="number">0xEB</span>, <span class="number">0xC3</span>, <span class="number">0x3F</span>, <span class="number">0xB8</span>, <span class="number">0x3E</span>,</span><br><span class="line">      <span class="number">0x54</span>, <span class="number">0xDA</span>, <span class="number">0xEF</span>, <span class="number">0xB3</span>, <span class="number">0x4A</span>, <span class="number">0x1F</span>, <span class="number">0x00</span>, <span class="number">0x6B</span>, <span class="number">0x5D</span>, <span class="number">0xA0</span>, <span class="number">0xB5</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xBA</span>, <span class="number">0xB0</span>, <span class="number">0x1F</span>, <span class="number">0x6D</span>, <span class="number">0xE4</span>, <span class="number">0x23</span>,</span><br><span class="line">      <span class="number">0x1E</span>, <span class="number">0xCC</span>, <span class="number">0x83</span>, <span class="number">0xFE</span>, <span class="number">0xA3</span>, <span class="number">0x86</span>, <span class="number">0xF0</span>, <span class="number">0xB0</span>, <span class="number">0xDA</span>, <span class="number">0x8A</span>, <span class="number">0xBF</span>, <span class="number">0xB1</span>, <span class="number">0x43</span>, <span class="number">0x2C</span>, <span class="number">0xF6</span>, <span class="number">0x50</span>, <span class="number">0x5F</span>, <span class="number">0xBB</span>, <span class="number">0x0C</span>,</span><br><span class="line">      <span class="number">0xA8</span>, <span class="number">0x69</span>, <span class="number">0x29</span>, <span class="number">0x3A</span>, <span class="number">0x08</span>, <span class="number">0xE4</span>, <span class="number">0x1B</span>, <span class="number">0xFE</span>, <span class="number">0x8B</span>, <span class="number">0x08</span>, <span class="number">0x2F</span>, <span class="number">0x86</span>, <span class="number">0x06</span>, <span class="number">0x5E</span>, <span class="number">0x1E</span>, <span class="number">0xFA</span>, <span class="number">0xC2</span>, <span class="number">0xDA</span>, <span class="number">0x93</span>,</span><br><span class="line">      <span class="number">0xE5</span>, <span class="number">0xDD</span>, <span class="number">0x45</span>, <span class="number">0x4E</span>, <span class="number">0x4A</span>, <span class="number">0x31</span>, <span class="number">0xB5</span>, <span class="number">0x5D</span>, <span class="number">0x94</span>, <span class="number">0x33</span>, <span class="number">0x38</span>, <span class="number">0x3F</span>, <span class="number">0x42</span>, <span class="number">0xFF</span>, <span class="number">0x27</span>, <span class="number">0x3D</span>, <span class="number">0x7F</span>, <span class="number">0x74</span>, <span class="number">0x3B</span>,</span><br><span class="line">      <span class="number">0xF4</span>, <span class="number">0x8A</span>, <span class="number">0x61</span>, <span class="number">0xF4</span>, <span class="number">0xBF</span>, <span class="number">0x8C</span>, <span class="number">0xD6</span>, <span class="number">0x6C</span>, <span class="number">0x81</span>, <span class="number">0x2D</span>, <span class="number">0xE2</span>, <span class="number">0x42</span>, <span class="number">0x09</span>, <span class="number">0xCD</span>, <span class="number">0xC6</span>, <span class="number">0xF2</span>, <span class="number">0x12</span>, <span class="number">0x49</span>, <span class="number">0x9D</span>,</span><br><span class="line">      <span class="number">0xEE</span>, <span class="number">0x00</span>, <span class="number">0xf4</span>]</span><br><span class="line">a2 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    a2.append(a1[<span class="number">22</span> + i % <span class="number">0x14</span>] ^ a1[<span class="number">22</span> + <span class="number">20</span> + i])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytearray</span>(a2))</span><br><span class="line">a3 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    a3.append((a1[<span class="number">83</span> + i % <span class="number">0x1C</span>] ^ a1[<span class="number">83</span> + <span class="number">28</span> + i]))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytearray</span>(a3))</span><br><span class="line">a4 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    a4.append((a1[<span class="number">0x83</span> + i % <span class="number">0x12</span>] ^ a1[<span class="number">0x83</span> + <span class="number">18</span> + i]))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytearray</span>(a4))</span><br><span class="line"><span class="comment"># bytearray(b&#x27;/proc/self/maps\x00&#x27;)</span></span><br><span class="line"><span class="comment"># bytearray(b&#x27;r\x00&#x27;)</span></span><br><span class="line"><span class="comment"># bytearray(b&#x27;frida\x00&#x27;)</span></span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/21/CTF-wp-1/image-20230901195349881.png"></p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230901172412129.png"></p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230901172428191.png"></p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230901195137311.png"></p>
<p>i与v3有关，因此当判断出maps含有frida则程序退出。</p>
<h4 id="frida-hook"><a href="#frida-hook" class="headerlink" title="frida hook"></a>frida hook</h4><p>frida hook掉pthread_create函数。</p>
<p>逻辑为：当第四个参数为0时，将第三个参数替换为自定义的函数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># frida -U -f com.<span class="property">wmctf</span>.<span class="property">ezandroid</span> -l .\frida.<span class="property">js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_AntiFrida_func</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> pthread_create_addr = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="string">&quot;libc.so&quot;</span>, <span class="string">&quot;pthread_create&quot;</span>);</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(pthread_create_addr, &#123;</span><br><span class="line">        <span class="title function_">onEnter</span>(<span class="params">args</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> func_addr = args[<span class="number">2</span>];</span><br><span class="line">            <span class="keyword">if</span> (args[<span class="number">3</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="title class_">Interceptor</span>.<span class="title function_">replace</span>(func_addr, <span class="keyword">new</span> <span class="title class_">NativeCallback</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[*] Replace antiFrida success!&quot;</span>);</span><br><span class="line">                &#125;, <span class="string">&#x27;void&#x27;</span>, []))</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="native函数"><a href="#native函数" class="headerlink" title="native函数"></a>native函数</h3><p>frida hook脚本：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_RegisterNatives</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> symbols = <span class="title class_">Process</span>.<span class="title function_">getModuleByName</span>(<span class="string">&#x27;libart.so&#x27;</span>).<span class="title function_">enumerateSymbols</span>();</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">RegisterNatives</span>_addr = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; symbols.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> symbol = symbols[i];</span><br><span class="line">        <span class="keyword">if</span> (symbol.<span class="property">name</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;RegisterNatives&quot;</span>) != -<span class="number">1</span> &amp;&amp; symbol.<span class="property">name</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;CheckJNI&quot;</span>) == -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="title class_">RegisterNatives</span>_addr = symbol.<span class="property">address</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;RegisterNatives_addr: &quot;</span>, <span class="title class_">RegisterNatives</span>_addr);</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(<span class="title class_">RegisterNatives</span>_addr, &#123;</span><br><span class="line">        <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> env = <span class="title class_">Java</span>.<span class="property">vm</span>.<span class="title function_">tryGetEnv</span>();</span><br><span class="line">            <span class="keyword">var</span> className = env.<span class="title function_">getClassName</span>(args[<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">var</span> methodCount = args[<span class="number">3</span>].<span class="title function_">toInt32</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; methodCount; i++) &#123;</span><br><span class="line">                <span class="keyword">var</span> methodName = args[<span class="number">2</span>].<span class="title function_">add</span>(<span class="title class_">Process</span>.<span class="property">pointerSize</span> * <span class="number">3</span> * i).<span class="title function_">add</span>(<span class="title class_">Process</span>.<span class="property">pointerSize</span> * <span class="number">0</span>).<span class="title function_">readPointer</span>().<span class="title function_">readCString</span>();</span><br><span class="line">                <span class="keyword">var</span> signature = args[<span class="number">2</span>].<span class="title function_">add</span>(<span class="title class_">Process</span>.<span class="property">pointerSize</span> * <span class="number">3</span> * i).<span class="title function_">add</span>(<span class="title class_">Process</span>.<span class="property">pointerSize</span> * <span class="number">1</span>).<span class="title function_">readPointer</span>().<span class="title function_">readCString</span>();</span><br><span class="line">                <span class="keyword">var</span> fnPtr =</span><br><span class="line">                    args[<span class="number">2</span>].<span class="title function_">add</span>(<span class="title class_">Process</span>.<span class="property">pointerSize</span> * <span class="number">3</span> * i).<span class="title function_">add</span>(<span class="title class_">Process</span>.<span class="property">pointerSize</span> * <span class="number">2</span>).<span class="title function_">readPointer</span>();</span><br><span class="line">                <span class="keyword">var</span> <span class="variable language_">module</span> = <span class="title class_">Process</span>.<span class="title function_">findModuleByAddress</span>(fnPtr);</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(className, methodName, signature, fnPtr, <span class="variable language_">module</span>.<span class="property">name</span>, fnPtr.<span class="title function_">sub</span>(<span class="variable language_">module</span>.<span class="property">base</span>));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;, <span class="attr">onLeave</span>: <span class="keyword">function</span> (<span class="params">retval</span>) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>得到结果：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230901201747035.png"></p>
<p><code>CheckUsername: 0x2b90</code></p>
<p><code>check2: 0x32f0</code></p>
<h3 id="SO函数"><a href="#SO函数" class="headerlink" title="SO函数"></a>SO函数</h3><h4 id="CheckUsername"><a href="#CheckUsername" class="headerlink" title="CheckUsername"></a>CheckUsername</h4><p>被混淆了，主要逻辑在这里：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230908143302176.png"></p>
<p>sub_57D0可以明显看出是RC4。</p>
<p>手动分析后，逻辑如下：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230901222832700.png"></p>
<p>RC4初始化一：1-3 -&gt; 1-2 -&gt; 2 -&gt; 1-3</p>
<p>RC4初始化二：7 -&gt; 4 -&gt; 3 -&gt; 7</p>
<p>RC4解密：5 -&gt; 1-1 -&gt; 5</p>
<h5 id="还原代码"><a href="#还原代码" class="headerlink" title="还原代码"></a>还原代码</h5><p>知道逻辑就可以了，但这里尝试手动patch还原一下代码。</p>
<p>主要有两类代码需要patch，先展示结果：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230901224013705.png"></p>
<h6 id="第一种"><a href="#第一种" class="headerlink" title="第一种"></a>第一种</h6><p>将两段代码之间添加了一条jmp语句，使其去往分发器。</p>
<p>直接去掉jmp语句即可。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230901223138224.png"></p>
<h6 id="第二种"><a href="#第二种" class="headerlink" title="第二种"></a>第二种</h6><p>这就是判断index是否大于256。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230901223601498.png" alt="image-20230901223601498"></p>
<p>看看block7的地址，就在判断的下面：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230901223747194.png"></p>
<p>因此直接将汇编：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mov     eax, [rbp+index]</span><br><span class="line">mov     ecx, [rbp+var_214]</span><br><span class="line">sub     ecx, 6DD586C3h</span><br><span class="line">mov     edx, [rbp+var_214]</span><br><span class="line">sub     edx, 15E1168Ah</span><br><span class="line">cmp     eax, 100h</span><br><span class="line">cmovl   edx, ecx</span><br><span class="line">loc_5B0F:</span><br><span class="line">mov     [rbp+var_250], edx</span><br><span class="line">jmp     loc_5D49</span><br></pre></td></tr></table></figure>

<p>改成：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov     eax, [rbp+index]</span><br><span class="line">cmp     eax, 100h</span><br><span class="line">jge 	loc_5BC0</span><br></pre></td></tr></table></figure>

<h5 id="frida-hook-RC4函数的参数"><a href="#frida-hook-RC4函数的参数" class="headerlink" title="frida hook RC4函数的参数"></a>frida hook RC4函数的参数</h5><p>脚本：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_sub_57D0</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> soAddr = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libezandroid.so&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> sub_57D0 = soAddr.<span class="title function_">add</span>(<span class="number">0x57D0</span>);</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(sub_57D0, &#123;</span><br><span class="line">        <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[*] sub_57D0 called!&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg0: &quot;</span> + args[<span class="number">0</span>].<span class="title function_">readCString</span>());</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg1: &quot;</span> + args[<span class="number">1</span>].<span class="title function_">readCString</span>());</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg2: &quot;</span> + args[<span class="number">2</span>]);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg3: &quot;</span> + args[<span class="number">3</span>].<span class="title function_">readCString</span>());</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg4: &quot;</span> + args[<span class="number">4</span>]);</span><br><span class="line">        &#125;, <span class="attr">onLeave</span>: <span class="keyword">function</span> (<span class="params">retval</span>) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230908143625931.png"></p>
<p>可见密钥是：<code>12345678</code></p>
<p>注意到加密的时候还异或了index：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230908143742256.png"></p>
<p>因此解密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_decrypt</span>(<span class="params">key, ciphertext</span>):</span><br><span class="line">    cipher = ARC4.new(key.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    plaintext = cipher.decrypt(ciphertext)</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line">key = <span class="string">&quot;12345678&quot;</span></span><br><span class="line">ciphertext = <span class="built_in">bytearray</span>([<span class="number">0xE9</span>, <span class="number">0x97</span>, <span class="number">0x64</span>, <span class="number">0xE6</span>, <span class="number">0x7E</span>, <span class="number">0xEB</span>, <span class="number">0xBD</span>, <span class="number">0xC1</span>, <span class="number">0xAB</span>, <span class="number">0x43</span>])</span><br><span class="line">plaintext = <span class="built_in">list</span>(rc4_decrypt(key, ciphertext))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(plaintext)):</span><br><span class="line">    plaintext[i] ^= i</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytearray</span>(plaintext))</span><br><span class="line"><span class="comment"># Re_1s_eaSy</span></span><br></pre></td></tr></table></figure>

<h4 id="check2"><a href="#check2" class="headerlink" title="check2"></a>check2</h4><p>同样是被混淆了，主题逻辑在这：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230908150458516.png" alt="image-20230908150458516"></p>
<blockquote>
<ol>
<li><code>movups xmm0, xmmword ptr [rcx]</code>: 将<code>rcx</code>寄存器指向的内存中的128位数据加载到<code>xmm0</code>寄存器中。</li>
<li><code>movups xmm1, xmmword ptr [rax]</code>: 将<code>rax</code>寄存器指向的内存中的128位数据加载到<code>xmm1</code>寄存器中。</li>
<li><code>pcmpeqb xmm1, xmm0</code>: 执行128位数据的比较操作，将比较结果保存在<code>xmm1</code>寄存器中。这里的<code>pcmpeqb</code>指令是用于比较两个XMM寄存器中的数据是否相等，结果是每个字节的比较结果（相等为0xFF，不等为0x00）。</li>
<li><code>pmovmskb esi, xmm1</code>: 将<code>xmm1</code>寄存器中的比较结果按位转换成一个32位整数，并将结果保存在<code>esi</code>寄存器中。这个操作通常用于提取比较结果的掩码，其中每个位表示一个字节是否相等。</li>
</ol>
</blockquote>
<p>因此，也是一个加密，比对的过程。</p>
<h5 id="分析加密过程"><a href="#分析加密过程" class="headerlink" title="分析加密过程"></a>分析加密过程</h5><p>由findcrypt找到AES特征，交叉引用看一下各个函数：</p>
<p>字节代换：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230908151420162.png"></p>
<p>轮密钥生成的T函数：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230908152205220.png"></p>
<p>大概猜测其为AES。</p>
<p>注意到AES的Sbox盒在看交叉引用时有被赋值的操作，且<code>sub_2690</code>在<code>.init_array</code>中，表明SBOX表被更换了：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230908153726756.png"></p>
<p>这里同样使用frida获取其参数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_sub_B30</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> soAddr = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libezandroid.so&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> sub_B30 = soAddr.<span class="title function_">add</span>(<span class="number">0xB30</span>);</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(sub_B30, &#123;</span><br><span class="line">        <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[*] sub_AFC called!&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg0: &quot;</span> + args[<span class="number">0</span>].<span class="title function_">readCString</span>());</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg1: &quot;</span> + args[<span class="number">1</span>]);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg2: &quot;</span> + args[<span class="number">2</span>].<span class="title function_">readCString</span>());</span><br><span class="line">        &#125;, <span class="attr">onLeave</span>:<span class="keyword">function</span> (<span class="params">retval</span>) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230908153433276.png"></p>
<p>故解密：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Nb 4  <span class="comment">// 数据块行数</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Nk 4  <span class="comment">// 密码块行数</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Nr 10 <span class="comment">// 轮加密次数</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> RoundKey[<span class="number">4</span> * Nb * (Nr + <span class="number">1</span>)]; <span class="comment">// 轮密钥</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> Key[<span class="number">17</span>];                     <span class="comment">// 密钥</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> state[<span class="number">4</span>][<span class="number">4</span>];                 <span class="comment">// 明文加密状态</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 实际上只需要用Rocn[1-10] </span></span><br><span class="line"><span class="comment">// 轮常量</span></span><br><span class="line"><span class="type">int</span> Rcon[<span class="number">255</span>] = &#123;</span><br><span class="line">    <span class="number">0x8d</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x80</span>, <span class="number">0x1b</span>, <span class="number">0x36</span>, <span class="number">0x6c</span>, <span class="number">0xd8</span>, <span class="number">0xab</span>, <span class="number">0x4d</span>, <span class="number">0x9a</span>,</span><br><span class="line">    <span class="number">0x2f</span>, <span class="number">0x5e</span>, <span class="number">0xbc</span>, <span class="number">0x63</span>, <span class="number">0xc6</span>, <span class="number">0x97</span>, <span class="number">0x35</span>, <span class="number">0x6a</span>, <span class="number">0xd4</span>, <span class="number">0xb3</span>, <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0xef</span>, <span class="number">0xc5</span>, <span class="number">0x91</span>, <span class="number">0x39</span>,</span><br><span class="line">    <span class="number">0x72</span>, <span class="number">0xe4</span>, <span class="number">0xd3</span>, <span class="number">0xbd</span>, <span class="number">0x61</span>, <span class="number">0xc2</span>, <span class="number">0x9f</span>, <span class="number">0x25</span>, <span class="number">0x4a</span>, <span class="number">0x94</span>, <span class="number">0x33</span>, <span class="number">0x66</span>, <span class="number">0xcc</span>, <span class="number">0x83</span>, <span class="number">0x1d</span>, <span class="number">0x3a</span>,</span><br><span class="line">    <span class="number">0x74</span>, <span class="number">0xe8</span>, <span class="number">0xcb</span>, <span class="number">0x8d</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x80</span>, <span class="number">0x1b</span>, <span class="number">0x36</span>, <span class="number">0x6c</span>, <span class="number">0xd8</span>,</span><br><span class="line">    <span class="number">0xab</span>, <span class="number">0x4d</span>, <span class="number">0x9a</span>, <span class="number">0x2f</span>, <span class="number">0x5e</span>, <span class="number">0xbc</span>, <span class="number">0x63</span>, <span class="number">0xc6</span>, <span class="number">0x97</span>, <span class="number">0x35</span>, <span class="number">0x6a</span>, <span class="number">0xd4</span>, <span class="number">0xb3</span>, <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0xef</span>,</span><br><span class="line">    <span class="number">0xc5</span>, <span class="number">0x91</span>, <span class="number">0x39</span>, <span class="number">0x72</span>, <span class="number">0xe4</span>, <span class="number">0xd3</span>, <span class="number">0xbd</span>, <span class="number">0x61</span>, <span class="number">0xc2</span>, <span class="number">0x9f</span>, <span class="number">0x25</span>, <span class="number">0x4a</span>, <span class="number">0x94</span>, <span class="number">0x33</span>, <span class="number">0x66</span>, <span class="number">0xcc</span>,</span><br><span class="line">    <span class="number">0x83</span>, <span class="number">0x1d</span>, <span class="number">0x3a</span>, <span class="number">0x74</span>, <span class="number">0xe8</span>, <span class="number">0xcb</span>, <span class="number">0x8d</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x80</span>, <span class="number">0x1b</span>,</span><br><span class="line">    <span class="number">0x36</span>, <span class="number">0x6c</span>, <span class="number">0xd8</span>, <span class="number">0xab</span>, <span class="number">0x4d</span>, <span class="number">0x9a</span>, <span class="number">0x2f</span>, <span class="number">0x5e</span>, <span class="number">0xbc</span>, <span class="number">0x63</span>, <span class="number">0xc6</span>, <span class="number">0x97</span>, <span class="number">0x35</span>, <span class="number">0x6a</span>, <span class="number">0xd4</span>, <span class="number">0xb3</span>,</span><br><span class="line">    <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0xef</span>, <span class="number">0xc5</span>, <span class="number">0x91</span>, <span class="number">0x39</span>, <span class="number">0x72</span>, <span class="number">0xe4</span>, <span class="number">0xd3</span>, <span class="number">0xbd</span>, <span class="number">0x61</span>, <span class="number">0xc2</span>, <span class="number">0x9f</span>, <span class="number">0x25</span>, <span class="number">0x4a</span>, <span class="number">0x94</span>,</span><br><span class="line">    <span class="number">0x33</span>, <span class="number">0x66</span>, <span class="number">0xcc</span>, <span class="number">0x83</span>, <span class="number">0x1d</span>, <span class="number">0x3a</span>, <span class="number">0x74</span>, <span class="number">0xe8</span>, <span class="number">0xcb</span>, <span class="number">0x8d</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>,</span><br><span class="line">    <span class="number">0x40</span>, <span class="number">0x80</span>, <span class="number">0x1b</span>, <span class="number">0x36</span>, <span class="number">0x6c</span>, <span class="number">0xd8</span>, <span class="number">0xab</span>, <span class="number">0x4d</span>, <span class="number">0x9a</span>, <span class="number">0x2f</span>, <span class="number">0x5e</span>, <span class="number">0xbc</span>, <span class="number">0x63</span>, <span class="number">0xc6</span>, <span class="number">0x97</span>, <span class="number">0x35</span>,</span><br><span class="line">    <span class="number">0x6a</span>, <span class="number">0xd4</span>, <span class="number">0xb3</span>, <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0xef</span>, <span class="number">0xc5</span>, <span class="number">0x91</span>, <span class="number">0x39</span>, <span class="number">0x72</span>, <span class="number">0xe4</span>, <span class="number">0xd3</span>, <span class="number">0xbd</span>, <span class="number">0x61</span>, <span class="number">0xc2</span>, <span class="number">0x9f</span>,</span><br><span class="line">    <span class="number">0x25</span>, <span class="number">0x4a</span>, <span class="number">0x94</span>, <span class="number">0x33</span>, <span class="number">0x66</span>, <span class="number">0xcc</span>, <span class="number">0x83</span>, <span class="number">0x1d</span>, <span class="number">0x3a</span>, <span class="number">0x74</span>, <span class="number">0xe8</span>, <span class="number">0xcb</span>, <span class="number">0x8d</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>,</span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x80</span>, <span class="number">0x1b</span>, <span class="number">0x36</span>, <span class="number">0x6c</span>, <span class="number">0xd8</span>, <span class="number">0xab</span>, <span class="number">0x4d</span>, <span class="number">0x9a</span>, <span class="number">0x2f</span>, <span class="number">0x5e</span>, <span class="number">0xbc</span>, <span class="number">0x63</span>,</span><br><span class="line">    <span class="number">0xc6</span>, <span class="number">0x97</span>, <span class="number">0x35</span>, <span class="number">0x6a</span>, <span class="number">0xd4</span>, <span class="number">0xb3</span>, <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0xef</span>, <span class="number">0xc5</span>, <span class="number">0x91</span>, <span class="number">0x39</span>, <span class="number">0x72</span>, <span class="number">0xe4</span>, <span class="number">0xd3</span>, <span class="number">0xbd</span>,</span><br><span class="line">    <span class="number">0x61</span>, <span class="number">0xc2</span>, <span class="number">0x9f</span>, <span class="number">0x25</span>, <span class="number">0x4a</span>, <span class="number">0x94</span>, <span class="number">0x33</span>, <span class="number">0x66</span>, <span class="number">0xcc</span>, <span class="number">0x83</span>, <span class="number">0x1d</span>, <span class="number">0x3a</span>, <span class="number">0x74</span>, <span class="number">0xe8</span>, <span class="number">0xcb</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// s盒</span></span><br><span class="line"><span class="type">int</span> SBOX[<span class="number">256</span>] = &#123;</span><br><span class="line">    <span class="comment">// 0     1    2      3     4    5     6     7      8    9     A      B    C     D     E     F</span></span><br><span class="line">    <span class="number">0x29</span>, <span class="number">0x40</span>, <span class="number">0x57</span>, <span class="number">0x6E</span>, <span class="number">0x85</span>, <span class="number">0x9C</span>, <span class="number">0xB3</span>, <span class="number">0xCA</span>, <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x0F</span>, <span class="number">0x26</span>, <span class="number">0x3D</span>, <span class="number">0x54</span>, <span class="number">0x6B</span>, <span class="number">0x82</span>,</span><br><span class="line">    <span class="number">0x99</span>, <span class="number">0xB0</span>, <span class="number">0xC7</span>, <span class="number">0xDE</span>, <span class="number">0xF5</span>, <span class="number">0x0C</span>, <span class="number">0x23</span>, <span class="number">0x3A</span>, <span class="number">0x51</span>, <span class="number">0x68</span>, <span class="number">0x7F</span>, <span class="number">0x96</span>, <span class="number">0xAD</span>, <span class="number">0xC4</span>, <span class="number">0xDB</span>, <span class="number">0xF2</span>,</span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x20</span>, <span class="number">0x37</span>, <span class="number">0x4E</span>, <span class="number">0x65</span>, <span class="number">0x7C</span>, <span class="number">0x93</span>, <span class="number">0xAA</span>, <span class="number">0xC1</span>, <span class="number">0xD8</span>, <span class="number">0xEF</span>, <span class="number">0x06</span>, <span class="number">0x1D</span>, <span class="number">0x34</span>, <span class="number">0x4B</span>, <span class="number">0x62</span>,</span><br><span class="line">    <span class="number">0x79</span>, <span class="number">0x90</span>, <span class="number">0xA7</span>, <span class="number">0xBE</span>, <span class="number">0xD5</span>, <span class="number">0xEC</span>, <span class="number">0x03</span>, <span class="number">0x1A</span>, <span class="number">0x31</span>, <span class="number">0x48</span>, <span class="number">0x5F</span>, <span class="number">0x76</span>, <span class="number">0x8D</span>, <span class="number">0xA4</span>, <span class="number">0xBB</span>, <span class="number">0xD2</span>,</span><br><span class="line">    <span class="number">0xE9</span>, <span class="number">0x00</span>, <span class="number">0x17</span>, <span class="number">0x2E</span>, <span class="number">0x45</span>, <span class="number">0x5C</span>, <span class="number">0x73</span>, <span class="number">0x8A</span>, <span class="number">0xA1</span>, <span class="number">0xB8</span>, <span class="number">0xCF</span>, <span class="number">0xE6</span>, <span class="number">0xFD</span>, <span class="number">0x14</span>, <span class="number">0x2B</span>, <span class="number">0x42</span>,</span><br><span class="line">    <span class="number">0x59</span>, <span class="number">0x70</span>, <span class="number">0x87</span>, <span class="number">0x9E</span>, <span class="number">0xB5</span>, <span class="number">0xCC</span>, <span class="number">0xE3</span>, <span class="number">0xFA</span>, <span class="number">0x11</span>, <span class="number">0x28</span>, <span class="number">0x3F</span>, <span class="number">0x56</span>, <span class="number">0x6D</span>, <span class="number">0x84</span>, <span class="number">0x9B</span>, <span class="number">0xB2</span>,</span><br><span class="line">    <span class="number">0xC9</span>, <span class="number">0xE0</span>, <span class="number">0xF7</span>, <span class="number">0x0E</span>, <span class="number">0x25</span>, <span class="number">0x3C</span>, <span class="number">0x53</span>, <span class="number">0x6A</span>, <span class="number">0x81</span>, <span class="number">0x98</span>, <span class="number">0xAF</span>, <span class="number">0xC6</span>, <span class="number">0xDD</span>, <span class="number">0xF4</span>, <span class="number">0x0B</span>, <span class="number">0x22</span>,</span><br><span class="line">    <span class="number">0x39</span>, <span class="number">0x50</span>, <span class="number">0x67</span>, <span class="number">0x7E</span>, <span class="number">0x95</span>, <span class="number">0xAC</span>, <span class="number">0xC3</span>, <span class="number">0xDA</span>, <span class="number">0xF1</span>, <span class="number">0x08</span>, <span class="number">0x1F</span>, <span class="number">0x36</span>, <span class="number">0x4D</span>, <span class="number">0x64</span>, <span class="number">0x7B</span>, <span class="number">0x92</span>,</span><br><span class="line">    <span class="number">0xA9</span>, <span class="number">0xC0</span>, <span class="number">0xD7</span>, <span class="number">0xEE</span>, <span class="number">0x05</span>, <span class="number">0x1C</span>, <span class="number">0x33</span>, <span class="number">0x4A</span>, <span class="number">0x61</span>, <span class="number">0x78</span>, <span class="number">0x8F</span>, <span class="number">0xA6</span>, <span class="number">0xBD</span>, <span class="number">0xD4</span>, <span class="number">0xEB</span>, <span class="number">0x02</span>,</span><br><span class="line">    <span class="number">0x19</span>, <span class="number">0x30</span>, <span class="number">0x47</span>, <span class="number">0x5E</span>, <span class="number">0x75</span>, <span class="number">0x8C</span>, <span class="number">0xA3</span>, <span class="number">0xBA</span>, <span class="number">0xD1</span>, <span class="number">0xE8</span>, <span class="number">0xFF</span>, <span class="number">0x16</span>, <span class="number">0x2D</span>, <span class="number">0x44</span>, <span class="number">0x5B</span>, <span class="number">0x72</span>,</span><br><span class="line">    <span class="number">0x89</span>, <span class="number">0xA0</span>, <span class="number">0xB7</span>, <span class="number">0xCE</span>, <span class="number">0xE5</span>, <span class="number">0xFC</span>, <span class="number">0x13</span>, <span class="number">0x2A</span>, <span class="number">0x41</span>, <span class="number">0x58</span>, <span class="number">0x6F</span>, <span class="number">0x86</span>, <span class="number">0x9D</span>, <span class="number">0xB4</span>, <span class="number">0xCB</span>, <span class="number">0xE2</span>,</span><br><span class="line">    <span class="number">0xF9</span>, <span class="number">0x10</span>, <span class="number">0x27</span>, <span class="number">0x3E</span>, <span class="number">0x55</span>, <span class="number">0x6C</span>, <span class="number">0x83</span>, <span class="number">0x9A</span>, <span class="number">0xB1</span>, <span class="number">0xC8</span>, <span class="number">0xDF</span>, <span class="number">0xF6</span>, <span class="number">0x0D</span>, <span class="number">0x24</span>, <span class="number">0x3B</span>, <span class="number">0x52</span>,</span><br><span class="line">    <span class="number">0x69</span>, <span class="number">0x80</span>, <span class="number">0x97</span>, <span class="number">0xAE</span>, <span class="number">0xC5</span>, <span class="number">0xDC</span>, <span class="number">0xF3</span>, <span class="number">0x0A</span>, <span class="number">0x21</span>, <span class="number">0x38</span>, <span class="number">0x4F</span>, <span class="number">0x66</span>, <span class="number">0x7D</span>, <span class="number">0x94</span>, <span class="number">0xAB</span>, <span class="number">0xC2</span>,</span><br><span class="line">    <span class="number">0xD9</span>, <span class="number">0xF0</span>, <span class="number">0x07</span>, <span class="number">0x1E</span>, <span class="number">0x35</span>, <span class="number">0x4C</span>, <span class="number">0x63</span>, <span class="number">0x7A</span>, <span class="number">0x91</span>, <span class="number">0xA8</span>, <span class="number">0xBF</span>, <span class="number">0xD6</span>, <span class="number">0xED</span>, <span class="number">0x04</span>, <span class="number">0x1B</span>, <span class="number">0x32</span>,</span><br><span class="line">    <span class="number">0x49</span>, <span class="number">0x60</span>, <span class="number">0x77</span>, <span class="number">0x8E</span>, <span class="number">0xA5</span>, <span class="number">0xBC</span>, <span class="number">0xD3</span>, <span class="number">0xEA</span>, <span class="number">0x01</span>, <span class="number">0x18</span>, <span class="number">0x2F</span>, <span class="number">0x46</span>, <span class="number">0x5D</span>, <span class="number">0x74</span>, <span class="number">0x8B</span>, <span class="number">0xA2</span>,</span><br><span class="line">    <span class="number">0xB9</span>, <span class="number">0xD0</span>, <span class="number">0xE7</span>, <span class="number">0xFE</span>, <span class="number">0x15</span>, <span class="number">0x2C</span>, <span class="number">0x43</span>, <span class="number">0x5A</span>, <span class="number">0x71</span>, <span class="number">0x88</span>, <span class="number">0x9F</span>, <span class="number">0xB6</span>, <span class="number">0xCD</span>, <span class="number">0xE4</span>, <span class="number">0xFB</span>, <span class="number">0x12</span></span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 逆s盒</span></span><br><span class="line"><span class="type">int</span> R_SBOX[<span class="number">256</span>] = &#123;</span><br><span class="line">    <span class="number">0x41</span>, <span class="number">0xe8</span>, <span class="number">0x8f</span>, <span class="number">0x36</span>, <span class="number">0xdd</span>, <span class="number">0x84</span>, <span class="number">0x2b</span>, <span class="number">0xd2</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0xc7</span>, <span class="number">0x6e</span>, <span class="number">0x15</span>, <span class="number">0xbc</span>, <span class="number">0x63</span>, <span class="number">0xa</span>, <span class="number">0xb1</span>, <span class="number">0x58</span>, <span class="number">0xff</span>, <span class="number">0xa6</span>, <span class="number">0x4d</span>, <span class="number">0xf4</span>, <span class="number">0x9b</span>, <span class="number">0x42</span>, <span class="number">0xe9</span>, <span class="number">0x90</span>, <span class="number">0x37</span>, <span class="number">0xde</span>, <span class="number">0x85</span>, <span class="number">0x2c</span>, <span class="number">0xd3</span>, <span class="number">0x7a</span>, <span class="number">0x21</span>, <span class="number">0xc8</span>, <span class="number">0x6f</span>, <span class="number">0x16</span>, <span class="number">0xbd</span>, <span class="number">0x64</span>, <span class="number">0xb</span>, <span class="number">0xb2</span>, <span class="number">0x59</span>, <span class="number">0x0</span>, <span class="number">0xa7</span>, <span class="number">0x4e</span>, <span class="number">0xf5</span>, <span class="number">0x9c</span>, <span class="number">0x43</span>, <span class="number">0xea</span>, <span class="number">0x91</span>, <span class="number">0x38</span>, <span class="number">0xdf</span>, <span class="number">0x86</span>, <span class="number">0x2d</span>, <span class="number">0xd4</span>, <span class="number">0x7b</span>, <span class="number">0x22</span>, <span class="number">0xc9</span>, <span class="number">0x70</span>, <span class="number">0x17</span>, <span class="number">0xbe</span>, <span class="number">0x65</span>, <span class="number">0xc</span>, <span class="number">0xb3</span>, <span class="number">0x5a</span>, <span class="number">0x1</span>, <span class="number">0xa8</span>, <span class="number">0x4f</span>, <span class="number">0xf6</span>, <span class="number">0x9d</span>, <span class="number">0x44</span>, <span class="number">0xeb</span>, <span class="number">0x92</span>, <span class="number">0x39</span>, <span class="number">0xe0</span>, <span class="number">0x87</span>, <span class="number">0x2e</span>, <span class="number">0xd5</span>, <span class="number">0x7c</span>, <span class="number">0x23</span>, <span class="number">0xca</span>, <span class="number">0x71</span>, <span class="number">0x18</span>, <span class="number">0xbf</span>, <span class="number">0x66</span>, <span class="number">0xd</span>, <span class="number">0xb4</span>, <span class="number">0x5b</span>, <span class="number">0x2</span>, <span class="number">0xa9</span>, <span class="number">0x50</span>, <span class="number">0xf7</span>, <span class="number">0x9e</span>, <span class="number">0x45</span>, <span class="number">0xec</span>, <span class="number">0x93</span>, <span class="number">0x3a</span>, <span class="number">0xe1</span>, <span class="number">0x88</span>, <span class="number">0x2f</span>, <span class="number">0xd6</span>, <span class="number">0x7d</span>, <span class="number">0x24</span>, <span class="number">0xcb</span>, <span class="number">0x72</span>, <span class="number">0x19</span>, <span class="number">0xc0</span>, <span class="number">0x67</span>, <span class="number">0xe</span>, <span class="number">0xb5</span>, <span class="number">0x5c</span>, <span class="number">0x3</span>, <span class="number">0xaa</span>, <span class="number">0x51</span>, <span class="number">0xf8</span>, <span class="number">0x9f</span>, <span class="number">0x46</span>, <span class="number">0xed</span>, <span class="number">0x94</span>, <span class="number">0x3b</span>, <span class="number">0xe2</span>, <span class="number">0x89</span>, <span class="number">0x30</span>, <span class="number">0xd7</span>, <span class="number">0x7e</span>, <span class="number">0x25</span>, <span class="number">0xcc</span>, <span class="number">0x73</span>, <span class="number">0x1a</span>, <span class="number">0xc1</span>, <span class="number">0x68</span>, <span class="number">0xf</span>, <span class="number">0xb6</span>, <span class="number">0x5d</span>, <span class="number">0x4</span>, <span class="number">0xab</span>, <span class="number">0x52</span>, <span class="number">0xf9</span>, <span class="number">0xa0</span>, <span class="number">0x47</span>, <span class="number">0xee</span>, <span class="number">0x95</span>, <span class="number">0x3c</span>, <span class="number">0xe3</span>, <span class="number">0x8a</span>, <span class="number">0x31</span>, <span class="number">0xd8</span>, <span class="number">0x7f</span>, <span class="number">0x26</span>, <span class="number">0xcd</span>, <span class="number">0x74</span>, <span class="number">0x1b</span>, <span class="number">0xc2</span>, <span class="number">0x69</span>, <span class="number">0x10</span>, <span class="number">0xb7</span>, <span class="number">0x5e</span>, <span class="number">0x5</span>, <span class="number">0xac</span>, <span class="number">0x53</span>, <span class="number">0xfa</span>, <span class="number">0xa1</span>, <span class="number">0x48</span>, <span class="number">0xef</span>, <span class="number">0x96</span>, <span class="number">0x3d</span>, <span class="number">0xe4</span>, <span class="number">0x8b</span>, <span class="number">0x32</span>, <span class="number">0xd9</span>, <span class="number">0x80</span>, <span class="number">0x27</span>, <span class="number">0xce</span>, <span class="number">0x75</span>, <span class="number">0x1c</span>, <span class="number">0xc3</span>, <span class="number">0x6a</span>, <span class="number">0x11</span>, <span class="number">0xb8</span>, <span class="number">0x5f</span>, <span class="number">0x6</span>, <span class="number">0xad</span>, <span class="number">0x54</span>, <span class="number">0xfb</span>, <span class="number">0xa2</span>, <span class="number">0x49</span>, <span class="number">0xf0</span>, <span class="number">0x97</span>, <span class="number">0x3e</span>, <span class="number">0xe5</span>, <span class="number">0x8c</span>, <span class="number">0x33</span>, <span class="number">0xda</span>, <span class="number">0x81</span>, <span class="number">0x28</span>, <span class="number">0xcf</span>, <span class="number">0x76</span>, <span class="number">0x1d</span>, <span class="number">0xc4</span>, <span class="number">0x6b</span>, <span class="number">0x12</span>, <span class="number">0xb9</span>, <span class="number">0x60</span>, <span class="number">0x7</span>, <span class="number">0xae</span>, <span class="number">0x55</span>, <span class="number">0xfc</span>, <span class="number">0xa3</span>, <span class="number">0x4a</span>, <span class="number">0xf1</span>, <span class="number">0x98</span>, <span class="number">0x3f</span>, <span class="number">0xe6</span>, <span class="number">0x8d</span>, <span class="number">0x34</span>, <span class="number">0xdb</span>, <span class="number">0x82</span>, <span class="number">0x29</span>, <span class="number">0xd0</span>, <span class="number">0x77</span>, <span class="number">0x1e</span>, <span class="number">0xc5</span>, <span class="number">0x6c</span>, <span class="number">0x13</span>, <span class="number">0xba</span>, <span class="number">0x61</span>, <span class="number">0x8</span>, <span class="number">0xaf</span>, <span class="number">0x56</span>, <span class="number">0xfd</span>, <span class="number">0xa4</span>, <span class="number">0x4b</span>, <span class="number">0xf2</span>, <span class="number">0x99</span>, <span class="number">0x40</span>, <span class="number">0xe7</span>, <span class="number">0x8e</span>, <span class="number">0x35</span>, <span class="number">0xdc</span>, <span class="number">0x83</span>, <span class="number">0x2a</span>, <span class="number">0xd1</span>, <span class="number">0x78</span>, <span class="number">0x1f</span>, <span class="number">0xc6</span>, <span class="number">0x6d</span>, <span class="number">0x14</span>, <span class="number">0xbb</span>, <span class="number">0x62</span>, <span class="number">0x9</span>, <span class="number">0xb0</span>, <span class="number">0x57</span>, <span class="number">0xfe</span>, <span class="number">0xa5</span>, <span class="number">0x4c</span>, <span class="number">0xf3</span>, <span class="number">0x9a</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在一行上进位移</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">rotWord</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> temp[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i, k = temp[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">        temp[i - <span class="number">1</span>] = temp[i];</span><br><span class="line">    temp[<span class="number">3</span>] = k;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在一行上进行s盒替换</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">subWord</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> temp[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">        temp[i] = SBOX[temp[i]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 密钥扩展，最终得到Nr+1个轮密钥，用于轮次加密</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">keyExpansion</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i, j;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> temp[<span class="number">5</span>];</span><br><span class="line">    <span class="built_in">memset</span>(RoundKey, <span class="number">0</span>, <span class="keyword">sizeof</span>(RoundKey));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; Nk; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            RoundKey[i * <span class="number">4</span> + j] = Key[i * <span class="number">4</span> + j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (i &lt; (Nb * (Nr + <span class="number">1</span>)))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            temp[j] = RoundKey[(i - <span class="number">1</span>) * <span class="number">4</span> + j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (i % Nk == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            rotWord(temp);</span><br><span class="line">            subWord(temp);</span><br><span class="line">            temp[<span class="number">0</span>] ^= Rcon[i / Nk];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">            RoundKey[i * <span class="number">4</span> + j] = RoundKey[(i - Nk) * <span class="number">4</span> + j] ^ temp[j];</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 轮密钥加函数，将明文加密状态与轮密钥简单异或</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">addRoundKey</span><span class="params">(<span class="type">int</span> round)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i, j;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            state[i][j] ^= RoundKey[round * Nb * <span class="number">4</span> + i * Nb + j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// s盒替换函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">subBytes</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i, j;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            state[i][j] = SBOX[state[i][j]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 逆s盒替换函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">invSubBytes</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i, j;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            state[i][j] = R_SBOX[state[i][j]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 行位移函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">shiftRows</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i, j, k;</span><br><span class="line">    <span class="type">int</span> shiftnum = <span class="number">1</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> tmp;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; shiftnum; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            tmp = state[<span class="number">0</span>][j];</span><br><span class="line">            <span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">3</span>; k++)</span><br><span class="line">                state[k][j] = state[k + <span class="number">1</span>][j];</span><br><span class="line">            state[<span class="number">3</span>][j] = tmp;</span><br><span class="line">        &#125;</span><br><span class="line">        shiftnum++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 逆行位移函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">invShiftRows</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i, j, k;</span><br><span class="line">    <span class="type">int</span> shiftnum = <span class="number">1</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> tmp;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; shiftnum; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            tmp = state[<span class="number">3</span>][j];</span><br><span class="line">            <span class="keyword">for</span> (k = <span class="number">3</span>; k &gt; <span class="number">0</span>; k--)</span><br><span class="line">                state[k][j] = state[k - <span class="number">1</span>][j];</span><br><span class="line">            state[<span class="number">0</span>][j] = tmp;</span><br><span class="line">        &#125;</span><br><span class="line">        shiftnum++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 列混淆函数</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> xtime(x) ((x <span class="string">&lt;&lt; 1) ^ (((x &gt;</span>&gt; 7) &amp; 1) * 0x1b))</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">mixColumns</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i, j;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> tmp, t, p;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        p = state[i][<span class="number">0</span>];</span><br><span class="line">        tmp = state[i][<span class="number">0</span>] ^ state[i][<span class="number">1</span>] ^ state[i][<span class="number">2</span>] ^ state[i][<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            t = state[i][j] ^ state[i][j + <span class="number">1</span>];</span><br><span class="line">            t = xtime(t);</span><br><span class="line">            state[i][j] ^= t ^ tmp;</span><br><span class="line">        &#125;</span><br><span class="line">        t = state[i][<span class="number">3</span>] ^ p;</span><br><span class="line">        t = xtime(t);</span><br><span class="line">        state[i][<span class="number">3</span>] ^= t ^ tmp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 逆列混淆函数</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Multiply(x, y) (((y &amp; 1) * x) ^ ((y &gt;&gt; 1 &amp; 1) * xtime(x)) ^ ((y &gt;&gt; 2 &amp; 1) * xtime(xtime(x))) ^ ((y &gt;&gt; 3 &amp; 1) * xtime(xtime(xtime(x)))) ^ ((y &gt;&gt; 4 &amp; 1) * xtime(xtime(xtime(xtime(x))))))</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">invMixColumns</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> a, b, c, d;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        a = state[i][<span class="number">0</span>];</span><br><span class="line">        b = state[i][<span class="number">1</span>];</span><br><span class="line">        c = state[i][<span class="number">2</span>];</span><br><span class="line">        d = state[i][<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">        state[i][<span class="number">0</span>] = Multiply(a, <span class="number">0x0e</span>) ^ Multiply(b, <span class="number">0x0b</span>) ^ Multiply(c, <span class="number">0x0d</span>) ^ Multiply(d, <span class="number">0x09</span>);</span><br><span class="line">        state[i][<span class="number">1</span>] = Multiply(a, <span class="number">0x09</span>) ^ Multiply(b, <span class="number">0x0e</span>) ^ Multiply(c, <span class="number">0x0b</span>) ^ Multiply(d, <span class="number">0x0d</span>);</span><br><span class="line">        state[i][<span class="number">2</span>] = Multiply(a, <span class="number">0x0d</span>) ^ Multiply(b, <span class="number">0x09</span>) ^ Multiply(c, <span class="number">0x0e</span>) ^ Multiply(d, <span class="number">0x0b</span>);</span><br><span class="line">        state[i][<span class="number">3</span>] = Multiply(a, <span class="number">0x0b</span>) ^ Multiply(b, <span class="number">0x0d</span>) ^ Multiply(c, <span class="number">0x09</span>) ^ Multiply(d, <span class="number">0x0e</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// aes加密函数，key为密钥，input为需要加密的128位明文，output为输出128位密文</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_enc</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *key, <span class="type">unsigned</span> <span class="type">char</span> *input, <span class="type">unsigned</span> <span class="type">char</span> *output)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i, j, round = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(Key, <span class="number">0</span>, <span class="keyword">sizeof</span>(Key));</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; Nk * <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        Key[i] = key[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    keyExpansion();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(state, <span class="number">0</span>, <span class="keyword">sizeof</span>(state));</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">            state[i][j] = input[i * <span class="number">4</span> + j];</span><br><span class="line">    &#125;</span><br><span class="line">    addRoundKey(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (round = <span class="number">1</span>; round &lt; Nr; round++)</span><br><span class="line">    &#123;</span><br><span class="line">        subBytes();</span><br><span class="line">        shiftRows();</span><br><span class="line">        mixColumns();</span><br><span class="line">        addRoundKey(round);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    subBytes();</span><br><span class="line">    shiftRows();</span><br><span class="line">    addRoundKey(Nr);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">            output[i * <span class="number">4</span> + j] = state[i][j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// aes解密函数，key为密钥，input为需要解密的128位密文，output为输出128位明文</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_dec</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *key, <span class="type">unsigned</span> <span class="type">char</span> *input, <span class="type">unsigned</span> <span class="type">char</span> *output)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i, j, round = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(Key, <span class="number">0</span>, <span class="keyword">sizeof</span>(Key));</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; Nk * <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        Key[i] = key[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    keyExpansion();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(state, <span class="number">0</span>, <span class="keyword">sizeof</span>(state));</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">            state[i][j] = input[i * <span class="number">4</span> + j];</span><br><span class="line">    &#125;</span><br><span class="line">    addRoundKey(Nr);</span><br><span class="line">    <span class="keyword">for</span> (round = Nr - <span class="number">1</span>; round &gt; <span class="number">0</span>; round--)</span><br><span class="line">    &#123;</span><br><span class="line">        invSubBytes();</span><br><span class="line">        invShiftRows();</span><br><span class="line">        addRoundKey(round);</span><br><span class="line">        invMixColumns();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    invSubBytes();</span><br><span class="line">    invShiftRows();</span><br><span class="line">    addRoundKey(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">            output[i * <span class="number">4</span> + j] = state[i][j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">gets_t</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *str)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> fin_input;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%66s&quot;</span>, str);</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">        fin_input = getchar();</span><br><span class="line">    <span class="keyword">while</span> (fin_input != <span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;   </span><br><span class="line">    <span class="comment">// Re_1s_eaSy123456</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">17</span>] = &#123;<span class="number">82</span>, <span class="number">101</span>, <span class="number">95</span>, <span class="number">49</span>, <span class="number">115</span>, <span class="number">95</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">83</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">54</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> input[<span class="number">17</span>] = <span class="string">&quot;1111222233334444&quot;</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> enc[<span class="number">17</span>] = &#123;</span><br><span class="line">        <span class="number">43</span>,</span><br><span class="line">        <span class="number">200</span>,</span><br><span class="line">        <span class="number">32</span>,</span><br><span class="line">        <span class="number">139</span>,</span><br><span class="line">        <span class="number">92</span>,</span><br><span class="line">        <span class="number">13</span>,</span><br><span class="line">        <span class="number">167</span>,</span><br><span class="line">        <span class="number">155</span>,</span><br><span class="line">        <span class="number">42</span>,</span><br><span class="line">        <span class="number">81</span>,</span><br><span class="line">        <span class="number">58</span>,</span><br><span class="line">        <span class="number">210</span>,</span><br><span class="line">        <span class="number">113</span>,</span><br><span class="line">        <span class="number">113</span>,</span><br><span class="line">        <span class="number">202</span>,</span><br><span class="line">        <span class="number">80</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> dec[<span class="number">17</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;dec-----\n&quot;</span>);</span><br><span class="line">    aes_dec(key, enc, dec);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, dec[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="BabyAnti-2-0"><a href="#BabyAnti-2-0" class="headerlink" title="BabyAnti-2.0"></a>BabyAnti-2.0</h2><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/hpLSfXtc1pYPtvz3734iLA">2023 WMCTF writeup by W4ntY0u (qq.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://pmxq1w80w6.feishu.cn/docx/RxBpdtPkHopGnLxXVNQcUrl5nhd">WMCTF 2023 wp - LaoGong - 飞书云文档 (feishu.cn)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_68757308/article/details/132794842">WMCTF2023-REVERSE_Blu3e的博客-CSDN博客</a></p>
<h3 id="patch-libanticheat-so"><a href="#patch-libanticheat-so" class="headerlink" title="patch libanticheat.so"></a>patch libanticheat.so</h3><p><img src="/2023/11/21/CTF-wp-1/image-20230919155308483.png" alt="1 patch 为 0"></p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230919155344856.png" alt="1 patch 为 0"></p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230919155427016.png" alt="is_device_rooted -&gt; sub_62FA0: patch 为 0"></p>
<h3 id="方法一-——-patch-libapp-so"><a href="#方法一-——-patch-libapp-so" class="headerlink" title="方法一 —— patch libapp.so"></a>方法一 —— patch libapp.so</h3><p>直接搜索5000（0x1388），将两个cmp改为个位数：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230919155653863.png"></p>
<p>随便玩玩就有flag。</p>
<h3 id="方法二-——-patch-smali代码后用CE"><a href="#方法二-——-patch-smali代码后用CE" class="headerlink" title="方法二 —— patch smali代码后用CE"></a>方法二 —— patch smali代码后用CE</h3><p>由于apk中也有检测是否更改的分的方法，也需要更改：</p>
<blockquote>
<p><code>const/4 p1, 0</code>：这行代码将值 0 存储到参数寄存器 p1 中</p>
</blockquote>
<p><img src="/2023/11/21/CTF-wp-1/image-20230919155830653.png" alt="改为1"></p>
<p>然后CE（进程为Ld9BoxHeadless.exe）搜索，得分改为5000。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230919160009753.png"></p>
<h1 id="羊城杯"><a href="#羊城杯" class="headerlink" title="羊城杯"></a>羊城杯</h1><h2 id="babyobfu"><a href="#babyobfu" class="headerlink" title="babyobfu"></a>babyobfu</h2><h3 id="去混淆"><a href="#去混淆" class="headerlink" title="去混淆"></a>去混淆</h3><p>动调可以看出大概逻辑，主要靠一个函数修复代码段，之后还会还原。</p>
<p>设置条件断点进行patch：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">repair_code</span>(<span class="params">start, l, num</span>):</span><br><span class="line">	s = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">		s.append((num &gt;&gt; (<span class="number">8</span> * i)) &amp; <span class="number">0xFF</span>)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">		data = Byte(start + i)</span><br><span class="line">		PatchByte(start + i, data ^ ((i + <span class="number">0xCE</span>) &amp; <span class="number">0xFF</span>) ^ s[i % <span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rsp = GetRegValue(<span class="string">&quot;rsp&quot;</span>)</span><br><span class="line">retrun_addr = Qword(GetRegValue(<span class="string">&quot;rsp&quot;</span>))</span><br><span class="line"><span class="keyword">if</span> retrun_addr == <span class="number">0x403783</span>:</span><br><span class="line">	retrun_addr = Qword(rsp + <span class="number">0x30</span>)</span><br><span class="line">FunAddr = retrun_addr - <span class="number">0x5</span></span><br><span class="line">CodeAddress = GetRegValue(<span class="string">&quot;rdi&quot;</span>)</span><br><span class="line">Length = GetRegValue(<span class="string">&quot;rsi&quot;</span>)</span><br><span class="line">XorNum = GetRegValue(<span class="string">&quot;edx&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> retrun_addr == CodeAddress:</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">		PatchByte(FunAddr + j, <span class="number">0x90</span>)</span><br><span class="line">	repair_code(CodeAddress, Length, XorNum)</span><br><span class="line">	SetRegValue(<span class="number">0x40375F</span>, <span class="string">&quot;EIP&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">		PatchByte(FunAddr + j, <span class="number">0x90</span>)</span><br><span class="line">	SetRegValue(<span class="number">0x40375F</span>, <span class="string">&quot;EIP&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Repair Date from <span class="subst">&#123;<span class="built_in">hex</span>(FunAddr) = &#125;</span>:<span class="subst">&#123;<span class="built_in">hex</span>(CodeAddress) = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>多输入，执行几次，main函数就可以反编译了。</p>
<p>对于这样子的剩余混淆，分析的时候手动patch一下就好，很好辨认。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230903100528828.png"></p>
<h3 id="逻辑分析"><a href="#逻辑分析" class="headerlink" title="逻辑分析"></a>逻辑分析</h3><p>检测输入长度以及格式为0-9，a-f。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230904151634478.png"></p>
<p>sub_401980是将输入进行更改，后面的循环为更改的输入两个Byte拼接为一个Byte。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230904152227987.png"></p>
<p>sub_401980：其中的数据可以动态获取</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230904152524974.png"></p>
<p>加密过程：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230904152625928.png"></p>
<p>最后比较：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230904152702221.png"></p>
<h3 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span> &lt;= num &lt;= <span class="number">9</span>:</span><br><span class="line">        <span class="keyword">return</span> num + <span class="number">0x30</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="number">10</span> &lt;= num &lt;= <span class="number">15</span>:</span><br><span class="line">        <span class="keyword">return</span> num + <span class="number">97</span> - <span class="number">10</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> a + b &gt;= <span class="number">0x256</span>:</span><br><span class="line">        <span class="keyword">return</span> (a + b - <span class="number">1</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> (a + b) &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line">data = [</span><br><span class="line">    <span class="number">0xd4</span>, <span class="number">0xfd</span>, <span class="number">0x80</span>, <span class="number">0xc4</span>, <span class="number">0x50</span>, <span class="number">0x10</span>, <span class="number">0xde</span>, <span class="number">0x6d</span>, <span class="number">0xe8</span>, <span class="number">0xf0</span>, <span class="number">0xc</span>, <span class="number">0x52</span>, <span class="number">0x9</span>, <span class="number">0x40</span>, <span class="number">0x24</span>, <span class="number">0x97</span>, <span class="number">0xde</span>, <span class="number">0x77</span>, <span class="number">0x14</span>,</span><br><span class="line">    <span class="number">0x5f</span>, <span class="number">0x69</span>, <span class="number">0xf6</span>, <span class="number">0xc0</span>, <span class="number">0x74</span>, <span class="number">0x8e</span>, <span class="number">0x6d</span>, <span class="number">0x80</span>, <span class="number">0xce</span>, <span class="number">0xcc</span>, <span class="number">0x7</span>, <span class="number">0xc0</span>, <span class="number">0xf4</span>, <span class="number">0xa0</span>, <span class="number">0x4</span>, <span class="number">0xf0</span>, <span class="number">0x1c</span>, <span class="number">0xc6</span>, <span class="number">0x0</span>, <span class="number">0xa2</span>,</span><br><span class="line">    <span class="number">0x58</span>, <span class="number">0xf4</span>, <span class="number">0x34</span>, <span class="number">0x40</span>, <span class="number">0xb0</span>, <span class="number">0x4c</span>, <span class="number">0xa0</span>, <span class="number">0xa8</span>, <span class="number">0x56</span>, <span class="number">0x59</span>, <span class="number">0xe9</span>, <span class="number">0x38</span>, <span class="number">0x28</span>, <span class="number">0xd0</span>, <span class="number">0x68</span>, <span class="number">0x40</span>, <span class="number">0x66</span>, <span class="number">0x96</span>, <span class="number">0x45</span>,</span><br><span class="line">    <span class="number">0xd2</span>, <span class="number">0x67</span>, <span class="number">0x40</span>, <span class="number">0xd0</span>, <span class="number">0x24</span>, <span class="number">0x0</span>, <span class="number">0x13</span>, <span class="number">0x4c</span>, <span class="number">0xca</span>, <span class="number">0x78</span>, <span class="number">0x4c</span>, <span class="number">0xbc</span>, <span class="number">0xc0</span>, <span class="number">0x42</span>, <span class="number">0x0</span>, <span class="number">0x10</span>, <span class="number">0x6d</span>, <span class="number">0xc0</span>, <span class="number">0x0</span>, <span class="number">0x38</span>,</span><br><span class="line">    <span class="number">0xb0</span>, <span class="number">0x4</span>, <span class="number">0xc4</span>, <span class="number">0x48</span>, <span class="number">0x80</span>, <span class="number">0xe8</span>, <span class="number">0x71</span>, <span class="number">0xff</span>, <span class="number">0x40</span>, <span class="number">0x84</span>, <span class="number">0x46</span>, <span class="number">0x54</span>, <span class="number">0x25</span>, <span class="number">0x7a</span>, <span class="number">0x38</span>, <span class="number">0x20</span>, <span class="number">0xf8</span>, <span class="number">0xc0</span>, <span class="number">0x38</span>,</span><br><span class="line">    <span class="number">0x94</span>, <span class="number">0xf9</span>, <span class="number">0x70</span>, <span class="number">0xe4</span>, <span class="number">0xfa</span>, <span class="number">0x70</span>, <span class="number">0x8</span>, <span class="number">0x40</span>, <span class="number">0x33</span>, <span class="number">0xe7</span>, <span class="number">0x68</span>, <span class="number">0xb0</span>, <span class="number">0xd6</span>, <span class="number">0x20</span>, <span class="number">0xfb</span>, <span class="number">0x81</span>, <span class="number">0x4c</span>, <span class="number">0x2e</span>, <span class="number">0x8a</span>,</span><br><span class="line">    <span class="number">0x1b</span>, <span class="number">0x3a</span>, <span class="number">0x92</span>, <span class="number">0x78</span>, <span class="number">0xe8</span>, <span class="number">0x24</span>, <span class="number">0x22</span>, <span class="number">0x27</span>, <span class="number">0x5c</span>, <span class="number">0xd2</span>, <span class="number">0x14</span>, <span class="number">0x8a</span>, <span class="number">0xb0</span>, <span class="number">0x60</span>, <span class="number">0x64</span>, <span class="number">0x20</span>, <span class="number">0x10</span>, <span class="number">0xe5</span>, <span class="number">0xd1</span>,</span><br><span class="line">    <span class="number">0x5c</span>, <span class="number">0xe9</span>, <span class="number">0x79</span>, <span class="number">0x52</span>, <span class="number">0x34</span>, <span class="number">0x67</span>, <span class="number">0x80</span>, <span class="number">0x4c</span>, <span class="number">0xe2</span>, <span class="number">0x20</span>, <span class="number">0xa0</span>, <span class="number">0x54</span>, <span class="number">0xdf</span>, <span class="number">0x28</span>, <span class="number">0x30</span>, <span class="number">0xf0</span>, <span class="number">0x86</span>, <span class="number">0xad</span>, <span class="number">0xc5</span>,</span><br><span class="line">    <span class="number">0x85</span>, <span class="number">0x71</span>, <span class="number">0xc0</span>, <span class="number">0x4e</span>, <span class="number">0xba</span>, <span class="number">0xcc</span>, <span class="number">0x98</span>, <span class="number">0x23</span>, <span class="number">0x56</span>, <span class="number">0x12</span>, <span class="number">0x90</span>, <span class="number">0xc9</span>, <span class="number">0x5b</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x48</span>, <span class="number">0xba</span>, <span class="number">0xac</span>, <span class="number">0x2c</span>,</span><br><span class="line">    <span class="number">0xdc</span>, <span class="number">0x22</span>, <span class="number">0x90</span>, <span class="number">0xe8</span>, <span class="number">0x18</span>, <span class="number">0x8c</span>, <span class="number">0x81</span>, <span class="number">0x44</span>, <span class="number">0x31</span>, <span class="number">0x84</span>, <span class="number">0x80</span>, <span class="number">0xe8</span>, <span class="number">0x8a</span>, <span class="number">0xe0</span>, <span class="number">0x8c</span>, <span class="number">0xba</span>, <span class="number">0xfa</span>, <span class="number">0xbc</span>, <span class="number">0xe6</span>,</span><br><span class="line">    <span class="number">0xf0</span>, <span class="number">0x9e</span>, <span class="number">0x66</span>, <span class="number">0xda</span>, <span class="number">0x54</span>, <span class="number">0xa1</span>, <span class="number">0xc8</span>, <span class="number">0x1e</span>, <span class="number">0x90</span>, <span class="number">0xf0</span>, <span class="number">0x93</span>, <span class="number">0x39</span>, <span class="number">0x50</span>, <span class="number">0x18</span>, <span class="number">0x99</span>, <span class="number">0x95</span>, <span class="number">0x48</span>, <span class="number">0x81</span>, <span class="number">0xa0</span>,</span><br><span class="line">    <span class="number">0x4a</span>, <span class="number">0xb0</span>, <span class="number">0x6a</span>, <span class="number">0x80</span>, <span class="number">0x7b</span>, <span class="number">0xb0</span>, <span class="number">0xc8</span>, <span class="number">0x9d</span>, <span class="number">0x39</span>, <span class="number">0xfb</span>, <span class="number">0x7e</span>, <span class="number">0x74</span>, <span class="number">0x40</span>, <span class="number">0x80</span>, <span class="number">0x2a</span>, <span class="number">0x90</span>, <span class="number">0x60</span>, <span class="number">0x4a</span>, <span class="number">0xe2</span>,</span><br><span class="line">    <span class="number">0xda</span>, <span class="number">0x0</span>, <span class="number">0xe</span>, <span class="number">0xc0</span>, <span class="number">0xe0</span>, <span class="number">0xbe</span>, <span class="number">0x6</span>, <span class="number">0xc5</span>, <span class="number">0x61</span>, <span class="number">0xd4</span>, <span class="number">0x9c</span>, <span class="number">0x33</span>, <span class="number">0x88</span>, <span class="number">0x40</span>, <span class="number">0x70</span>, <span class="number">0x78</span>, <span class="number">0xf2</span>, <span class="number">0x7c</span>, <span class="number">0xac</span>, <span class="number">0xb0</span>,</span><br><span class="line">    <span class="number">0xf8</span>, <span class="number">0xcb</span>, <span class="number">0xcc</span>, <span class="number">0x3e</span>, <span class="number">0xea</span>, <span class="number">0x64</span>, <span class="number">0xa0</span>, <span class="number">0xbe</span>, <span class="number">0xac</span>, <span class="number">0xa</span>, <span class="number">0xd4</span>, <span class="number">0x30</span>, <span class="number">0x58</span>, <span class="number">0x4d</span>, <span class="number">0x74</span>, <span class="number">0x48</span>, <span class="number">0x90</span>, <span class="number">0x18</span>, <span class="number">0xea</span>,</span><br><span class="line">    <span class="number">0x10</span>, <span class="number">0xc0</span>, <span class="number">0x0</span>, <span class="number">0x5</span>, <span class="number">0xa0</span>, <span class="number">0x4e</span>, <span class="number">0xdd</span>, <span class="number">0xec</span>, <span class="number">0xa8</span>, <span class="number">0x10</span>, <span class="number">0xe0</span>, <span class="number">0x20</span>, <span class="number">0x42</span>, <span class="number">0x9</span>, <span class="number">0x64</span>, <span class="number">0x40</span>, <span class="number">0x94</span>, <span class="number">0x93</span>, <span class="number">0x90</span>, <span class="number">0x61</span>,</span><br><span class="line">    <span class="number">0x2</span>, <span class="number">0x3a</span>, <span class="number">0x39</span>, <span class="number">0xdf</span>, <span class="number">0x9a</span>, <span class="number">0x3c</span>, <span class="number">0x29</span>, <span class="number">0x6f</span>, <span class="number">0xe7</span>, <span class="number">0x10</span>, <span class="number">0xb3</span>, <span class="number">0x4b</span>, <span class="number">0xd3</span>, <span class="number">0x9d</span>, <span class="number">0xb2</span>, <span class="number">0x5b</span>, <span class="number">0x7</span>, <span class="number">0x84</span>, <span class="number">0xf0</span>,</span><br><span class="line">    <span class="number">0x3b</span>, <span class="number">0xbe</span>, <span class="number">0xce</span>, <span class="number">0xb6</span>, <span class="number">0xbc</span>, <span class="number">0xa</span>, <span class="number">0x48</span>, <span class="number">0xb8</span>, <span class="number">0x63</span>, <span class="number">0x48</span>, <span class="number">0xfa</span>, <span class="number">0x68</span>, <span class="number">0x74</span>, <span class="number">0xe4</span>, <span class="number">0xf8</span>, <span class="number">0xac</span>, <span class="number">0x16</span>, <span class="number">0x97</span>, <span class="number">0x8e</span>,</span><br><span class="line">    <span class="number">0x2a</span>, <span class="number">0xe9</span>, <span class="number">0x4c</span>, <span class="number">0x2c</span>, <span class="number">0xeb</span>, <span class="number">0x68</span>, <span class="number">0x82</span>, <span class="number">0xb8</span>, <span class="number">0x24</span>, <span class="number">0x92</span>, <span class="number">0x6</span>, <span class="number">0xb9</span>, <span class="number">0xa2</span>, <span class="number">0xf0</span>, <span class="number">0x90</span>, <span class="number">0xea</span>, <span class="number">0xaa</span>, <span class="number">0xe4</span>, <span class="number">0xa</span>,</span><br><span class="line">    <span class="number">0x7b</span>, <span class="number">0x40</span>, <span class="number">0x5c</span>, <span class="number">0xfc</span>, <span class="number">0xbe</span>, <span class="number">0x54</span>, <span class="number">0x90</span>, <span class="number">0x81</span>, <span class="number">0x44</span>, <span class="number">0xf4</span>, <span class="number">0x37</span>, <span class="number">0xa0</span>, <span class="number">0x93</span>, <span class="number">0x65</span>, <span class="number">0x20</span>, <span class="number">0x16</span>, <span class="number">0x82</span>, <span class="number">0xcd</span>, <span class="number">0xae</span>,</span><br><span class="line">    <span class="number">0x24</span>, <span class="number">0x0</span>, <span class="number">0x29</span>, <span class="number">0xa0</span>, <span class="number">0x8b</span>, <span class="number">0x44</span>, <span class="number">0xfb</span>, <span class="number">0xe4</span>, <span class="number">0x58</span>, <span class="number">0xd5</span>, <span class="number">0xc0</span>, <span class="number">0x9c</span>, <span class="number">0x84</span>, <span class="number">0xd</span>, <span class="number">0x8d</span>, <span class="number">0xcf</span>, <span class="number">0x50</span>, <span class="number">0x28</span>, <span class="number">0x8</span>, <span class="number">0x8c</span>,</span><br><span class="line">    <span class="number">0xbe</span>, <span class="number">0x6c</span>, <span class="number">0xbc</span>, <span class="number">0x18</span>, <span class="number">0x8</span>, <span class="number">0x9</span>, <span class="number">0x59</span>, <span class="number">0xad</span>, <span class="number">0xcc</span>, <span class="number">0xf8</span>, <span class="number">0x1c</span>, <span class="number">0x78</span>, <span class="number">0x28</span>, <span class="number">0xbd</span>, <span class="number">0x5a</span>, <span class="number">0x31</span>, <span class="number">0xde</span>, <span class="number">0x0</span>, <span class="number">0x6c</span>, <span class="number">0x61</span>,</span><br><span class="line">    <span class="number">0x8b</span>, <span class="number">0x23</span>, <span class="number">0xb0</span>, <span class="number">0x85</span>, <span class="number">0x8d</span>, <span class="number">0x14</span>, <span class="number">0x3f</span>, <span class="number">0x98</span>, <span class="number">0x68</span>, <span class="number">0x3</span>, <span class="number">0xac</span>, <span class="number">0xc0</span>, <span class="number">0x73</span>, <span class="number">0x96</span>, <span class="number">0x20</span>, <span class="number">0x3a</span>, <span class="number">0xc2</span>, <span class="number">0x6c</span>, <span class="number">0x40</span>,</span><br><span class="line">    <span class="number">0x31</span>, <span class="number">0x70</span>, <span class="number">0x98</span>, <span class="number">0x2e</span>, <span class="number">0x90</span>, <span class="number">0x16</span>, <span class="number">0xba</span>, <span class="number">0xfe</span>, <span class="number">0xc3</span>, <span class="number">0x81</span>, <span class="number">0x98</span>, <span class="number">0x77</span>, <span class="number">0xc4</span>, <span class="number">0xbb</span>, <span class="number">0x73</span>, <span class="number">0xf8</span>, <span class="number">0x3a</span>, <span class="number">0x11</span>, <span class="number">0x70</span>,</span><br><span class="line">    <span class="number">0x11</span>, <span class="number">0x7c</span>, <span class="number">0x1d</span>, <span class="number">0x98</span>, <span class="number">0x84</span>, <span class="number">0xc</span>, <span class="number">0x1f</span>, <span class="number">0x5a</span>, <span class="number">0x4d</span>, <span class="number">0xb3</span>, <span class="number">0xc0</span>, <span class="number">0x31</span>, <span class="number">0xb0</span>, <span class="number">0x21</span>, <span class="number">0x4c</span>, <span class="number">0x9c</span>, <span class="number">0x20</span>, <span class="number">0xe6</span>, <span class="number">0x6c</span>,</span><br><span class="line">    <span class="number">0x89</span>, <span class="number">0xc0</span>, <span class="number">0x79</span>, <span class="number">0xbf</span>, <span class="number">0x35</span>, <span class="number">0xa8</span>, <span class="number">0x66</span>, <span class="number">0x89</span>, <span class="number">0xc8</span>, <span class="number">0x22</span>, <span class="number">0x76</span>, <span class="number">0xc0</span>, <span class="number">0x8a</span>, <span class="number">0xc1</span>, <span class="number">0x70</span>, <span class="number">0xd8</span>, <span class="number">0x2d</span>, <span class="number">0xd9</span>, <span class="number">0xb6</span>,</span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0x38</span>, <span class="number">0x8c</span>, <span class="number">0x80</span>, <span class="number">0xd0</span>, <span class="number">0x2e</span>, <span class="number">0x23</span>, <span class="number">0x40</span>, <span class="number">0xab</span>, <span class="number">0x7b</span>, <span class="number">0xc7</span>, <span class="number">0xdd</span>, <span class="number">0x34</span>, <span class="number">0x4b</span>, <span class="number">0xf4</span>, <span class="number">0xc0</span>, <span class="number">0x3f</span>, <span class="number">0xb2</span>, <span class="number">0xcd</span>,</span><br><span class="line">    <span class="number">0x61</span>, <span class="number">0x91</span>, <span class="number">0x30</span>, <span class="number">0xd8</span>, <span class="number">0xbc</span>, <span class="number">0xe4</span>, <span class="number">0xcb</span>, <span class="number">0x48</span>, <span class="number">0xa5</span>, <span class="number">0xcc</span>, <span class="number">0x82</span>, <span class="number">0xb2</span>, <span class="number">0x18</span>, <span class="number">0xf3</span>, <span class="number">0x1e</span>, <span class="number">0x96</span>, <span class="number">0x71</span>, <span class="number">0x59</span>, <span class="number">0x1e</span>,</span><br><span class="line">    <span class="number">0x9c</span>, <span class="number">0x68</span>, <span class="number">0x3b</span>, <span class="number">0xe8</span>, <span class="number">0x41</span>, <span class="number">0xa8</span>, <span class="number">0x8</span>, <span class="number">0x75</span>, <span class="number">0xd0</span>, <span class="number">0x84</span>, <span class="number">0xf8</span>, <span class="number">0xd6</span>, <span class="number">0xc</span>, <span class="number">0xdd</span>, <span class="number">0x40</span>, <span class="number">0x6b</span>, <span class="number">0x33</span>, <span class="number">0xa4</span>, <span class="number">0x7c</span>,</span><br><span class="line">    <span class="number">0x20</span>, <span class="number">0x96</span>, <span class="number">0x4f</span>, <span class="number">0x2f</span>, <span class="number">0xb8</span>, <span class="number">0x12</span>, <span class="number">0xc8</span>, <span class="number">0x16</span>, <span class="number">0x40</span>, <span class="number">0xe8</span>, <span class="number">0xa0</span>, <span class="number">0x2d</span>, <span class="number">0x70</span>, <span class="number">0x10</span>, <span class="number">0xbd</span>, <span class="number">0x60</span>, <span class="number">0x4c</span>, <span class="number">0xdc</span>, <span class="number">0x39</span>,</span><br><span class="line">    <span class="number">0xab</span>, <span class="number">0x59</span>, <span class="number">0x61</span>, <span class="number">0x71</span>, <span class="number">0xd0</span>, <span class="number">0xc0</span>, <span class="number">0xeb</span>, <span class="number">0xf0</span>, <span class="number">0xfe</span>, <span class="number">0xaa</span>, <span class="number">0xd4</span>, <span class="number">0x5c</span>, <span class="number">0xfc</span>, <span class="number">0x93</span>, <span class="number">0xf8</span>, <span class="number">0xf9</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x40</span>,</span><br><span class="line">    <span class="number">0x18</span>, <span class="number">0xe6</span>, <span class="number">0x86</span>, <span class="number">0x7e</span>, <span class="number">0x3</span>, <span class="number">0x50</span>, <span class="number">0x17</span>, <span class="number">0xb8</span>, <span class="number">0xab</span>, <span class="number">0x10</span>, <span class="number">0x82</span>, <span class="number">0x42</span>, <span class="number">0x9</span>, <span class="number">0x44</span>, <span class="number">0xe0</span>, <span class="number">0x96</span>, <span class="number">0xca</span>, <span class="number">0xd4</span>, <span class="number">0xa</span>, <span class="number">0x46</span>,</span><br><span class="line">    <span class="number">0x9c</span>, <span class="number">0x6b</span>, <span class="number">0xd2</span>, <span class="number">0x92</span>, <span class="number">0xcd</span>, <span class="number">0x90</span>, <span class="number">0x40</span>, <span class="number">0x2e</span>, <span class="number">0x6b</span>, <span class="number">0x10</span>, <span class="number">0x53</span>, <span class="number">0x60</span>, <span class="number">0xa7</span>, <span class="number">0x97</span>, <span class="number">0x63</span>, <span class="number">0xda</span>, <span class="number">0x82</span>, <span class="number">0x29</span>, <span class="number">0xc6</span>,</span><br><span class="line">    <span class="number">0x0</span>, <span class="number">0x70</span>, <span class="number">0xac</span>, <span class="number">0xbc</span>, <span class="number">0x4a</span>, <span class="number">0x40</span>, <span class="number">0x4</span>, <span class="number">0xe0</span>, <span class="number">0x74</span>, <span class="number">0xb0</span>, <span class="number">0xb0</span>, <span class="number">0x80</span>, <span class="number">0x30</span>, <span class="number">0xdc</span>, <span class="number">0x70</span>, <span class="number">0x6c</span>, <span class="number">0x40</span>, <span class="number">0x7e</span>, <span class="number">0xd0</span>,</span><br><span class="line">    <span class="number">0x90</span>, <span class="number">0x9d</span>, <span class="number">0x2d</span>, <span class="number">0x87</span>, <span class="number">0xb8</span>, <span class="number">0xc5</span>, <span class="number">0x64</span>, <span class="number">0xd</span>, <span class="number">0xdc</span>, <span class="number">0x5e</span>, <span class="number">0x60</span>, <span class="number">0xd7</span>, <span class="number">0xc</span>, <span class="number">0xdb</span>, <span class="number">0x0</span>, <span class="number">0x80</span>, <span class="number">0x21</span>, <span class="number">0x17</span>, <span class="number">0xdd</span>, <span class="number">0xb8</span>,</span><br><span class="line">    <span class="number">0x20</span>, <span class="number">0xfd</span>, <span class="number">0x8f</span>, <span class="number">0x0</span>, <span class="number">0xb8</span>, <span class="number">0x18</span>, <span class="number">0x1c</span>, <span class="number">0x4</span>, <span class="number">0xff</span>, <span class="number">0xb1</span>, <span class="number">0x68</span>, <span class="number">0xc4</span>, <span class="number">0xe9</span>, <span class="number">0xab</span>, <span class="number">0x84</span>, <span class="number">0x6b</span>, <span class="number">0x82</span>, <span class="number">0x80</span>, <span class="number">0x14</span>,</span><br><span class="line">    <span class="number">0x44</span>, <span class="number">0xc8</span>, <span class="number">0x6a</span>, <span class="number">0x21</span>, <span class="number">0xfa</span>, <span class="number">0x34</span>, <span class="number">0xa6</span>, <span class="number">0xf9</span>, <span class="number">0x5b</span>, <span class="number">0xd8</span>, <span class="number">0x5e</span>, <span class="number">0xf0</span>, <span class="number">0xd3</span>, <span class="number">0xef</span>, <span class="number">0x92</span>, <span class="number">0xf6</span>, <span class="number">0xf3</span>, <span class="number">0xc6</span>, <span class="number">0x7e</span>,</span><br><span class="line">    <span class="number">0xe3</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>, <span class="number">0xe5</span>, <span class="number">0xf6</span>, <span class="number">0xbf</span>, <span class="number">0x90</span>, <span class="number">0xbe</span>, <span class="number">0xe4</span>, <span class="number">0x30</span>, <span class="number">0xa8</span>, <span class="number">0x3b</span>, <span class="number">0x8c</span>, <span class="number">0xc8</span>, <span class="number">0xec</span>, <span class="number">0x36</span>, <span class="number">0xec</span>, <span class="number">0x0</span>, <span class="number">0xb0</span>,</span><br><span class="line">    <span class="number">0x4</span>, <span class="number">0xf8</span>, <span class="number">0xb8</span>, <span class="number">0x4f</span>, <span class="number">0x40</span>, <span class="number">0xc2</span>, <span class="number">0xf8</span>, <span class="number">0x7c</span>, <span class="number">0xd1</span>, <span class="number">0x7b</span>, <span class="number">0x30</span>, <span class="number">0xb4</span>, <span class="number">0x88</span>, <span class="number">0x6b</span>, <span class="number">0xa0</span>, <span class="number">0x0</span>, <span class="number">0x70</span>, <span class="number">0x59</span>, <span class="number">0x14</span>,</span><br><span class="line">    <span class="number">0x85</span>, <span class="number">0xd7</span>, <span class="number">0x8c</span>, <span class="number">0x44</span>, <span class="number">0x29</span>, <span class="number">0xa3</span>, <span class="number">0xe9</span>, <span class="number">0xc0</span>, <span class="number">0x2f</span>, <span class="number">0xa6</span>, <span class="number">0xe4</span>, <span class="number">0xe6</span>, <span class="number">0xfb</span>, <span class="number">0xb9</span>, <span class="number">0xbc</span>, <span class="number">0xb4</span>, <span class="number">0x36</span>, <span class="number">0xd4</span>, <span class="number">0x9c</span>,</span><br><span class="line">    <span class="number">0xd0</span>, <span class="number">0x28</span>, <span class="number">0x64</span>, <span class="number">0x4</span>, <span class="number">0x84</span>, <span class="number">0x10</span>, <span class="number">0x35</span>, <span class="number">0x60</span>, <span class="number">0xc8</span>, <span class="number">0x1a</span>, <span class="number">0xc0</span>, <span class="number">0xed</span>, <span class="number">0x13</span>, <span class="number">0x5f</span>, <span class="number">0x9a</span>, <span class="number">0xf0</span>, <span class="number">0xea</span>, <span class="number">0x60</span>, <span class="number">0xdb</span>,</span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0x4b</span>, <span class="number">0xef</span>, <span class="number">0xce</span>, <span class="number">0x9f</span>, <span class="number">0x70</span>, <span class="number">0xff</span>, <span class="number">0x0</span>, <span class="number">0x23</span>, <span class="number">0x9d</span>, <span class="number">0x8a</span>, <span class="number">0xa4</span>, <span class="number">0xb0</span>, <span class="number">0xd0</span>, <span class="number">0x62</span>, <span class="number">0x68</span>, <span class="number">0x2f</span>, <span class="number">0x80</span>, <span class="number">0x75</span>,</span><br><span class="line">    <span class="number">0x74</span>, <span class="number">0xd</span>, <span class="number">0xde</span>, <span class="number">0x0</span>, <span class="number">0x60</span>, <span class="number">0x31</span>, <span class="number">0x40</span>, <span class="number">0xc3</span>, <span class="number">0x90</span>, <span class="number">0x94</span>, <span class="number">0x86</span>, <span class="number">0x31</span>, <span class="number">0xff</span>, <span class="number">0x22</span>, <span class="number">0x78</span>, <span class="number">0x34</span>, <span class="number">0x20</span>, <span class="number">0x89</span>, <span class="number">0x37</span>,</span><br><span class="line">    <span class="number">0x31</span>, <span class="number">0x83</span>, <span class="number">0x2e</span>, <span class="number">0xb1</span>, <span class="number">0x71</span>, <span class="number">0x40</span>, <span class="number">0x9</span>, <span class="number">0xc0</span>, <span class="number">0xc4</span>, <span class="number">0x4e</span>, <span class="number">0xe2</span>, <span class="number">0x52</span>, <span class="number">0x5e</span>, <span class="number">0x90</span>, <span class="number">0xa0</span>, <span class="number">0x26</span>, <span class="number">0x57</span>, <span class="number">0x47</span>, <span class="number">0x4e</span>,</span><br><span class="line">    <span class="number">0x90</span>, <span class="number">0x54</span>, <span class="number">0xbc</span>, <span class="number">0x52</span>, <span class="number">0x43</span>, <span class="number">0xca</span>, <span class="number">0xd1</span>, <span class="number">0x90</span>, <span class="number">0x20</span>, <span class="number">0x24</span>, <span class="number">0x19</span>, <span class="number">0x8c</span>, <span class="number">0x5e</span>, <span class="number">0x94</span>, <span class="number">0xa8</span>, <span class="number">0xc</span>, <span class="number">0xa8</span>, <span class="number">0xc4</span>, <span class="number">0xdd</span>,</span><br><span class="line">    <span class="number">0x91</span>, <span class="number">0x47</span>, <span class="number">0x80</span>, <span class="number">0x60</span>, <span class="number">0x38</span>, <span class="number">0x40</span>, <span class="number">0xb8</span>, <span class="number">0x65</span>, <span class="number">0x70</span>, <span class="number">0x20</span>, <span class="number">0x91</span>, <span class="number">0x48</span>, <span class="number">0x47</span>, <span class="number">0x0</span>, <span class="number">0x6c</span>, <span class="number">0x70</span>, <span class="number">0xa6</span>, <span class="number">0xfe</span>, <span class="number">0x24</span>,</span><br><span class="line">    <span class="number">0x44</span>, <span class="number">0x0</span>, <span class="number">0x84</span>, <span class="number">0xbc</span>, <span class="number">0xd6</span>, <span class="number">0x7d</span>, <span class="number">0x3c</span>, <span class="number">0xc8</span>, <span class="number">0x71</span>, <span class="number">0x2e</span>, <span class="number">0x1c</span>, <span class="number">0x95</span>, <span class="number">0x93</span>, <span class="number">0x30</span>, <span class="number">0xa9</span>, <span class="number">0x8a</span>, <span class="number">0xef</span>, <span class="number">0x65</span>, <span class="number">0xb8</span>,</span><br><span class="line">    <span class="number">0x49</span>, <span class="number">0xc0</span>, <span class="number">0x20</span>, <span class="number">0x33</span>, <span class="number">0x68</span>, <span class="number">0x70</span>, <span class="number">0x68</span>, <span class="number">0x10</span>, <span class="number">0xb0</span>, <span class="number">0x6e</span>, <span class="number">0xea</span>, <span class="number">0x8</span>, <span class="number">0xdb</span>, <span class="number">0x62</span>, <span class="number">0xc0</span>, <span class="number">0x8b</span>, <span class="number">0x66</span>, <span class="number">0x3e</span>, <span class="number">0x50</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x79</span>, <span class="number">0x18</span>, <span class="number">0xd4</span>, <span class="number">0x69</span>, <span class="number">0x96</span>, <span class="number">0x1c</span>, <span class="number">0x3f</span>, <span class="number">0x1a</span>, <span class="number">0x50</span>, <span class="number">0x6c</span>, <span class="number">0x57</span>, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0xd8</span>, <span class="number">0x7c</span>, <span class="number">0x61</span>, <span class="number">0x7f</span>, <span class="number">0xa4</span>, <span class="number">0x4</span>,</span><br><span class="line">    <span class="number">0x7</span>, <span class="number">0x74</span>, <span class="number">0x50</span>, <span class="number">0x77</span>, <span class="number">0x29</span>, <span class="number">0xa0</span>, <span class="number">0x8c</span>, <span class="number">0xe0</span>, <span class="number">0x5c</span>, <span class="number">0x4</span>, <span class="number">0xf8</span>, <span class="number">0xe0</span>, <span class="number">0xc3</span>, <span class="number">0xde</span>, <span class="number">0x2c</span>, <span class="number">0xd2</span>, <span class="number">0x9e</span>, <span class="number">0xf1</span>, <span class="number">0x40</span>,</span><br><span class="line">    <span class="number">0x5c</span>, <span class="number">0x50</span>, <span class="number">0xdc</span>, <span class="number">0x2d</span>, <span class="number">0x0</span>, <span class="number">0xc1</span>, <span class="number">0xd0</span>, <span class="number">0xd0</span>, <span class="number">0x7</span>, <span class="number">0x14</span>, <span class="number">0x6c</span>, <span class="number">0xfd</span>, <span class="number">0x9e</span>, <span class="number">0x6e</span>, <span class="number">0xc9</span>, <span class="number">0x5e</span>, <span class="number">0x30</span>, <span class="number">0xa8</span>, <span class="number">0x3a</span>,</span><br><span class="line">    <span class="number">0x21</span>, <span class="number">0xa8</span>, <span class="number">0x95</span>, <span class="number">0x58</span>, <span class="number">0x87</span>, <span class="number">0x40</span>, <span class="number">0x75</span>, <span class="number">0x6c</span>, <span class="number">0xc</span>, <span class="number">0x68</span>, <span class="number">0xd8</span>, <span class="number">0x9e</span>, <span class="number">0xe6</span>, <span class="number">0xc2</span>, <span class="number">0x70</span>, <span class="number">0x79</span>, <span class="number">0x0</span>, <span class="number">0x67</span>, <span class="number">0x29</span>,</span><br><span class="line">    <span class="number">0xfc</span>, <span class="number">0x1</span>, <span class="number">0xf2</span>, <span class="number">0x16</span>, <span class="number">0xec</span>, <span class="number">0xfa</span>, <span class="number">0x60</span>, <span class="number">0xaf</span>, <span class="number">0x60</span>, <span class="number">0x1d</span>, <span class="number">0xec</span>, <span class="number">0xb8</span>, <span class="number">0xfc</span>, <span class="number">0x9d</span>, <span class="number">0x48</span>, <span class="number">0x60</span>, <span class="number">0xe8</span>, <span class="number">0xac</span>, <span class="number">0x1e</span>,</span><br><span class="line">    <span class="number">0x88</span>, <span class="number">0x97</span>, <span class="number">0x20</span>, <span class="number">0x3d</span>, <span class="number">0x80</span>, <span class="number">0x50</span>, <span class="number">0x10</span>, <span class="number">0xc6</span>, <span class="number">0x98</span>, <span class="number">0x60</span>, <span class="number">0xeb</span>, <span class="number">0x90</span>, <span class="number">0x46</span>, <span class="number">0x12</span>, <span class="number">0x0</span>, <span class="number">0x20</span>, <span class="number">0x60</span>, <span class="number">0x8</span>, <span class="number">0x54</span>,</span><br><span class="line">    <span class="number">0xec</span>, <span class="number">0x7b</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0xb0</span>, <span class="number">0x7</span>, <span class="number">0xf0</span>, <span class="number">0x9c</span>, <span class="number">0x58</span>, <span class="number">0xc8</span>, <span class="number">0xd8</span>, <span class="number">0xc</span>, <span class="number">0x9</span>, <span class="number">0xb8</span>, <span class="number">0x39</span>, <span class="number">0x68</span>, <span class="number">0xa0</span>, <span class="number">0x10</span>, <span class="number">0xb6</span>, <span class="number">0x63</span>,</span><br><span class="line">    <span class="number">0x0</span>, <span class="number">0x38</span>, <span class="number">0xc8</span>, <span class="number">0x80</span>, <span class="number">0xdf</span>, <span class="number">0xe6</span>, <span class="number">0x3a</span>, <span class="number">0xdc</span>, <span class="number">0x58</span>, <span class="number">0x58</span>, <span class="number">0x94</span>, <span class="number">0x5c</span>, <span class="number">0x63</span>, <span class="number">0x60</span>, <span class="number">0x8c</span>, <span class="number">0x93</span>, <span class="number">0xc1</span>, <span class="number">0xd0</span>, <span class="number">0xe0</span>,</span><br><span class="line">    <span class="number">0x44</span>, <span class="number">0x56</span>, <span class="number">0x60</span>, <span class="number">0xc8</span>, <span class="number">0xbb</span>, <span class="number">0x7a</span>, <span class="number">0x7e</span>, <span class="number">0x73</span>, <span class="number">0x1b</span>, <span class="number">0xab</span>, <span class="number">0xb8</span>, <span class="number">0xb</span>, <span class="number">0x8c</span>, <span class="number">0x23</span>, <span class="number">0x1c</span>, <span class="number">0xf0</span>, <span class="number">0x18</span>, <span class="number">0x7b</span>, <span class="number">0xf</span>,</span><br><span class="line">    <span class="number">0x93</span>, <span class="number">0xfa</span>, <span class="number">0x66</span>, <span class="number">0xe0</span>, <span class="number">0x4c</span>, <span class="number">0x0</span>, <span class="number">0xe8</span>, <span class="number">0xb4</span>, <span class="number">0x31</span>, <span class="number">0x30</span>, <span class="number">0xf0</span>, <span class="number">0x82</span>, <span class="number">0x18</span>, <span class="number">0x40</span>, <span class="number">0xfe</span>, <span class="number">0x8c</span>, <span class="number">0xf0</span>, <span class="number">0xfc</span>, <span class="number">0x1f</span>,</span><br><span class="line">    <span class="number">0x71</span>, <span class="number">0x8c</span>, <span class="number">0x7e</span>, <span class="number">0xc8</span>, <span class="number">0x80</span>, <span class="number">0xce</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xa0</span>, <span class="number">0xd5</span>, <span class="number">0x23</span>, <span class="number">0x27</span>, <span class="number">0x4</span>, <span class="number">0x0</span>, <span class="number">0xed</span>, <span class="number">0xd9</span>, <span class="number">0x90</span>, <span class="number">0x82</span>, <span class="number">0x6c</span>, <span class="number">0x7d</span>,</span><br><span class="line">    <span class="number">0x4</span>, <span class="number">0x0</span>, <span class="number">0xc0</span>, <span class="number">0x12</span>, <span class="number">0xd3</span>, <span class="number">0x18</span>, <span class="number">0x5d</span>, <span class="number">0x86</span>, <span class="number">0xe0</span>, <span class="number">0x53</span>, <span class="number">0x41</span>, <span class="number">0x9f</span>, <span class="number">0xd8</span>, <span class="number">0xdd</span>, <span class="number">0xb</span>, <span class="number">0xe0</span>, <span class="number">0xe6</span>, <span class="number">0xef</span>, <span class="number">0x82</span>, <span class="number">0x64</span>,</span><br><span class="line">    <span class="number">0x77</span>, <span class="number">0x53</span>, <span class="number">0x7b</span>, <span class="number">0x5b</span>, <span class="number">0xdc</span>, <span class="number">0x14</span>, <span class="number">0x84</span>, <span class="number">0x56</span>, <span class="number">0x80</span>, <span class="number">0x20</span>, <span class="number">0xa8</span>, <span class="number">0x39</span>, <span class="number">0x50</span>, <span class="number">0xe8</span>, <span class="number">0x60</span>, <span class="number">0x58</span>, <span class="number">0x46</span>, <span class="number">0xf0</span>, <span class="number">0xf2</span>,</span><br><span class="line">    <span class="number">0x6</span>, <span class="number">0xc0</span>, <span class="number">0xe6</span>, <span class="number">0x4</span>, <span class="number">0xd0</span>, <span class="number">0xbe</span>, <span class="number">0x79</span>, <span class="number">0xcd</span>, <span class="number">0xa8</span>, <span class="number">0x3e</span>, <span class="number">0xa0</span>, <span class="number">0x1e</span>, <span class="number">0x89</span>, <span class="number">0x24</span>, <span class="number">0x38</span>, <span class="number">0xfb</span>, <span class="number">0x3a</span>, <span class="number">0x58</span>, <span class="number">0x7e</span>,</span><br><span class="line">    <span class="number">0x26</span>, <span class="number">0xa4</span>, <span class="number">0x0</span>, <span class="number">0x38</span>, <span class="number">0x98</span>, <span class="number">0x83</span>, <span class="number">0xe8</span>, <span class="number">0x64</span>, <span class="number">0x78</span>, <span class="number">0xb0</span>, <span class="number">0xd5</span>, <span class="number">0xf9</span>, <span class="number">0xf6</span>, <span class="number">0x16</span>, <span class="number">0x63</span>, <span class="number">0x88</span>, <span class="number">0xa1</span>, <span class="number">0xa0</span>, <span class="number">0x60</span>,</span><br><span class="line">    <span class="number">0xf5</span>, <span class="number">0x24</span>, <span class="number">0xf6</span>, <span class="number">0xe0</span>, <span class="number">0x30</span>, <span class="number">0xe4</span>, <span class="number">0xa4</span>, <span class="number">0x26</span>, <span class="number">0x10</span>, <span class="number">0xbf</span>, <span class="number">0x9d</span>, <span class="number">0xdc</span>, <span class="number">0xf4</span>, <span class="number">0xd0</span>, <span class="number">0x38</span>, <span class="number">0xcd</span>, <span class="number">0xa</span>, <span class="number">0x26</span>, <span class="number">0x29</span>,</span><br><span class="line">    <span class="number">0xc</span>, <span class="number">0xd0</span>, <span class="number">0x78</span>, <span class="number">0xe3</span>, <span class="number">0xb0</span>, <span class="number">0x9a</span>, <span class="number">0x73</span>, <span class="number">0x80</span>, <span class="number">0x43</span>, <span class="number">0xa7</span>, <span class="number">0xa3</span>, <span class="number">0x9c</span>, <span class="number">0xc5</span>, <span class="number">0x7c</span>, <span class="number">0x29</span>, <span class="number">0x4a</span>, <span class="number">0x70</span>, <span class="number">0x28</span>, <span class="number">0xac</span>,</span><br><span class="line">    <span class="number">0x87</span>, <span class="number">0xf1</span>, <span class="number">0x50</span>, <span class="number">0xd4</span>, <span class="number">0x11</span>, <span class="number">0xe8</span>, <span class="number">0x32</span>, <span class="number">0xb8</span>, <span class="number">0xb4</span>, <span class="number">0x4c</span>, <span class="number">0x15</span>, <span class="number">0xb4</span>, <span class="number">0x7c</span>, <span class="number">0x51</span>, <span class="number">0x29</span>, <span class="number">0xac</span>, <span class="number">0x90</span>, <span class="number">0x9e</span>, <span class="number">0x12</span>,</span><br><span class="line">    <span class="number">0xd8</span>, <span class="number">0xbe</span>, <span class="number">0xbf</span>, <span class="number">0x10</span>, <span class="number">0x4</span>, <span class="number">0x84</span>, <span class="number">0xe6</span>, <span class="number">0x88</span>, <span class="number">0xdc</span>, <span class="number">0xdb</span>, <span class="number">0xe0</span>, <span class="number">0x0</span>, <span class="number">0x49</span>, <span class="number">0x60</span>, <span class="number">0xc4</span>, <span class="number">0x10</span>, <span class="number">0x72</span>, <span class="number">0x92</span>, <span class="number">0xee</span>,</span><br><span class="line">    <span class="number">0x8c</span>, <span class="number">0x16</span>, <span class="number">0x75</span>, <span class="number">0x6e</span>, <span class="number">0x7e</span>, <span class="number">0x40</span>, <span class="number">0x8</span>, <span class="number">0x94</span>, <span class="number">0x41</span>, <span class="number">0x40</span>, <span class="number">0x60</span>, <span class="number">0x88</span>, <span class="number">0xb</span>, <span class="number">0x0</span>, <span class="number">0x5a</span>, <span class="number">0x2c</span>, <span class="number">0x2e</span>, <span class="number">0xa</span>, <span class="number">0xa</span>, <span class="number">0x4e</span>,</span><br><span class="line">    <span class="number">0x30</span>, <span class="number">0x2a</span>, <span class="number">0x88</span>, <span class="number">0x4e</span>, <span class="number">0x11</span>, <span class="number">0x23</span>, <span class="number">0xbe</span>, <span class="number">0x70</span>, <span class="number">0x80</span>, <span class="number">0xed</span>, <span class="number">0x50</span>, <span class="number">0xb9</span>, <span class="number">0xbb</span>, <span class="number">0x38</span>, <span class="number">0x50</span>, <span class="number">0x1c</span>, <span class="number">0x6c</span>, <span class="number">0x23</span>, <span class="number">0x20</span>,</span><br><span class="line">    <span class="number">0xca</span>, <span class="number">0xa2</span>, <span class="number">0xe6</span>, <span class="number">0x70</span>, <span class="number">0xf8</span>, <span class="number">0x93</span>, <span class="number">0x45</span>, <span class="number">0x80</span>, <span class="number">0x65</span>, <span class="number">0x5f</span>, <span class="number">0x7b</span>, <span class="number">0xcc</span>, <span class="number">0xa0</span>, <span class="number">0xdc</span>, <span class="number">0x30</span>, <span class="number">0xee</span>, <span class="number">0x56</span>, <span class="number">0x86</span>, <span class="number">0xaf</span>,</span><br><span class="line">    <span class="number">0x10</span>, <span class="number">0xfd</span>, <span class="number">0x79</span>, <span class="number">0xdd</span>, <span class="number">0xec</span>, <span class="number">0x91</span>, <span class="number">0x18</span>, <span class="number">0xb0</span>, <span class="number">0x2c</span>, <span class="number">0xa8</span>, <span class="number">0xc0</span>, <span class="number">0x38</span>, <span class="number">0xf1</span>, <span class="number">0x1f</span>, <span class="number">0x80</span>, <span class="number">0x15</span>, <span class="number">0x62</span>, <span class="number">0x29</span>, <span class="number">0x60</span>,</span><br><span class="line">    <span class="number">0xea</span>, <span class="number">0x90</span>, <span class="number">0x97</span>, <span class="number">0x86</span>, <span class="number">0x61</span>, <span class="number">0xe2</span>, <span class="number">0x7c</span>, <span class="number">0x43</span>, <span class="number">0xd5</span>, <span class="number">0xe</span>, <span class="number">0xa8</span>, <span class="number">0x0</span>, <span class="number">0xe4</span>, <span class="number">0x8c</span>, <span class="number">0x10</span>, <span class="number">0xc6</span>, <span class="number">0x10</span>, <span class="number">0x34</span>, <span class="number">0x44</span>,</span><br><span class="line">    <span class="number">0xd8</span>, <span class="number">0xf2</span>, <span class="number">0x18</span>, <span class="number">0xc0</span>, <span class="number">0xd9</span>, <span class="number">0x5c</span>, <span class="number">0xac</span>, <span class="number">0xb6</span>, <span class="number">0xe5</span>, <span class="number">0xd</span>, <span class="number">0xf</span>, <span class="number">0xdd</span>, <span class="number">0x94</span>, <span class="number">0x88</span>, <span class="number">0xa7</span>, <span class="number">0x58</span>, <span class="number">0xfe</span>, <span class="number">0xe2</span>, <span class="number">0xd5</span>,</span><br><span class="line">    <span class="number">0xb0</span>, <span class="number">0x68</span>, <span class="number">0x8a</span>, <span class="number">0x14</span>, <span class="number">0x98</span>, <span class="number">0xa</span>, <span class="number">0x46</span>, <span class="number">0x16</span>, <span class="number">0xe6</span>, <span class="number">0x60</span>, <span class="number">0x3f</span>, <span class="number">0xc8</span>, <span class="number">0x48</span>, <span class="number">0xa4</span>, <span class="number">0x3a</span>, <span class="number">0x3d</span>, <span class="number">0xd2</span>, <span class="number">0x18</span>, <span class="number">0xd6</span>,</span><br><span class="line">    <span class="number">0x3f</span>, <span class="number">0xff</span>, <span class="number">0x24</span>, <span class="number">0x4d</span>, <span class="number">0x8a</span>, <span class="number">0x0</span>, <span class="number">0xac</span>, <span class="number">0x60</span>, <span class="number">0xf6</span>, <span class="number">0xb6</span>, <span class="number">0xe8</span>, <span class="number">0x0</span>, <span class="number">0xf8</span>, <span class="number">0xcc</span>, <span class="number">0xf8</span>, <span class="number">0x0</span>, <span class="number">0x74</span>, <span class="number">0xe</span>, <span class="number">0xfc</span>, <span class="number">0xc0</span>,</span><br><span class="line">    <span class="number">0xf8</span>, <span class="number">0x8b</span>, <span class="number">0xc8</span>, <span class="number">0x55</span>, <span class="number">0x5d</span>, <span class="number">0x1c</span>, <span class="number">0x20</span>, <span class="number">0x4b</span>, <span class="number">0xf8</span>, <span class="number">0x10</span>, <span class="number">0x80</span>, <span class="number">0xb0</span>, <span class="number">0x0</span>, <span class="number">0x4e</span>, <span class="number">0x9c</span>, <span class="number">0x89</span>, <span class="number">0x98</span>, <span class="number">0xda</span>, <span class="number">0x30</span>,</span><br><span class="line">    <span class="number">0x12</span>, <span class="number">0x4c</span>, <span class="number">0xcd</span>, <span class="number">0xda</span>, <span class="number">0xab</span>, <span class="number">0x3f</span>, <span class="number">0x50</span>, <span class="number">0x28</span>, <span class="number">0xe0</span>, <span class="number">0x0</span>, <span class="number">0x6</span>, <span class="number">0xf0</span>, <span class="number">0x57</span>, <span class="number">0x80</span>, <span class="number">0xf</span>, <span class="number">0xe9</span>, <span class="number">0x34</span>, <span class="number">0x44</span>, <span class="number">0x31</span>, <span class="number">0xf8</span>,</span><br><span class="line">    <span class="number">0x86</span>, <span class="number">0xc1</span>, <span class="number">0x2f</span>, <span class="number">0x0</span>, <span class="number">0x80</span>, <span class="number">0x1e</span>, <span class="number">0xc2</span>, <span class="number">0x60</span>, <span class="number">0xa7</span>, <span class="number">0xb6</span>, <span class="number">0xe0</span>, <span class="number">0x70</span>, <span class="number">0xca</span>, <span class="number">0xa1</span>, <span class="number">0xce</span>, <span class="number">0x4f</span>, <span class="number">0xbb</span>, <span class="number">0xb0</span>, <span class="number">0xc6</span>,</span><br><span class="line">    <span class="number">0xd4</span>, <span class="number">0x2c</span>, <span class="number">0xc6</span>, <span class="number">0x8b</span>, <span class="number">0x0</span>, <span class="number">0xb0</span>, <span class="number">0x10</span>, <span class="number">0xba</span>, <span class="number">0x8d</span>, <span class="number">0x8b</span>, <span class="number">0x18</span>, <span class="number">0xc</span>, <span class="number">0xfd</span>, <span class="number">0x59</span>, <span class="number">0xc3</span>, <span class="number">0xa0</span>, <span class="number">0xaf</span>, <span class="number">0x17</span>, <span class="number">0x82</span>,</span><br><span class="line">    <span class="number">0x61</span>, <span class="number">0xfe</span>, <span class="number">0x80</span>, <span class="number">0x60</span>, <span class="number">0xeb</span>, <span class="number">0xc0</span>, <span class="number">0x46</span>, <span class="number">0x90</span>, <span class="number">0x42</span>, <span class="number">0x40</span>, <span class="number">0xee</span>, <span class="number">0x48</span>, <span class="number">0xbc</span>, <span class="number">0x40</span>, <span class="number">0xd8</span>, <span class="number">0x58</span>, <span class="number">0x60</span>, <span class="number">0x50</span>, <span class="number">0x97</span>,</span><br><span class="line">    <span class="number">0x44</span>, <span class="number">0xd2</span>, <span class="number">0xe0</span>, <span class="number">0xa1</span>, <span class="number">0x4d</span>, <span class="number">0x16</span>, <span class="number">0x50</span>, <span class="number">0x84</span>, <span class="number">0xf0</span>, <span class="number">0x54</span>, <span class="number">0x15</span>, <span class="number">0x9</span>, <span class="number">0xad</span>, <span class="number">0xc</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x44</span>, <span class="number">0x70</span>, <span class="number">0xe0</span>,</span><br><span class="line">    <span class="number">0x51</span>, <span class="number">0xca</span>, <span class="number">0x34</span>, <span class="number">0x86</span>, <span class="number">0x88</span>, <span class="number">0x12</span>, <span class="number">0x14</span>, <span class="number">0xc7</span>, <span class="number">0x20</span>, <span class="number">0xf4</span>, <span class="number">0xf3</span>, <span class="number">0x6b</span>, <span class="number">0x6c</span>, <span class="number">0x10</span>, <span class="number">0xdc</span>, <span class="number">0x54</span>, <span class="number">0x48</span>, <span class="number">0xec</span>, <span class="number">0x7d</span>,</span><br><span class="line">    <span class="number">0x94</span>, <span class="number">0xb8</span>, <span class="number">0x40</span>, <span class="number">0xb9</span>, <span class="number">0x31</span>, <span class="number">0x58</span>, <span class="number">0x9c</span>, <span class="number">0xf0</span>, <span class="number">0xdd</span>, <span class="number">0xa8</span>, <span class="number">0x50</span>, <span class="number">0x57</span>, <span class="number">0x18</span>, <span class="number">0xd0</span>, <span class="number">0x6c</span>, <span class="number">0xfe</span>, <span class="number">0x20</span>, <span class="number">0x6b</span>, <span class="number">0xb9</span>,</span><br><span class="line">    <span class="number">0x17</span>, <span class="number">0x82</span>, <span class="number">0x4e</span>, <span class="number">0xd9</span>, <span class="number">0x68</span>, <span class="number">0x0</span>, <span class="number">0x93</span>, <span class="number">0x3c</span>, <span class="number">0x52</span>, <span class="number">0xa0</span>, <span class="number">0xe2</span>, <span class="number">0xbb</span>, <span class="number">0x40</span>, <span class="number">0x24</span>, <span class="number">0xe8</span>, <span class="number">0xc4</span>, <span class="number">0x55</span>, <span class="number">0xb6</span>, <span class="number">0x27</span>,</span><br><span class="line">    <span class="number">0xca</span>, <span class="number">0x3f</span>, <span class="number">0x76</span>, <span class="number">0x58</span>, <span class="number">0xc0</span>, <span class="number">0xa9</span>, <span class="number">0x0</span>, <span class="number">0x46</span>, <span class="number">0x8</span>, <span class="number">0x20</span>, <span class="number">0xa6</span>, <span class="number">0x90</span>, <span class="number">0x8b</span>, <span class="number">0x56</span>, <span class="number">0x34</span>, <span class="number">0x11</span>, <span class="number">0x9d</span>, <span class="number">0x1d</span>, <span class="number">0xa0</span>,</span><br><span class="line">    <span class="number">0xe0</span>, <span class="number">0x18</span>, <span class="number">0x7e</span>, <span class="number">0x93</span>, <span class="number">0x94</span>, <span class="number">0xbd</span>, <span class="number">0x9c</span>, <span class="number">0xfa</span>, <span class="number">0xb</span>, <span class="number">0xbd</span>, <span class="number">0x6e</span>, <span class="number">0x44</span>, <span class="number">0x2b</span>, <span class="number">0xb3</span>, <span class="number">0x94</span>, <span class="number">0xfd</span>, <span class="number">0xa7</span>, <span class="number">0xa8</span>, <span class="number">0xf0</span>,</span><br><span class="line">    <span class="number">0x64</span>, <span class="number">0xbe</span>, <span class="number">0x8c</span>, <span class="number">0xfa</span>, <span class="number">0xdd</span>, <span class="number">0x5c</span>, <span class="number">0xe</span>, <span class="number">0x8f</span>, <span class="number">0x80</span>, <span class="number">0x5c</span>, <span class="number">0xa8</span>, <span class="number">0x12</span>, <span class="number">0x77</span>, <span class="number">0x70</span>, <span class="number">0x99</span>, <span class="number">0xdc</span>, <span class="number">0x4a</span>, <span class="number">0x76</span>, <span class="number">0x8</span>,</span><br><span class="line">    <span class="number">0x2e</span>, <span class="number">0x54</span>, <span class="number">0x60</span>, <span class="number">0xba</span>, <span class="number">0xe0</span>, <span class="number">0xad</span>, <span class="number">0xc7</span>, <span class="number">0x99</span>, <span class="number">0x9a</span>, <span class="number">0x0</span>, <span class="number">0x8</span>, <span class="number">0x0</span>, <span class="number">0xb8</span>, <span class="number">0x62</span>, <span class="number">0x94</span>, <span class="number">0x41</span>, <span class="number">0x80</span>, <span class="number">0x9a</span>, <span class="number">0xc4</span>, <span class="number">0x26</span>,</span><br><span class="line">    <span class="number">0xed</span>, <span class="number">0xbf</span>, <span class="number">0x90</span>, <span class="number">0xf5</span>, <span class="number">0x74</span>, <span class="number">0x5b</span>, <span class="number">0x2d</span>, <span class="number">0x49</span>, <span class="number">0x57</span>, <span class="number">0xc0</span>, <span class="number">0x44</span>, <span class="number">0xd0</span>, <span class="number">0x9f</span>, <span class="number">0xf2</span>, <span class="number">0x5e</span>, <span class="number">0x60</span>, <span class="number">0xb3</span>, <span class="number">0x40</span>, <span class="number">0x86</span>,</span><br><span class="line">    <span class="number">0x68</span>, <span class="number">0x6a</span>, <span class="number">0x20</span>, <span class="number">0x30</span>, <span class="number">0x16</span>, <span class="number">0xd0</span>, <span class="number">0xbc</span>, <span class="number">0x60</span>, <span class="number">0x7</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x31</span>, <span class="number">0xb9</span>, <span class="number">0x7d</span>, <span class="number">0x8b</span>, <span class="number">0x10</span>, <span class="number">0xf9</span>, <span class="number">0x70</span>, <span class="number">0x42</span>,</span><br><span class="line">    <span class="number">0x29</span>, <span class="number">0x62</span>, <span class="number">0xe8</span>, <span class="number">0x37</span>, <span class="number">0x50</span>, <span class="number">0xc5</span>, <span class="number">0x90</span>, <span class="number">0x28</span>, <span class="number">0xa7</span>, <span class="number">0x84</span>, <span class="number">0x46</span>, <span class="number">0x34</span>, <span class="number">0x68</span>, <span class="number">0x40</span>, <span class="number">0x6b</span>, <span class="number">0xe4</span>, <span class="number">0x40</span>, <span class="number">0x19</span>, <span class="number">0x20</span>,</span><br><span class="line">    <span class="number">0x90</span>, <span class="number">0x26</span>, <span class="number">0x94</span>, <span class="number">0xae</span>, <span class="number">0xc4</span>, <span class="number">0xe1</span>, <span class="number">0x32</span>, <span class="number">0x7e</span>, <span class="number">0xaf</span>, <span class="number">0xfd</span>, <span class="number">0x60</span>, <span class="number">0x10</span>, <span class="number">0x64</span>, <span class="number">0xc4</span>, <span class="number">0x98</span>, <span class="number">0x8</span>, <span class="number">0xc0</span>, <span class="number">0xe9</span>, <span class="number">0xdb</span>,</span><br><span class="line">    <span class="number">0x34</span>, <span class="number">0xb</span>, <span class="number">0x70</span>, <span class="number">0x96</span>, <span class="number">0x64</span>, <span class="number">0x4</span>, <span class="number">0xe2</span>, <span class="number">0x32</span>, <span class="number">0xba</span>, <span class="number">0x99</span>, <span class="number">0x30</span>, <span class="number">0xe8</span>, <span class="number">0xaa</span>, <span class="number">0x1e</span>, <span class="number">0x8e</span>, <span class="number">0xbd</span>, <span class="number">0xd3</span>, <span class="number">0x8e</span>, <span class="number">0x30</span>,</span><br><span class="line">    <span class="number">0x37</span>, <span class="number">0x7d</span>, <span class="number">0x34</span>, <span class="number">0x49</span>, <span class="number">0xf8</span>, <span class="number">0x0</span>, <span class="number">0x3b</span>, <span class="number">0x5e</span>, <span class="number">0xd3</span>, <span class="number">0x7c</span>, <span class="number">0xc8</span>, <span class="number">0x85</span>, <span class="number">0xb3</span>, <span class="number">0xf3</span>, <span class="number">0x40</span>, <span class="number">0x70</span>, <span class="number">0x80</span>, <span class="number">0x40</span>, <span class="number">0xd3</span>,</span><br><span class="line">    <span class="number">0xc5</span>, <span class="number">0x90</span>, <span class="number">0xa8</span>, <span class="number">0xa2</span>, <span class="number">0xb7</span>, <span class="number">0x80</span>, <span class="number">0x0</span>, <span class="number">0xcc</span>, <span class="number">0xb9</span>, <span class="number">0x28</span>, <span class="number">0xc6</span>, <span class="number">0x85</span>, <span class="number">0xbe</span>, <span class="number">0xc</span>, <span class="number">0x98</span>, <span class="number">0xfa</span>, <span class="number">0xb4</span>, <span class="number">0x79</span>, <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0xef</span>, <span class="number">0xb0</span>, <span class="number">0x80</span>, <span class="number">0xcb</span>, <span class="number">0x81</span>, <span class="number">0x0</span>, <span class="number">0x48</span>, <span class="number">0x7f</span>, <span class="number">0xf0</span>, <span class="number">0xc8</span>, <span class="number">0x90</span>, <span class="number">0x4e</span>, <span class="number">0x7c</span>, <span class="number">0xf0</span>, <span class="number">0x6b</span>, <span class="number">0x54</span>, <span class="number">0x59</span>, <span class="number">0xd6</span>, <span class="number">0x4b</span>,</span><br><span class="line">    <span class="number">0xe4</span>, <span class="number">0x79</span>, <span class="number">0x51</span>, <span class="number">0x20</span>, <span class="number">0x0</span>, <span class="number">0xc0</span>, <span class="number">0xf6</span>, <span class="number">0xa9</span>, <span class="number">0xd4</span>, <span class="number">0xd4</span>, <span class="number">0xe0</span>, <span class="number">0xfe</span>, <span class="number">0xef</span>, <span class="number">0x1c</span>, <span class="number">0xb2</span>, <span class="number">0xd4</span>, <span class="number">0x72</span>, <span class="number">0x80</span>, <span class="number">0xc2</span>,</span><br><span class="line">    <span class="number">0xea</span>, <span class="number">0xf6</span>, <span class="number">0xdf</span>, <span class="number">0xf0</span>, <span class="number">0x76</span>, <span class="number">0xef</span>, <span class="number">0x78</span>, <span class="number">0xd4</span>, <span class="number">0x98</span>, <span class="number">0xd7</span>, <span class="number">0x72</span>, <span class="number">0x4d</span>, <span class="number">0xeb</span>, <span class="number">0x40</span>, <span class="number">0x47</span>, <span class="number">0x18</span>, <span class="number">0xa8</span>, <span class="number">0x71</span>, <span class="number">0x52</span>,</span><br><span class="line">    <span class="number">0x57</span>, <span class="number">0xa0</span>, <span class="number">0x77</span>, <span class="number">0xc5</span>, <span class="number">0x86</span>, <span class="number">0x0</span>, <span class="number">0xb0</span>, <span class="number">0xa</span>, <span class="number">0x2d</span>, <span class="number">0xa8</span>, <span class="number">0x90</span>, <span class="number">0xdb</span>, <span class="number">0xe8</span>, <span class="number">0xeb</span>, <span class="number">0xf7</span>, <span class="number">0x8</span>, <span class="number">0x44</span>, <span class="number">0x92</span>, <span class="number">0x64</span>, <span class="number">0x61</span>,</span><br><span class="line">    <span class="number">0xfa</span>, <span class="number">0x66</span>, <span class="number">0x22</span>, <span class="number">0xdc</span>, <span class="number">0xf8</span>, <span class="number">0x0</span>, <span class="number">0x5d</span>, <span class="number">0x1a</span>, <span class="number">0xd6</span>, <span class="number">0xb5</span>, <span class="number">0x18</span>, <span class="number">0x0</span>, <span class="number">0xf8</span>, <span class="number">0x7f</span>, <span class="number">0xd8</span>, <span class="number">0x68</span>, <span class="number">0x7</span>, <span class="number">0x9c</span>, <span class="number">0xdc</span>, <span class="number">0xa0</span>,</span><br><span class="line">    <span class="number">0xf9</span>, <span class="number">0xe</span>, <span class="number">0x88</span>, <span class="number">0x25</span>, <span class="number">0xb0</span>, <span class="number">0x90</span>, <span class="number">0x60</span>, <span class="number">0xf1</span>, <span class="number">0x29</span>, <span class="number">0x88</span>, <span class="number">0xcf</span>, <span class="number">0x84</span>, <span class="number">0x3e</span>, <span class="number">0x20</span>, <span class="number">0x98</span>, <span class="number">0x28</span>, <span class="number">0x3a</span>, <span class="number">0x50</span>, <span class="number">0x87</span>,</span><br><span class="line">    <span class="number">0x33</span>, <span class="number">0x2d</span>, <span class="number">0xb0</span>, <span class="number">0x84</span>, <span class="number">0x84</span>, <span class="number">0xd0</span>, <span class="number">0xa4</span>, <span class="number">0x40</span>, <span class="number">0x0</span>, <span class="number">0x78</span>, <span class="number">0xaa</span>, <span class="number">0xfa</span>, <span class="number">0x20</span>, <span class="number">0xda</span>, <span class="number">0xc5</span>, <span class="number">0x2d</span>, <span class="number">0xf</span>, <span class="number">0x38</span>, <span class="number">0x20</span>,</span><br><span class="line">    <span class="number">0x38</span>, <span class="number">0x3</span>, <span class="number">0xdc</span>, <span class="number">0x43</span>, <span class="number">0x62</span>, <span class="number">0x71</span>, <span class="number">0xb</span>, <span class="number">0xaf</span>, <span class="number">0x20</span>, <span class="number">0x6b</span>, <span class="number">0x0</span>, <span class="number">0xe4</span>, <span class="number">0x58</span>, <span class="number">0xeb</span>, <span class="number">0xc6</span>, <span class="number">0xb8</span>, <span class="number">0xa0</span>, <span class="number">0xa0</span>, <span class="number">0x70</span>, <span class="number">0x10</span>,</span><br><span class="line">    <span class="number">0x76</span>, <span class="number">0x46</span>, <span class="number">0xa0</span>, <span class="number">0xb4</span>, <span class="number">0xd8</span>, <span class="number">0xe2</span>, <span class="number">0x78</span>, <span class="number">0x47</span>, <span class="number">0xe</span>, <span class="number">0x4f</span>, <span class="number">0xc8</span>, <span class="number">0xd4</span>, <span class="number">0x30</span>, <span class="number">0xe4</span>, <span class="number">0x84</span>, <span class="number">0x4c</span>, <span class="number">0xb0</span>, <span class="number">0x91</span>, <span class="number">0xc2</span>,</span><br><span class="line">    <span class="number">0xa0</span>, <span class="number">0xfe</span>, <span class="number">0x70</span>, <span class="number">0xef</span>, <span class="number">0x10</span>, <span class="number">0x40</span>, <span class="number">0x68</span>, <span class="number">0x83</span>, <span class="number">0xd2</span>, <span class="number">0xb4</span>, <span class="number">0x20</span>, <span class="number">0xcd</span>, <span class="number">0xd0</span>, <span class="number">0x0</span>, <span class="number">0xfe</span>, <span class="number">0xb3</span>, <span class="number">0x33</span>, <span class="number">0x37</span>, <span class="number">0x80</span>,</span><br><span class="line">    <span class="number">0x97</span>, <span class="number">0xd7</span>, <span class="number">0xa0</span>, <span class="number">0xc7</span>, <span class="number">0x62</span>, <span class="number">0xbe</span>, <span class="number">0x40</span>, <span class="number">0xff</span>, <span class="number">0xd0</span>, <span class="number">0xc0</span>, <span class="number">0x44</span>, <span class="number">0x94</span>, <span class="number">0xda</span>, <span class="number">0x32</span>, <span class="number">0xb0</span>, <span class="number">0x9c</span>, <span class="number">0xd8</span>, <span class="number">0x5a</span>, <span class="number">0x34</span>,</span><br><span class="line">    <span class="number">0x72</span>, <span class="number">0xe</span>, <span class="number">0x15</span>, <span class="number">0xc</span>, <span class="number">0x80</span>, <span class="number">0xd0</span>, <span class="number">0xc2</span>, <span class="number">0x1a</span>, <span class="number">0xcf</span>, <span class="number">0xfa</span>, <span class="number">0xb2</span>, <span class="number">0x20</span>, <span class="number">0x48</span>, <span class="number">0xc8</span>, <span class="number">0x5e</span>, <span class="number">0x5d</span>, <span class="number">0x62</span>, <span class="number">0xbb</span>, <span class="number">0x26</span>,</span><br><span class="line">    <span class="number">0xa4</span>, <span class="number">0x6b</span>, <span class="number">0x73</span>, <span class="number">0x0</span>, <span class="number">0x8</span>, <span class="number">0xf2</span>, <span class="number">0x8f</span>, <span class="number">0xbb</span>, <span class="number">0x13</span>, <span class="number">0xb6</span>, <span class="number">0x40</span>, <span class="number">0xb</span>, <span class="number">0xf1</span>, <span class="number">0xe9</span>, <span class="number">0xf1</span>, <span class="number">0xf9</span>, <span class="number">0x80</span>, <span class="number">0xf8</span>, <span class="number">0x4c</span>, <span class="number">0xca</span>,</span><br><span class="line">    <span class="number">0x3d</span>, <span class="number">0x60</span>, <span class="number">0xe7</span>, <span class="number">0x9a</span>, <span class="number">0x3e</span>, <span class="number">0xd</span>, <span class="number">0x77</span>, <span class="number">0x83</span>, <span class="number">0x96</span>, <span class="number">0x60</span>, <span class="number">0xa0</span>, <span class="number">0xc4</span>, <span class="number">0x81</span>, <span class="number">0xc4</span>, <span class="number">0xf6</span>, <span class="number">0x20</span>, <span class="number">0x79</span>, <span class="number">0x30</span>, <span class="number">0x40</span>,</span><br><span class="line">    <span class="number">0x42</span>, <span class="number">0x95</span>, <span class="number">0xe4</span>, <span class="number">0xb</span>, <span class="number">0x4a</span>, <span class="number">0x30</span>, <span class="number">0x40</span>, <span class="number">0xaa</span>, <span class="number">0x73</span>, <span class="number">0x91</span>, <span class="number">0xbc</span>, <span class="number">0xa7</span>, <span class="number">0xe8</span>, <span class="number">0xed</span>, <span class="number">0x20</span>, <span class="number">0x4e</span>, <span class="number">0xbc</span>, <span class="number">0x6d</span>, <span class="number">0xbc</span>,</span><br><span class="line">    <span class="number">0xf5</span>, <span class="number">0x22</span>, <span class="number">0xae</span>, <span class="number">0x6b</span>, <span class="number">0x79</span>, <span class="number">0x38</span>, <span class="number">0x81</span>, <span class="number">0x5c</span>, <span class="number">0x88</span>, <span class="number">0x59</span>, <span class="number">0xbc</span>, <span class="number">0x50</span>, <span class="number">0x54</span>, <span class="number">0x6b</span>, <span class="number">0x84</span>, <span class="number">0x61</span>, <span class="number">0xb8</span>, <span class="number">0x20</span>, <span class="number">0xc1</span>,</span><br><span class="line">    <span class="number">0xec</span>, <span class="number">0x8</span>, <span class="number">0xc3</span>, <span class="number">0x9c</span>, <span class="number">0x3a</span>, <span class="number">0x32</span>, <span class="number">0x7</span>, <span class="number">0xd0</span>, <span class="number">0xfb</span>, <span class="number">0xd1</span>, <span class="number">0xd3</span>, <span class="number">0xab</span>, <span class="number">0xbf</span>, <span class="number">0x1c</span>, <span class="number">0xc0</span>, <span class="number">0x93</span>, <span class="number">0x9a</span>, <span class="number">0xe2</span>, <span class="number">0x90</span>,</span><br><span class="line">    <span class="number">0x28</span>, <span class="number">0xa0</span>, <span class="number">0xe0</span>, <span class="number">0xe8</span>, <span class="number">0xf0</span>, <span class="number">0xd1</span>, <span class="number">0xa0</span>, <span class="number">0xcc</span>, <span class="number">0xe0</span>, <span class="number">0xa8</span>, <span class="number">0x5a</span>, <span class="number">0xa0</span>, <span class="number">0x61</span>, <span class="number">0x1a</span>, <span class="number">0xae</span>, <span class="number">0x2e</span>, <span class="number">0xb1</span>, <span class="number">0x19</span>, <span class="number">0x26</span>,</span><br><span class="line">    <span class="number">0x5e</span>, <span class="number">0x0</span>, <span class="number">0xf4</span>, <span class="number">0x5e</span>, <span class="number">0x9c</span>, <span class="number">0xdd</span>, <span class="number">0xb3</span>, <span class="number">0xd0</span>, <span class="number">0x8e</span>, <span class="number">0x80</span>, <span class="number">0x5e</span>, <span class="number">0x6f</span>, <span class="number">0x22</span>, <span class="number">0x28</span>, <span class="number">0x60</span>, <span class="number">0x3e</span>, <span class="number">0xe8</span>, <span class="number">0x9b</span>, <span class="number">0x97</span>,</span><br><span class="line">    <span class="number">0x14</span>, <span class="number">0xe</span>, <span class="number">0xca</span>, <span class="number">0x50</span>, <span class="number">0xc</span>, <span class="number">0x0</span>, <span class="number">0xf</span>, <span class="number">0x40</span>, <span class="number">0x24</span>, <span class="number">0xff</span>, <span class="number">0xf0</span>, <span class="number">0xeb</span>, <span class="number">0xe</span>, <span class="number">0xfa</span>, <span class="number">0x7c</span>, <span class="number">0x74</span>, <span class="number">0x1b</span>, <span class="number">0x6c</span>, <span class="number">0x21</span>, <span class="number">0xb7</span>,</span><br><span class="line">    <span class="number">0xd7</span>, <span class="number">0xb0</span>, <span class="number">0x1b</span>, <span class="number">0x30</span>, <span class="number">0x82</span>, <span class="number">0xbb</span>, <span class="number">0xfa</span>, <span class="number">0x5c</span>, <span class="number">0x3</span>, <span class="number">0xb0</span>, <span class="number">0xc8</span>, <span class="number">0xa0</span>, <span class="number">0x55</span>, <span class="number">0xe1</span>, <span class="number">0xe0</span>, <span class="number">0xb1</span>, <span class="number">0x83</span>, <span class="number">0x34</span>, <span class="number">0xc0</span>,</span><br><span class="line">    <span class="number">0xba</span>, <span class="number">0x50</span>, <span class="number">0xdb</span>, <span class="number">0x44</span>, <span class="number">0x8d</span>, <span class="number">0xd6</span>, <span class="number">0xb1</span>, <span class="number">0x8a</span>, <span class="number">0xbe</span>, <span class="number">0xe7</span>, <span class="number">0x77</span>, <span class="number">0x2</span>, <span class="number">0x88</span>, <span class="number">0x98</span>, <span class="number">0xdd</span>, <span class="number">0x0</span>, <span class="number">0xe1</span>, <span class="number">0xb</span>, <span class="number">0x10</span>, <span class="number">0x18</span>,</span><br><span class="line">    <span class="number">0x4f</span>, <span class="number">0x1</span>, <span class="number">0xc2</span>, <span class="number">0x10</span>, <span class="number">0x70</span>, <span class="number">0x80</span>, <span class="number">0xb3</span>, <span class="number">0x2a</span>, <span class="number">0xc6</span>, <span class="number">0x40</span>, <span class="number">0x4f</span>, <span class="number">0xf9</span>, <span class="number">0x72</span>, <span class="number">0xe</span>, <span class="number">0x21</span>, <span class="number">0xe0</span>, <span class="number">0x7a</span>, <span class="number">0x2c</span>, <span class="number">0xd4</span>,</span><br><span class="line">    <span class="number">0xbc</span>, <span class="number">0x3c</span>, <span class="number">0xf0</span>, <span class="number">0xf2</span>, <span class="number">0xca</span>, <span class="number">0x0</span>, <span class="number">0x72</span>, <span class="number">0x14</span>, <span class="number">0xf0</span>, <span class="number">0xba</span>, <span class="number">0x7f</span>, <span class="number">0x70</span>, <span class="number">0x98</span>, <span class="number">0x80</span>, <span class="number">0x8d</span>, <span class="number">0xa7</span>, <span class="number">0x41</span>, <span class="number">0x54</span>, <span class="number">0x3f</span>,</span><br><span class="line">    <span class="number">0x4d</span>, <span class="number">0xbf</span>, <span class="number">0xc6</span>, <span class="number">0x0</span>, <span class="number">0xc0</span>, <span class="number">0x10</span>, <span class="number">0x30</span>, <span class="number">0x75</span>, <span class="number">0xd6</span>, <span class="number">0x0</span>, <span class="number">0xc0</span>, <span class="number">0x32</span>, <span class="number">0x28</span>, <span class="number">0xe4</span>, <span class="number">0x3f</span>, <span class="number">0xa5</span>, <span class="number">0x94</span>, <span class="number">0x58</span>, <span class="number">0xc8</span>,</span><br><span class="line">    <span class="number">0xd4</span>, <span class="number">0xb6</span>, <span class="number">0x4</span>, <span class="number">0x85</span>, <span class="number">0x38</span>, <span class="number">0x8a</span>, <span class="number">0x49</span>, <span class="number">0x1c</span>, <span class="number">0x26</span>, <span class="number">0xa1</span>, <span class="number">0xec</span>, <span class="number">0xc8</span>, <span class="number">0x86</span>, <span class="number">0x19</span>, <span class="number">0x0</span>, <span class="number">0x58</span>, <span class="number">0x70</span>, <span class="number">0xd1</span>, <span class="number">0xc2</span>,</span><br><span class="line">    <span class="number">0x24</span>, <span class="number">0x6d</span>, <span class="number">0x37</span>, <span class="number">0x2e</span>, <span class="number">0xc0</span>, <span class="number">0x80</span>, <span class="number">0x1c</span>, <span class="number">0x20</span>, <span class="number">0xd5</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x44</span>, <span class="number">0x98</span>, <span class="number">0x99</span>, <span class="number">0x40</span>, <span class="number">0x80</span>, <span class="number">0x15</span>, <span class="number">0x1a</span>, <span class="number">0xde</span>,</span><br><span class="line">    <span class="number">0x98</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x7c</span>, <span class="number">0x6b</span>, <span class="number">0x0</span>, <span class="number">0xed</span>, <span class="number">0x44</span>, <span class="number">0xc3</span>, <span class="number">0xca</span>, <span class="number">0xd8</span>, <span class="number">0xe8</span>, <span class="number">0x80</span>, <span class="number">0x16</span>, <span class="number">0xc4</span>, <span class="number">0xb0</span>, <span class="number">0xd9</span>, <span class="number">0xb8</span>, <span class="number">0xe4</span>, <span class="number">0x5d</span>,</span><br><span class="line">    <span class="number">0xef</span>, <span class="number">0xd3</span>, <span class="number">0x4c</span>, <span class="number">0x60</span>, <span class="number">0xcb</span>, <span class="number">0xdd</span>, <span class="number">0x50</span>, <span class="number">0x91</span>, <span class="number">0xb2</span>, <span class="number">0x40</span>, <span class="number">0x17</span>, <span class="number">0x6c</span>, <span class="number">0xdc</span>, <span class="number">0x20</span>, <span class="number">0x7</span>, <span class="number">0xdc</span>, <span class="number">0x6e</span>, <span class="number">0xff</span>, <span class="number">0xf8</span>,</span><br><span class="line">    <span class="number">0x9d</span>, <span class="number">0x60</span>, <span class="number">0x2f</span>, <span class="number">0xc0</span>, <span class="number">0x94</span>, <span class="number">0x3c</span>, <span class="number">0x9a</span>, <span class="number">0xc0</span>, <span class="number">0x90</span>, <span class="number">0x1a</span>, <span class="number">0x6d</span>, <span class="number">0x70</span>, <span class="number">0x88</span>, <span class="number">0x80</span>, <span class="number">0xae</span>, <span class="number">0x0</span>, <span class="number">0xc8</span>, <span class="number">0x1</span>, <span class="number">0xc0</span>,</span><br><span class="line">    <span class="number">0xd3</span>, <span class="number">0xa5</span>, <span class="number">0xc8</span>, <span class="number">0xa4</span>, <span class="number">0xb6</span>, <span class="number">0x98</span>, <span class="number">0xe0</span>, <span class="number">0x80</span>, <span class="number">0x4c</span>, <span class="number">0x26</span>, <span class="number">0xf0</span>, <span class="number">0x60</span>, <span class="number">0x51</span>, <span class="number">0x3c</span>, <span class="number">0x55</span>, <span class="number">0x78</span>, <span class="number">0x36</span>, <span class="number">0x5a</span>, <span class="number">0x9e</span>,</span><br><span class="line">    <span class="number">0xf1</span>, <span class="number">0x58</span>, <span class="number">0xd5</span>, <span class="number">0x9</span>, <span class="number">0xd2</span>, <span class="number">0xa6</span>, <span class="number">0xb7</span>, <span class="number">0x7c</span>, <span class="number">0x79</span>, <span class="number">0x8a</span>, <span class="number">0x50</span>, <span class="number">0x13</span>, <span class="number">0x95</span>, <span class="number">0xb3</span>, <span class="number">0x9e</span>, <span class="number">0x32</span>, <span class="number">0x38</span>, <span class="number">0xdd</span>, <span class="number">0xbd</span>,</span><br><span class="line">    <span class="number">0xe4</span>, <span class="number">0xdc</span>, <span class="number">0x8f</span>, <span class="number">0xa0</span>, <span class="number">0x2e</span>, <span class="number">0x40</span>, <span class="number">0xc8</span>, <span class="number">0x34</span>, <span class="number">0x9a</span>, <span class="number">0xff</span>, <span class="number">0xe0</span>, <span class="number">0x49</span>, <span class="number">0x90</span>, <span class="number">0x72</span>, <span class="number">0xd9</span>, <span class="number">0xa4</span>, <span class="number">0xc8</span>, <span class="number">0xaa</span>, <span class="number">0x7c</span>,</span><br><span class="line">    <span class="number">0x41</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x0</span>, <span class="number">0x4c</span>, <span class="number">0xf</span>, <span class="number">0xc0</span>, <span class="number">0xee</span>, <span class="number">0x7c</span>, <span class="number">0x61</span>, <span class="number">0xbc</span>, <span class="number">0xd0</span>, <span class="number">0x0</span>, <span class="number">0x94</span>, <span class="number">0x42</span>, <span class="number">0x78</span>, <span class="number">0xc5</span>, <span class="number">0x98</span>, <span class="number">0xb9</span>, <span class="number">0x1f</span>,</span><br><span class="line">    <span class="number">0x68</span>, <span class="number">0x9b</span>, <span class="number">0x91</span>, <span class="number">0xd7</span>, <span class="number">0x4</span>, <span class="number">0x8</span>, <span class="number">0xbe</span>, <span class="number">0x66</span>, <span class="number">0x0</span>, <span class="number">0xe8</span>, <span class="number">0xfc</span>, <span class="number">0x70</span>, <span class="number">0x40</span>, <span class="number">0x9c</span>, <span class="number">0x3e</span>, <span class="number">0xc0</span>, <span class="number">0xa</span>, <span class="number">0x3c</span>, <span class="number">0x35</span>, <span class="number">0x58</span>,</span><br><span class="line">    <span class="number">0xb7</span>, <span class="number">0xff</span>, <span class="number">0x2d</span>, <span class="number">0x60</span>, <span class="number">0x9a</span>, <span class="number">0x88</span>, <span class="number">0xbe</span>, <span class="number">0x6f</span>, <span class="number">0xd4</span>, <span class="number">0x10</span>, <span class="number">0x9b</span>, <span class="number">0xa0</span>, <span class="number">0x7a</span>, <span class="number">0xee</span>, <span class="number">0xa6</span>, <span class="number">0x56</span>, <span class="number">0x6a</span>, <span class="number">0x7</span>, <span class="number">0x55</span>,</span><br><span class="line">    <span class="number">0x0</span>, <span class="number">0x87</span>, <span class="number">0xd4</span>, <span class="number">0xc5</span>, <span class="number">0x3c</span>, <span class="number">0xef</span>, <span class="number">0xd0</span>, <span class="number">0xfc</span>, <span class="number">0xd6</span>, <span class="number">0x30</span>, <span class="number">0x0</span>, <span class="number">0xf6</span>, <span class="number">0x0</span>, <span class="number">0x6d</span>, <span class="number">0x72</span>, <span class="number">0x18</span>, <span class="number">0x87</span>, <span class="number">0xd8</span>, <span class="number">0xaa</span>, <span class="number">0x98</span>,</span><br><span class="line">    <span class="number">0x96</span>, <span class="number">0x95</span>, <span class="number">0x48</span>, <span class="number">0xb1</span>, <span class="number">0x79</span>, <span class="number">0xf0</span>, <span class="number">0x9e</span>, <span class="number">0x20</span>, <span class="number">0xd7</span>, <span class="number">0x40</span>, <span class="number">0x70</span>, <span class="number">0x50</span>, <span class="number">0xe4</span>, <span class="number">0x54</span>, <span class="number">0x7c</span>, <span class="number">0xcc</span>, <span class="number">0xce</span>, <span class="number">0x10</span>, <span class="number">0x16</span>,</span><br><span class="line">    <span class="number">0xa2</span>, <span class="number">0xfd</span>, <span class="number">0x36</span>, <span class="number">0x86</span>, <span class="number">0x50</span>, <span class="number">0x9a</span>, <span class="number">0xe0</span>, <span class="number">0x9c</span>, <span class="number">0xa4</span>, <span class="number">0x5a</span>, <span class="number">0x62</span>, <span class="number">0xce</span>, <span class="number">0xb1</span>, <span class="number">0x77</span>, <span class="number">0xea</span>, <span class="number">0x45</span>, <span class="number">0x40</span>, <span class="number">0x53</span>, <span class="number">0xaa</span>,</span><br><span class="line">    <span class="number">0x86</span>, <span class="number">0xf0</span>, <span class="number">0xb</span>, <span class="number">0x4</span>, <span class="number">0xb2</span>, <span class="number">0x3b</span>, <span class="number">0x50</span>, <span class="number">0x10</span>, <span class="number">0xf8</span>, <span class="number">0x62</span>, <span class="number">0xd0</span>, <span class="number">0xb6</span>, <span class="number">0xac</span>, <span class="number">0x70</span>, <span class="number">0x80</span>, <span class="number">0x66</span>, <span class="number">0xd8</span>, <span class="number">0x10</span>, <span class="number">0x28</span>,</span><br><span class="line">    <span class="number">0x38</span>, <span class="number">0x89</span>, <span class="number">0x5</span>, <span class="number">0xf9</span>, <span class="number">0x69</span>, <span class="number">0x98</span>, <span class="number">0x5b</span>, <span class="number">0xe0</span>, <span class="number">0x68</span>, <span class="number">0xf2</span>, <span class="number">0xf5</span>, <span class="number">0xa7</span>, <span class="number">0xab</span>, <span class="number">0x90</span>, <span class="number">0xa8</span>, <span class="number">0xcb</span>, <span class="number">0x40</span>, <span class="number">0xa8</span>, <span class="number">0xb8</span>,</span><br><span class="line">    <span class="number">0xd0</span>, <span class="number">0x8d</span>, <span class="number">0x28</span>, <span class="number">0x53</span>, <span class="number">0x9c</span>, <span class="number">0x52</span>, <span class="number">0xcc</span>, <span class="number">0xfe</span>, <span class="number">0xc0</span>, <span class="number">0x47</span>, <span class="number">0x30</span>, <span class="number">0xff</span>, <span class="number">0x1c</span>, <span class="number">0x58</span>, <span class="number">0xe6</span>, <span class="number">0x69</span>, <span class="number">0x87</span>, <span class="number">0xc0</span>, <span class="number">0x98</span>,</span><br><span class="line">    <span class="number">0x8c</span>, <span class="number">0xc0</span>, <span class="number">0x90</span>, <span class="number">0x8c</span>, <span class="number">0xf9</span>, <span class="number">0xee</span>, <span class="number">0xbe</span>, <span class="number">0x10</span>, <span class="number">0xd0</span>, <span class="number">0x98</span>, <span class="number">0x20</span>, <span class="number">0xa6</span>, <span class="number">0x8e</span>, <span class="number">0xe8</span>, <span class="number">0xd6</span>, <span class="number">0x10</span>, <span class="number">0x32</span>, <span class="number">0x70</span>, <span class="number">0x7e</span>,</span><br><span class="line">    <span class="number">0x42</span>, <span class="number">0xb9</span>, <span class="number">0x14</span>, <span class="number">0x6c</span>, <span class="number">0xe5</span>, <span class="number">0xe</span>, <span class="number">0xc8</span>, <span class="number">0x6c</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0xca</span>, <span class="number">0x46</span>, <span class="number">0x74</span>, <span class="number">0x98</span>, <span class="number">0x12</span>, <span class="number">0xc7</span>, <span class="number">0xd8</span>, <span class="number">0x60</span>, <span class="number">0x9c</span>, <span class="number">0xd4</span>,</span><br><span class="line">    <span class="number">0xc6</span>, <span class="number">0xf8</span>, <span class="number">0xfc</span>, <span class="number">0x2</span>, <span class="number">0x60</span>, <span class="number">0xc0</span>, <span class="number">0xc4</span>, <span class="number">0x10</span>, <span class="number">0x1a</span>, <span class="number">0xba</span>, <span class="number">0xac</span>, <span class="number">0x23</span>, <span class="number">0x40</span>, <span class="number">0xdf</span>, <span class="number">0x82</span>, <span class="number">0x47</span>, <span class="number">0x7d</span>, <span class="number">0x86</span>, <span class="number">0x6</span>,</span><br><span class="line">    <span class="number">0xd0</span>, <span class="number">0xf2</span>, <span class="number">0x8</span>, <span class="number">0x3</span>, <span class="number">0x9e</span>, <span class="number">0x98</span>, <span class="number">0x70</span>, <span class="number">0xd0</span>, <span class="number">0x9a</span>, <span class="number">0xe</span>, <span class="number">0x35</span>, <span class="number">0x58</span>, <span class="number">0xb1</span>, <span class="number">0x62</span>, <span class="number">0xd0</span>, <span class="number">0x3f</span>, <span class="number">0xe1</span>, <span class="number">0x83</span>, <span class="number">0xb</span>, <span class="number">0x50</span>,</span><br><span class="line">    <span class="number">0x6c</span>, <span class="number">0x3c</span>, <span class="number">0xd1</span>, <span class="number">0xe3</span>, <span class="number">0x48</span>, <span class="number">0x14</span>, <span class="number">0xe0</span>, <span class="number">0x82</span>, <span class="number">0xe9</span>, <span class="number">0x90</span>, <span class="number">0x3e</span>, <span class="number">0x20</span>, <span class="number">0x4b</span>, <span class="number">0x7a</span>, <span class="number">0xb2</span>, <span class="number">0x13</span>, <span class="number">0x24</span>, <span class="number">0x99</span>, <span class="number">0x3c</span>,</span><br><span class="line">    <span class="number">0x5c</span>, <span class="number">0x13</span>, <span class="number">0xb0</span>, <span class="number">0x49</span>, <span class="number">0xbc</span>, <span class="number">0x7</span>, <span class="number">0xb9</span>, <span class="number">0x50</span>, <span class="number">0xaa</span>, <span class="number">0xf4</span>, <span class="number">0x20</span>, <span class="number">0x79</span>, <span class="number">0x88</span>, <span class="number">0x17</span>, <span class="number">0x23</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xe3</span>, <span class="number">0xb3</span>,</span><br><span class="line">    <span class="number">0x50</span>, <span class="number">0xb</span>, <span class="number">0xf3</span>, <span class="number">0x4d</span>, <span class="number">0x40</span>, <span class="number">0xc0</span>, <span class="number">0xd8</span>, <span class="number">0xb1</span>, <span class="number">0x16</span>, <span class="number">0x90</span>, <span class="number">0x54</span>, <span class="number">0x53</span>, <span class="number">0x60</span>, <span class="number">0x49</span>, <span class="number">0xf8</span>, <span class="number">0x60</span>, <span class="number">0xb</span>, <span class="number">0xa9</span>, <span class="number">0xde</span>,</span><br><span class="line">    <span class="number">0xe4</span>, <span class="number">0x0</span>, <span class="number">0xb8</span>, <span class="number">0x70</span>, <span class="number">0x94</span>, <span class="number">0xaf</span>, <span class="number">0x99</span>, <span class="number">0x4</span>, <span class="number">0x38</span>, <span class="number">0xd8</span>, <span class="number">0x1e</span>, <span class="number">0x0</span>, <span class="number">0xc4</span>, <span class="number">0x9c</span>, <span class="number">0x40</span>, <span class="number">0x4</span>, <span class="number">0x4b</span>, <span class="number">0xd9</span>, <span class="number">0xf8</span>, <span class="number">0x70</span>,</span><br><span class="line">    <span class="number">0xc8</span>, <span class="number">0x84</span>, <span class="number">0x34</span>, <span class="number">0x97</span>, <span class="number">0xf7</span>, <span class="number">0xea</span>, <span class="number">0xce</span>, <span class="number">0x3c</span>, <span class="number">0xc0</span>, <span class="number">0x53</span>, <span class="number">0x7c</span>, <span class="number">0xfa</span>, <span class="number">0x78</span>, <span class="number">0xf</span>, <span class="number">0x93</span>, <span class="number">0xda</span>, <span class="number">0x10</span>, <span class="number">0x48</span>, <span class="number">0x4f</span>,</span><br><span class="line">    <span class="number">0xf8</span>, <span class="number">0x2c</span>, <span class="number">0x8e</span>, <span class="number">0x5a</span>, <span class="number">0xe0</span>, <span class="number">0x40</span>, <span class="number">0x55</span>, <span class="number">0x4c</span>, <span class="number">0x9f</span>, <span class="number">0xb8</span>, <span class="number">0x8f</span>, <span class="number">0x57</span>, <span class="number">0x80</span>, <span class="number">0x61</span>, <span class="number">0xe5</span>, <span class="number">0x3</span>, <span class="number">0x87</span>, <span class="number">0x10</span>, <span class="number">0x82</span>,</span><br><span class="line">    <span class="number">0xc2</span>, <span class="number">0xc2</span>, <span class="number">0x45</span>, <span class="number">0xc6</span>, <span class="number">0xe9</span>, <span class="number">0x60</span>, <span class="number">0x0</span>, <span class="number">0xdb</span>, <span class="number">0x18</span>, <span class="number">0xa8</span>, <span class="number">0xb8</span>, <span class="number">0xf6</span>, <span class="number">0xea</span>, <span class="number">0xee</span>, <span class="number">0xe0</span>, <span class="number">0x34</span>, <span class="number">0x30</span>, <span class="number">0x7e</span>, <span class="number">0x14</span>,</span><br><span class="line">    <span class="number">0x9e</span>, <span class="number">0x92</span>, <span class="number">0x9c</span>, <span class="number">0xb3</span>, <span class="number">0x8a</span>, <span class="number">0xf0</span>, <span class="number">0x64</span>, <span class="number">0x91</span>, <span class="number">0x90</span>, <span class="number">0x52</span>, <span class="number">0x28</span>, <span class="number">0xb8</span>, <span class="number">0x4f</span>, <span class="number">0x0</span>, <span class="number">0x4c</span>, <span class="number">0x74</span>, <span class="number">0x0</span>, <span class="number">0xa0</span>, <span class="number">0xaa</span>,</span><br><span class="line">    <span class="number">0xbe</span>, <span class="number">0x30</span>, <span class="number">0x78</span>, <span class="number">0x5d</span>, <span class="number">0x4c</span>, <span class="number">0x30</span>, <span class="number">0xec</span>, <span class="number">0xd2</span>, <span class="number">0x7a</span>, <span class="number">0x98</span>, <span class="number">0xcc</span>, <span class="number">0xfd</span>, <span class="number">0xf1</span>, <span class="number">0x38</span>, <span class="number">0xa6</span>, <span class="number">0xf2</span>, <span class="number">0x78</span>, <span class="number">0xfc</span>, <span class="number">0x40</span>,</span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0xd4</span>, <span class="number">0xc8</span>, <span class="number">0xfb</span>, <span class="number">0xd0</span>, <span class="number">0x6c</span>, <span class="number">0x9c</span>, <span class="number">0x78</span>, <span class="number">0x52</span>, <span class="number">0x4</span>, <span class="number">0xb</span>, <span class="number">0xf7</span>, <span class="number">0x88</span>, <span class="number">0x11</span>, <span class="number">0x62</span>, <span class="number">0xf6</span>, <span class="number">0x28</span>,</span><br><span class="line">    <span class="number">0xf2</span>, <span class="number">0x40</span>, <span class="number">0x90</span>, <span class="number">0x54</span>, <span class="number">0x8e</span>, <span class="number">0xaf</span>, <span class="number">0x2e</span>, <span class="number">0xd4</span>, <span class="number">0xb9</span>, <span class="number">0x2a</span>, <span class="number">0x1f</span>, <span class="number">0xb0</span>, <span class="number">0xdb</span>, <span class="number">0xcd</span>, <span class="number">0x34</span>, <span class="number">0x90</span>, <span class="number">0xd8</span>, <span class="number">0x45</span>, <span class="number">0x80</span>,</span><br><span class="line">    <span class="number">0x5c</span>, <span class="number">0xf0</span>, <span class="number">0x19</span>, <span class="number">0xa9</span>, <span class="number">0xc2</span>, <span class="number">0xd0</span>, <span class="number">0x73</span>, <span class="number">0xb9</span>, <span class="number">0xe</span>, <span class="number">0x6</span>, <span class="number">0xf</span>, <span class="number">0x34</span>, <span class="number">0x4b</span>, <span class="number">0xd4</span>, <span class="number">0x28</span>, <span class="number">0xe0</span>, <span class="number">0xa</span>, <span class="number">0xdc</span>, <span class="number">0x63</span>, <span class="number">0x2a</span>,</span><br><span class="line">    <span class="number">0xb7</span>, <span class="number">0xc4</span>, <span class="number">0xf0</span>, <span class="number">0x40</span>, <span class="number">0x62</span>, <span class="number">0x17</span>, <span class="number">0x6d</span>, <span class="number">0x14</span>, <span class="number">0xcb</span>, <span class="number">0x6f</span>, <span class="number">0xe8</span>, <span class="number">0x4d</span>, <span class="number">0x40</span>, <span class="number">0xfb</span>, <span class="number">0x2</span>, <span class="number">0xc2</span>, <span class="number">0xf3</span>, <span class="number">0x70</span>, <span class="number">0x40</span>,</span><br><span class="line">    <span class="number">0xc7</span>, <span class="number">0x69</span>, <span class="number">0xa8</span>, <span class="number">0x9d</span>, <span class="number">0xd5</span>, <span class="number">0x33</span>, <span class="number">0xa8</span>, <span class="number">0x1c</span>, <span class="number">0xdf</span>, <span class="number">0x64</span>, <span class="number">0x98</span>, <span class="number">0xb8</span>, <span class="number">0x9d</span>, <span class="number">0xe0</span>, <span class="number">0x84</span>, <span class="number">0xe8</span>, <span class="number">0xe</span>, <span class="number">0x21</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x87</span>, <span class="number">0x2</span>, <span class="number">0xa3</span>, <span class="number">0x6</span>, <span class="number">0x10</span>, <span class="number">0x8f</span>, <span class="number">0x54</span>, <span class="number">0x48</span>, <span class="number">0x65</span>, <span class="number">0x20</span>, <span class="number">0x38</span>, <span class="number">0x54</span>, <span class="number">0xb6</span>, <span class="number">0x2f</span>, <span class="number">0x70</span>, <span class="number">0xa0</span>, <span class="number">0xf4</span>, <span class="number">0x8b</span>, <span class="number">0x27</span>,</span><br><span class="line">    <span class="number">0x20</span>, <span class="number">0x28</span>, <span class="number">0x7</span>, <span class="number">0xe4</span>, <span class="number">0x69</span>, <span class="number">0x3e</span>, <span class="number">0xb0</span>, <span class="number">0x95</span>, <span class="number">0x70</span>, <span class="number">0x78</span>, <span class="number">0xda</span>, <span class="number">0x22</span>, <span class="number">0x50</span>, <span class="number">0x62</span>, <span class="number">0x7</span>, <span class="number">0x8a</span>, <span class="number">0x90</span>, <span class="number">0x1</span>, <span class="number">0x4f</span>, <span class="number">0x1e</span>,</span><br><span class="line">    <span class="number">0x78</span>, <span class="number">0xfd</span>, <span class="number">0x44</span>, <span class="number">0x1c</span>, <span class="number">0x20</span>, <span class="number">0x1b</span>, <span class="number">0x64</span>, <span class="number">0xde</span>, <span class="number">0xdb</span>, <span class="number">0x3</span>, <span class="number">0xd8</span>, <span class="number">0xcd</span>, <span class="number">0x34</span>, <span class="number">0xcf</span>, <span class="number">0x42</span>, <span class="number">0xf0</span>, <span class="number">0xff</span>, <span class="number">0xbc</span>, <span class="number">0xa2</span>,</span><br><span class="line">    <span class="number">0x2c</span>, <span class="number">0x98</span>, <span class="number">0x7d</span>, <span class="number">0xb5</span>, <span class="number">0x70</span>, <span class="number">0x6e</span>, <span class="number">0xb8</span>, <span class="number">0xa4</span>, <span class="number">0x24</span>, <span class="number">0xea</span>, <span class="number">0x50</span>, <span class="number">0x80</span>, <span class="number">0x10</span>, <span class="number">0x8</span>, <span class="number">0x5f</span>, <span class="number">0x90</span>, <span class="number">0x35</span>, <span class="number">0xb2</span>, <span class="number">0xc4</span>,</span><br><span class="line">    <span class="number">0x54</span>, <span class="number">0x38</span>, <span class="number">0xac</span>, <span class="number">0xa6</span>, <span class="number">0x68</span>, <span class="number">0xec</span>, <span class="number">0x40</span>, <span class="number">0xe4</span>, <span class="number">0x2d</span>, <span class="number">0x92</span>, <span class="number">0xb6</span>, <span class="number">0x8</span>, <span class="number">0xa9</span>, <span class="number">0xe0</span>, <span class="number">0x6</span>, <span class="number">0xe4</span>, <span class="number">0xb0</span>, <span class="number">0x48</span>, <span class="number">0x7f</span>,</span><br><span class="line">    <span class="number">0xd0</span>, <span class="number">0xad</span>, <span class="number">0xf6</span>, <span class="number">0xbc</span>, <span class="number">0x14</span>, <span class="number">0xba</span>, <span class="number">0x59</span>, <span class="number">0x2d</span>, <span class="number">0x0</span>, <span class="number">0xe8</span>, <span class="number">0x3f</span>, <span class="number">0xd8</span>, <span class="number">0x2f</span>, <span class="number">0x20</span>, <span class="number">0xc0</span>, <span class="number">0x64</span>, <span class="number">0x29</span>, <span class="number">0xd6</span>, <span class="number">0x65</span>,</span><br><span class="line">    <span class="number">0xd0</span>, <span class="number">0x88</span>, <span class="number">0x6</span>, <span class="number">0x3c</span>, <span class="number">0x21</span>, <span class="number">0xa4</span>, <span class="number">0x43</span>, <span class="number">0xd0</span>, <span class="number">0xf0</span>, <span class="number">0xe6</span>, <span class="number">0xdc</span>, <span class="number">0x0</span>, <span class="number">0xbc</span>, <span class="number">0x87</span>, <span class="number">0x78</span>, <span class="number">0xd7</span>, <span class="number">0x53</span>, <span class="number">0xd4</span>, <span class="number">0xe</span>, <span class="number">0xf0</span>,</span><br><span class="line">    <span class="number">0x38</span>, <span class="number">0xf8</span>, <span class="number">0x40</span>, <span class="number">0xfc</span>, <span class="number">0x31</span>, <span class="number">0x1</span>, <span class="number">0x62</span>, <span class="number">0xc6</span>, <span class="number">0x74</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x0</span>, <span class="number">0x48</span>, <span class="number">0x2e</span>, <span class="number">0xd2</span>, <span class="number">0xd</span>, <span class="number">0x1c</span>, <span class="number">0x25</span>, <span class="number">0xdc</span>, <span class="number">0x13</span>,</span><br><span class="line">    <span class="number">0x43</span>, <span class="number">0x0</span>, <span class="number">0x9f</span>, <span class="number">0x99</span>, <span class="number">0x3d</span>, <span class="number">0xab</span>, <span class="number">0x37</span>, <span class="number">0x7c</span>, <span class="number">0xdb</span>, <span class="number">0x7f</span>, <span class="number">0x2a</span>, <span class="number">0xed</span>, <span class="number">0xdc</span>, <span class="number">0xfa</span>, <span class="number">0x4d</span>, <span class="number">0x90</span>, <span class="number">0xee</span>, <span class="number">0xd8</span>, <span class="number">0x19</span>,</span><br><span class="line">    <span class="number">0xde</span>, <span class="number">0xb7</span>, <span class="number">0x4c</span>, <span class="number">0x89</span>, <span class="number">0x43</span>, <span class="number">0x28</span>, <span class="number">0xb0</span>, <span class="number">0x9f</span>, <span class="number">0x78</span>, <span class="number">0x4e</span>, <span class="number">0x48</span>, <span class="number">0x3a</span>, <span class="number">0x98</span>, <span class="number">0x20</span>, <span class="number">0x80</span>, <span class="number">0xd0</span>, <span class="number">0xa2</span>, <span class="number">0xf8</span>, <span class="number">0x40</span>,</span><br><span class="line">    <span class="number">0x5b</span>, <span class="number">0x98</span>, <span class="number">0xc0</span>, <span class="number">0x88</span>, <span class="number">0x45</span>, <span class="number">0xbc</span>, <span class="number">0x60</span>, <span class="number">0x11</span>, <span class="number">0xf8</span>, <span class="number">0x48</span>, <span class="number">0xbf</span>, <span class="number">0xe4</span>, <span class="number">0xb2</span>, <span class="number">0x55</span>, <span class="number">0xcf</span>, <span class="number">0x9d</span>, <span class="number">0xb</span>, <span class="number">0xf4</span>, <span class="number">0x12</span>,</span><br><span class="line">    <span class="number">0xca</span>, <span class="number">0x0</span>, <span class="number">0xdc</span>, <span class="number">0xe0</span>, <span class="number">0xfc</span>, <span class="number">0x74</span>, <span class="number">0xdd</span>, <span class="number">0x8e</span>, <span class="number">0xb2</span>, <span class="number">0x9e</span>, <span class="number">0x40</span>, <span class="number">0xfc</span>, <span class="number">0x80</span>, <span class="number">0x7e</span>, <span class="number">0x67</span>, <span class="number">0x50</span>, <span class="number">0x2e</span>, <span class="number">0x4e</span>, <span class="number">0xce</span>,</span><br><span class="line">    <span class="number">0x1d</span>, <span class="number">0x21</span>, <span class="number">0x8a</span>, <span class="number">0x98</span>, <span class="number">0x9b</span>, <span class="number">0x24</span>, <span class="number">0x20</span>, <span class="number">0xe0</span>, <span class="number">0xa2</span>, <span class="number">0x64</span>, <span class="number">0x24</span>, <span class="number">0xa3</span>, <span class="number">0xa2</span>,</span><br><span class="line">]</span><br><span class="line">data.reverse()</span><br><span class="line">array = [</span><br><span class="line">    <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>,</span><br><span class="line">    <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>, <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>,</span><br><span class="line">    <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>,</span><br><span class="line">    <span class="number">0x72</span>, <span class="number">0xC0</span>, <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>,</span><br><span class="line">    <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>, <span class="number">0x04</span>, <span class="number">0xC7</span>,</span><br><span class="line">    <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>,</span><br><span class="line">    <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>, <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>,</span><br><span class="line">    <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>,</span><br><span class="line">    <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>, <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>,</span><br><span class="line">    <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>,</span><br><span class="line">    <span class="number">0x9F</span>, <span class="number">0xA8</span>, <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>,</span><br><span class="line">    <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>, <span class="number">0xCD</span>, <span class="number">0x0C</span>,</span><br><span class="line">    <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>,</span><br><span class="line">    <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>, <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>,</span><br><span class="line">    <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,</span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>,</span><br><span class="line">    <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>, <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>,</span><br><span class="line">    <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>,</span><br><span class="line">    <span class="number">0xAE</span>, <span class="number">0x08</span>, <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>,</span><br><span class="line">    <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>, <span class="number">0x70</span>, <span class="number">0x3E</span>,</span><br><span class="line">    <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>,</span><br><span class="line">    <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>, <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>,</span><br><span class="line">    <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,</span><br><span class="line">    <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>,</span><br><span class="line">    <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span></span><br><span class="line">]</span><br><span class="line">charset = [<span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x33</span>, <span class="number">0x34</span>, <span class="number">0x35</span>, <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x30</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x65</span>, <span class="number">0x66</span>]</span><br><span class="line">num_array_1 = [</span><br><span class="line">    <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x02</span>,</span><br><span class="line">    <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x02</span>,</span><br><span class="line">    <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x02</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">num_array_2 = [</span><br><span class="line">    <span class="number">0x61</span>, <span class="number">0x63</span>, <span class="number">0x32</span>, <span class="number">0x30</span>, <span class="number">0x31</span>, <span class="number">0x38</span>, <span class="number">0x63</span>, <span class="number">0x39</span>, <span class="number">0x63</span>, <span class="number">0x34</span>,</span><br><span class="line">    <span class="number">0x39</span>, <span class="number">0x34</span>, <span class="number">0x33</span>, <span class="number">0x36</span>, <span class="number">0x65</span>, <span class="number">0x63</span>, <span class="number">0x33</span>, <span class="number">0x31</span>, <span class="number">0x35</span>, <span class="number">0x34</span>,</span><br><span class="line">    <span class="number">0x36</span>, <span class="number">0x39</span>, <span class="number">0x31</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x31</span>, <span class="number">0x64</span>, <span class="number">0x65</span>, <span class="number">0x35</span>,</span><br><span class="line">    <span class="number">0x32</span>, <span class="number">0x63</span>, <span class="number">0x61</span>, <span class="number">0x39</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x35</span>, <span class="number">0x31</span>, <span class="number">0x63</span>, <span class="number">0x33</span>,</span><br><span class="line">    <span class="number">0x38</span>, <span class="number">0x63</span>, <span class="number">0x31</span>, <span class="number">0x33</span>, <span class="number">0x37</span>, <span class="number">0x32</span>, <span class="number">0x32</span>, <span class="number">0x64</span>, <span class="number">0x31</span>, <span class="number">0x31</span>,</span><br><span class="line">    <span class="number">0x61</span>, <span class="number">0x33</span>, <span class="number">0x32</span>, <span class="number">0x35</span>, <span class="number">0x61</span>, <span class="number">0x31</span>, <span class="number">0x38</span>, <span class="number">0x31</span>, <span class="number">0x39</span>, <span class="number">0x38</span>,</span><br><span class="line">    <span class="number">0x34</span>, <span class="number">0x31</span>, <span class="number">0x31</span>, <span class="number">0x65</span>, <span class="number">0x39</span>, <span class="number">0x31</span>, <span class="number">0x63</span>, <span class="number">0x61</span>, <span class="number">0x39</span>, <span class="number">0x65</span>,</span><br><span class="line">    <span class="number">0x34</span>, <span class="number">0x63</span></span><br><span class="line">]</span><br><span class="line">result = [</span><br><span class="line">    <span class="number">0x376856ABEED8592A</span>, <span class="number">0x3CCF537F7ECA40AB</span>,</span><br><span class="line">    <span class="number">0x92CC25F6240A7A19</span>, <span class="number">0x2DA210592DCCFF78</span></span><br><span class="line">]</span><br><span class="line">r = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> result:</span><br><span class="line">    r += struct.pack(<span class="string">&#x27;&lt;Q&#x27;</span>, i)</span><br><span class="line">result = <span class="built_in">list</span>(r)</span><br><span class="line"></span><br><span class="line">index = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> z <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            new = result[<span class="number">8</span> * j + ((k + <span class="number">1</span>) % <span class="number">8</span>)]</span><br><span class="line">            input_char = result[<span class="number">8</span> * j + k]</span><br><span class="line">            gen_num = data[index]</span><br><span class="line">            index += <span class="number">1</span></span><br><span class="line">            corp_num = add(gen_num, input_char)</span><br><span class="line">            a_num = array[corp_num]</span><br><span class="line">            shift_num = add(a_num, new)</span><br><span class="line">            shift_num = (shift_num &gt;&gt; <span class="number">7</span>) | ((shift_num &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xFF</span>)</span><br><span class="line">            result[<span class="number">8</span> * j + ((k + <span class="number">1</span>) % <span class="number">8</span>)] = shift_num</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)):</span><br><span class="line">    num2 = result[i] &amp; <span class="number">0xF</span></span><br><span class="line">    num1 = result[i] &gt;&gt; <span class="number">4</span></span><br><span class="line">    num1 = change(num1)</span><br><span class="line">    num2 = change(num2)</span><br><span class="line">    num2 = charset.index(num2)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">if</span> num2 == (num1 + <span class="number">3</span> * j) % <span class="number">16</span>:</span><br><span class="line">            flag += <span class="built_in">hex</span>(j)[<span class="number">2</span>:]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="Blast"><a href="#Blast" class="headerlink" title="Blast"></a>Blast</h2><h3 id="去混淆-1"><a href="#去混淆-1" class="headerlink" title="去混淆"></a>去混淆</h3><p>对于这样的混淆，python脚本去掉一下：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230904154409708.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">patch</span>(<span class="params">start, end</span>):</span><br><span class="line">	i = start</span><br><span class="line">	<span class="keyword">while</span> i &lt; end:</span><br><span class="line">		<span class="keyword">if</span> GetMnem(i) == <span class="string">&#x27;jnz&#x27;</span> <span class="keyword">and</span> GetMnem(i + <span class="number">6</span>) == <span class="string">&#x27;jmp&#x27;</span> <span class="keyword">and</span> GetOpnd(i + <span class="number">0xb</span>, <span class="number">0</span>) == <span class="string">&#x27;$+5&#x27;</span> <span class="keyword">and</span> GetMnem(i + <span class="number">0xb</span>) == <span class="string">&#x27;jmp&#x27;</span>:</span><br><span class="line">			<span class="built_in">print</span>(<span class="built_in">hex</span>(i))</span><br><span class="line">			<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i, i + <span class="number">0x10</span>):</span><br><span class="line">				PatchByte(j, <span class="number">0x90</span>)</span><br><span class="line">				i += <span class="number">0xf</span></span><br><span class="line">		i += <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> seg <span class="keyword">in</span> Segments():</span><br><span class="line">	<span class="keyword">if</span> SegName(seg) == <span class="string">&#x27;.text&#x27;</span>:</span><br><span class="line">		patch(seg, <span class="number">0x40B7E4</span>)</span><br></pre></td></tr></table></figure>

<h3 id="主要逻辑"><a href="#主要逻辑" class="headerlink" title="主要逻辑"></a>主要逻辑</h3><p>Findcrypt发现md5特征，都在一个函数中：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230904154646217.png"></p>
<p>主逻辑通过动调猜测是md5，且是单个字符的md5：</p>
<p>init_key函数就是上面的md5特征的函数。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230904154836442.png"></p>
<p>这里估计是双重md5：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230904155044648.png"></p>
<p>最后和一堆md5值进行比较：</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230904155209395.png"></p>
<h3 id="exp-5"><a href="#exp-5" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算字符串的 MD5 散列值</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_md5_string</span>(<span class="params">input_string</span>):</span><br><span class="line">    md5_hash = hashlib.md5()</span><br><span class="line">    md5_hash.update(input_string.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> md5_hash.hexdigest()</span><br><span class="line">md5 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>, <span class="number">128</span>):</span><br><span class="line">    md5_str = calculate_md5_string(calculate_md5_string(<span class="built_in">chr</span>(i)))</span><br><span class="line">    md5.append(md5_str)</span><br><span class="line">result = [</span><br><span class="line">    <span class="string">&#x27;14d89c38cd0fb23a14be2798d449c182&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a94837b18f8f43f29448b40a6e7386ba&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;af85d512594fc84a5c65ec9970956ea5&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;af85d512594fc84a5c65ec9970956ea5&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;10e21da237a4a1491e769df6f4c3b419&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a705e8280082f93f07e3486636f3827a&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;297e7ca127d2eef674c119331fe30dff&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;b5d2099e49bdb07b8176dff5e23b3c14&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;83be264eb452fcf0a1c322f2c7cbf987&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a94837b18f8f43f29448b40a6e7386ba&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;71b0438bf46aa26928c7f5a371d619e1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a705e8280082f93f07e3486636f3827a&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;ac49073a7165f41c57eb2c1806a7092e&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a94837b18f8f43f29448b40a6e7386ba&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;af85d512594fc84a5c65ec9970956ea5&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;ed108f6919ebadc8e809f8b86ef40b05&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;10e21da237a4a1491e769df6f4c3b419&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;3cfd436919bc3107d68b912ee647f341&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a705e8280082f93f07e3486636f3827a&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;65c162f7c43612ba1bdf4d0f2912bbc0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;10e21da237a4a1491e769df6f4c3b419&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a705e8280082f93f07e3486636f3827a&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;3cfd436919bc3107d68b912ee647f341&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;557460d317ae874c924e9be336a83cbe&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a705e8280082f93f07e3486636f3827a&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;9203d8a26e241e63e4b35b3527440998&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;10e21da237a4a1491e769df6f4c3b419&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;f91b2663febba8a884487f7de5e1d249&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a705e8280082f93f07e3486636f3827a&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;d7afde3e7059cd0a0fe09eec4b0008cd&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;488c428cd4a8d916deee7c1613c8b2fd&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;39abe4bca904bca5a11121955a2996bf&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a705e8280082f93f07e3486636f3827a&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;3cfd436919bc3107d68b912ee647f341&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;39abe4bca904bca5a11121955a2996bf&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4e44f1ac85cd60e3caa56bfd4afb675e&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;45cf8ddfae1d78741d8f1c622689e4af&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;3cfd436919bc3107d68b912ee647f341&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;39abe4bca904bca5a11121955a2996bf&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4e44f1ac85cd60e3caa56bfd4afb675e&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;37327bb06c83cb29cefde1963ea588aa&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a705e8280082f93f07e3486636f3827a&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;23e65a679105b85c5dc7034fded4fb5f&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;10e21da237a4a1491e769df6f4c3b419&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;71b0438bf46aa26928c7f5a371d619e1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;af85d512594fc84a5c65ec9970956ea5&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;39abe4bca904bca5a11121955a2996bf&#x27;</span>,</span><br><span class="line">]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(md5)):</span><br><span class="line">        <span class="keyword">if</span> result[i] == md5[j]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(j + <span class="number">30</span>), end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="CSGO"><a href="#CSGO" class="headerlink" title="CSGO"></a>CSGO</h2><p>动调发现是换表base64.</p>
<p><img src="/2023/11/21/CTF-wp-1/3.png"></p>
<p><img src="/2023/11/21/CTF-wp-1/2.png"></p>
<p><img src="/2023/11/21/CTF-wp-1/123.png"></p>
<h2 id="vm-wo"><a href="#vm-wo" class="headerlink" title="vm_wo"></a>vm_wo</h2><p>根据指令码解释一下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 26 0 input    body[0] = input</span><br><span class="line"># 25 1 1        body[1] = body[0] &gt;&gt; 1</span><br><span class="line"># 13 2 7        body[2] = body[0] &lt;&lt; 7</span><br><span class="line"># 24 1 2        body[0] = body[1] | body[2]</span><br><span class="line"># 1 0 3         body[0] = body[0] ^ body[3]</span><br><span class="line"># 26 0 body[0]  body[0] = body[0]</span><br><span class="line"># 25 1 2        body[1] = body[0] &gt;&gt; 2</span><br><span class="line"># 13 2 6        body[2] = body[0] &lt;&lt; 6</span><br><span class="line"># 24 1 2        body[0] = body[1] | body[2]</span><br><span class="line"># 1 0 4         body[0] = body[0] ^ body[4]</span><br><span class="line"># 26 0 body[0]  body[0] = body[0]</span><br><span class="line"># 25 1 3        body[1] = body[0] &gt;&gt; 3</span><br><span class="line"># 13 2 5        body[2] = body[0] &lt;&lt; 5</span><br><span class="line"># 24 1 2        body[0] = body[1] | body[2]</span><br><span class="line"># 1 0 5         body[0] = body[0] ^ body[5]</span><br><span class="line"># 26 0 body[0]  body[0] = body[0]</span><br><span class="line"># 25 1 4        body[1] = body[0] &gt;&gt; 4</span><br><span class="line"># 13 2 4        body[2] = body[0] &lt;&lt; 4</span><br><span class="line"># 24 1 2        body[0] = body[1] | body[2]</span><br><span class="line"># 1 0 6         body[0] = body[0] ^ body[6]</span><br></pre></td></tr></table></figure>

<h3 id="exp-6"><a href="#exp-6" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">result = [<span class="number">0xDF</span>, <span class="number">0xD5</span>, <span class="number">0xF1</span>, <span class="number">0xD1</span>, <span class="number">0xFF</span>, <span class="number">0xDB</span>, <span class="number">0xA1</span>, <span class="number">0xA5</span>, <span class="number">0x89</span>, <span class="number">0xBD</span>, <span class="number">0xE9</span>, <span class="number">0x95</span>, <span class="number">0xB3</span>, <span class="number">0x9D</span>, <span class="number">0xE9</span>, <span class="number">0xB3</span>, <span class="number">0x85</span>, <span class="number">0x99</span>, <span class="number">0x87</span>, <span class="number">0xBF</span>, <span class="number">0xE9</span>, <span class="number">0xB1</span>, <span class="number">0x89</span>, <span class="number">0xE9</span>, <span class="number">0x91</span>, <span class="number">0x89</span>, <span class="number">0x89</span>, <span class="number">0x8F</span>, <span class="number">0xAD</span>]</span><br><span class="line">key = struct.pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0xBEEDBEEF</span>)</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)):</span><br><span class="line">    num = result[i]</span><br><span class="line">    num = (num &gt;&gt; <span class="number">3</span>) | ((num &lt;&lt; <span class="number">5</span>) &amp; <span class="number">0xFF</span>)</span><br><span class="line">    num ^= key[<span class="number">3</span>]</span><br><span class="line">    num = (num &gt;&gt; <span class="number">4</span>) | ((num &lt;&lt; <span class="number">4</span>) &amp; <span class="number">0xFF</span>)</span><br><span class="line">    num ^= key[<span class="number">2</span>]</span><br><span class="line">    num = (num &gt;&gt; <span class="number">5</span>) | ((num &lt;&lt; <span class="number">3</span>) &amp; <span class="number">0xFF</span>)</span><br><span class="line">    num ^= key[<span class="number">1</span>]</span><br><span class="line">    num = (num &gt;&gt; <span class="number">6</span>) | ((num &lt;&lt; <span class="number">2</span>) &amp; <span class="number">0xFF</span>)</span><br><span class="line">    num ^= key[<span class="number">0</span>]</span><br><span class="line">    num = (num &gt;&gt; <span class="number">7</span>) | ((num &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xFF</span>)</span><br><span class="line">    result[i] = num</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytearray</span>(result))</span><br></pre></td></tr></table></figure>

<h2 id="Ez加密器"><a href="#Ez加密器" class="headerlink" title="Ez加密器"></a>Ez加密器</h2><h3 id="去混淆-2"><a href="#去混淆-2" class="headerlink" title="去混淆"></a>去混淆</h3><h4 id="代码1"><a href="#代码1" class="headerlink" title="代码1"></a>代码1</h4><p>a &#x3D; a + b</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">args: a, b</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">    t = a &amp; b;</span><br><span class="line">    a ^= b;</span><br><span class="line">    b = <span class="number">2</span> * t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> ( <span class="number">2</span> * t );</span><br></pre></td></tr></table></figure>

<p>对应汇编：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">loc_7FF73D0A1AF8:</span><br><span class="line">mov     ebp, ecx</span><br><span class="line">and     ebp, eax</span><br><span class="line">xor     eax, ecx</span><br><span class="line">mov     ecx, ebp</span><br><span class="line">add     ecx, ecx  // add：如果加法结果为0，更改zf寄存器为1</span><br><span class="line">jnz     short loc_7FF73D0A1AF8</span><br></pre></td></tr></table></figure>

<p>可简化为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add		eax, ecx</span><br></pre></td></tr></table></figure>

<h4 id="代码2"><a href="#代码2" class="headerlink" title="代码2"></a>代码2</h4><p>eax &#x3D; ~(eax % 8)</p>
<p>汇编：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// eax = eax % 8</span><br><span class="line">mov     ecx, eax</span><br><span class="line">sar     ecx, 1Fh</span><br><span class="line">shr     ecx, 1Dh</span><br><span class="line">add     eax, ecx</span><br><span class="line">and     eax, 7</span><br><span class="line">sub     eax, ecx</span><br><span class="line"></span><br><span class="line">// eax = ~eax</span><br><span class="line">not     eax</span><br></pre></td></tr></table></figure>

<h4 id="代码3"><a href="#代码3" class="headerlink" title="代码3"></a>代码3</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">args: v10</span><br><span class="line"></span><br><span class="line">v9 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">do</span> <span class="comment">// v10 = v10 + v9</span></span><br><span class="line">&#123;</span><br><span class="line">    v11 = v9;</span><br><span class="line">    v12 = v10;</span><br><span class="line">    v13 = v9 &amp; v10;</span><br><span class="line">    v10 ^= v11;</span><br><span class="line">    v9 = <span class="number">2</span> * v13;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> ( v9 );</span><br><span class="line">v14 = <span class="number">7</span>;</span><br><span class="line"><span class="keyword">if</span> ( v12 != v11 ) <span class="comment">// 即 上面循环结果 v10 != 0</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">do</span> <span class="comment">// v14 = v14 + v10</span></span><br><span class="line">    &#123;</span><br><span class="line">        v15 = v14 &amp; v10;</span><br><span class="line">        v14 ^= v10;</span><br><span class="line">        v10 = <span class="number">2</span> * v15;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">2</span> * v15 );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>汇编：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">loc_7FF7F3181B28:              </span><br><span class="line">mov     r12d, ecx</span><br><span class="line">mov     ecx, eax</span><br><span class="line">mov     r13d, eax</span><br><span class="line">and     ecx, r12d</span><br><span class="line">xor     eax, r12d</span><br><span class="line">add     ecx, ecx</span><br><span class="line">jnz     short loc_7FF7F3181B28</span><br><span class="line">mov     ecx, 7</span><br><span class="line">cmp     r13d, r12d</span><br><span class="line">jz      short loc_7FF7F3181B57</span><br><span class="line">nop     dword ptr [rax+00h]</span><br><span class="line">loc_7FF7F3181B48:              </span><br><span class="line">mov     r12d, eax</span><br><span class="line">and     r12d, ecx</span><br><span class="line">xor     ecx, eax</span><br><span class="line">mov     eax, r12d</span><br><span class="line">add     eax, eax</span><br><span class="line">jnz     short loc_7FF7F3181B48</span><br><span class="line">loc_7FF7F3181B57:</span><br><span class="line">xxxxxx</span><br></pre></td></tr></table></figure>

<p>可转化为：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">args: v10, v9, v14</span><br><span class="line"><span class="keyword">if</span> v10 + v9 != <span class="number">0</span>:</span><br><span class="line">	v14 = v14 + v10 + v9</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	v14 = v14</span><br></pre></td></tr></table></figure>

<p>汇编：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">add     eax, ecx</span><br><span class="line">mov     ecx, 7</span><br><span class="line">cmp     eax, 0</span><br><span class="line">jz      short loc_7FF73D0A1B57</span><br><span class="line">add     ecx, eax</span><br><span class="line">loc_7FF73D0A1B57:</span><br><span class="line">xxxxxx</span><br></pre></td></tr></table></figure>

<h4 id="代码4"><a href="#代码4" class="headerlink" title="代码4"></a>代码4</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">args: v17</span><br><span class="line">v16 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">do</span> <span class="comment">// v17 = v17 + v16</span></span><br><span class="line">&#123;</span><br><span class="line">    v19 = v16;</span><br><span class="line">    v20 = v17 &amp; v16;</span><br><span class="line">    v21 = v17;</span><br><span class="line">    v17 ^= v19;</span><br><span class="line">    v16 = <span class="number">2</span> * v20;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> ( v16 );</span><br><span class="line"><span class="keyword">if</span> ( v19 == v21 ) <span class="comment">// v17 == 0</span></span><br><span class="line">&#123;</span><br><span class="line">    LOBYTE(v24) = <span class="number">0x80</span>; <span class="comment">// v24 = 1 &lt;&lt; 7</span></span><br><span class="line">    				  <span class="comment">// 也是：v24 = 1 &lt;&lt; (7 + 1 + v17)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    v22 = <span class="number">7</span>;</span><br><span class="line">    <span class="keyword">do</span> <span class="comment">// v22 = v22 + v17</span></span><br><span class="line">    &#123;</span><br><span class="line">        v23 = v22 &amp; v17;</span><br><span class="line">        v22 ^= v17;</span><br><span class="line">        v17 = <span class="number">2</span> * v23;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">2</span> * v23 );</span><br><span class="line">    v24 = <span class="number">1</span> &lt;&lt; v22; <span class="comment">// v24 = 1 &lt;&lt; (7 + 1 + v17)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可转化为：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v24 = <span class="number">1</span> &lt;&lt; (<span class="number">7</span> + <span class="number">1</span> + v17)</span><br></pre></td></tr></table></figure>

<h4 id="代码5"><a href="#代码5" class="headerlink" title="代码5"></a>代码5</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~(a % <span class="number">8</span>) + <span class="number">1</span> 等于 -(a &amp; <span class="number">8</span>)</span><br></pre></td></tr></table></figure>

<h4 id="脚本去混淆"><a href="#脚本去混淆" class="headerlink" title="脚本去混淆"></a>脚本去混淆</h4><p>对单个函数的以上混淆去掉。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keystone <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_asm</span>(<span class="params">code</span>):</span><br><span class="line">    ks = Ks(KS_ARCH_X86, KS_MODE_64)</span><br><span class="line">    asm, cnt = ks.asm(code)</span><br><span class="line">    <span class="keyword">return</span> asm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">addr, add_bias, jnz_bias</span>):</span><br><span class="line">    add_num = GetOpnd(addr + add_bias, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, add_bias):</span><br><span class="line">        <span class="keyword">if</span> GetMnem(addr + i) == <span class="string">&quot;xor&quot;</span>:</span><br><span class="line">            result = GetOpnd(addr + i, <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> add_num <span class="keyword">and</span> result:</span><br><span class="line">        Jump(addr)</span><br><span class="line">        mnem = <span class="string">f&quot;add <span class="subst">&#123;result&#125;</span>, <span class="subst">&#123;add_num&#125;</span>&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(mnem)</span><br><span class="line">        asm = get_asm(mnem)</span><br><span class="line">        <span class="built_in">print</span>(asm)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm)):</span><br><span class="line">            PatchByte(addr + i, asm[i])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm), jnz_bias + <span class="number">2</span>):</span><br><span class="line">            PatchByte(addr + i, <span class="number">0x90</span>)</span><br><span class="line">        <span class="keyword">if</span> GetMnem(addr + jnz_bias + <span class="number">2</span>) == <span class="string">&quot;cmp&quot;</span>:</span><br><span class="line">            cmp_bias = jnz_bias + <span class="number">2</span></span><br><span class="line">            mnem = <span class="string">f&quot;cmp <span class="subst">&#123;result&#125;</span>,0&quot;</span></span><br><span class="line">            <span class="built_in">print</span>(mnem)</span><br><span class="line">            asm = get_asm(mnem)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;[<span class="built_in">hex</span>(_) <span class="keyword">for</span> _ <span class="keyword">in</span> asm]&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;idaapi.get_item_size(addr + cmp_bias) == <span class="built_in">len</span>(asm)&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(asm) == idaapi.get_item_size(addr + cmp_bias):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;hahahahahahahh&quot;</span>)</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm)):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;patch&quot;</span>)</span><br><span class="line">                    PatchByte(addr + cmp_bias + i, asm[i])</span><br><span class="line">            <span class="keyword">elif</span> <span class="built_in">len</span>(asm) &lt; idaapi.get_item_size(addr + cmp_bias):</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm)):</span><br><span class="line">                    PatchByte(addr + cmp_bias + i, asm[i])</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm), idaapi.get_item_size(addr + cmp_bias)):</span><br><span class="line">                    PatchByte(addr + cmp_bias + i, <span class="number">0x90</span>)</span><br><span class="line">            <span class="keyword">elif</span> <span class="built_in">len</span>(asm) &gt; idaapi.get_item_size(addr + cmp_bias):</span><br><span class="line">                cmp_len = idaapi.get_item_size(addr + cmp_bias)</span><br><span class="line">                code1_len = idaapi.get_item_size(addr + cmp_bias + cmp_len)</span><br><span class="line">                code2_len = idaapi.get_item_size(addr + cmp_bias + cmp_len + code1_len)</span><br><span class="line">                <span class="keyword">if</span> GetMnem(addr + cmp_bias + cmp_len) == <span class="string">&quot;nop&quot;</span>:</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm)):</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, asm[i])</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm), cmp_len + code1_len):</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, <span class="number">0x90</span>)</span><br><span class="line">                <span class="keyword">elif</span> GetMnem(addr + cmp_bias + cmp_len + code1_len) == <span class="string">&quot;nop&quot;</span>:</span><br><span class="line">                    <span class="keyword">if</span> GetMnem(addr + cmp_bias + cmp_len) == <span class="string">&quot;jz&quot;</span>:</span><br><span class="line">                        <span class="keyword">if</span> code1_len == <span class="number">6</span>:</span><br><span class="line">                            ori_jmp = Dword(addr + cmp_bias + cmp_len + <span class="number">2</span>)</span><br><span class="line">                            new_jmp = ori_jmp - code2_len</span><br><span class="line">                            jmp_data = struct.pack(<span class="string">&#x27;&lt;I&#x27;</span>, new_jmp)</span><br><span class="line">                            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(jmp_data)):</span><br><span class="line">                                PatchByte(addr + cmp_bias + cmp_len + <span class="number">2</span> + i, jmp_data[i])</span><br><span class="line">                        <span class="keyword">elif</span> code1_len == <span class="number">2</span>:</span><br><span class="line">                            ori_jmp = Byte(addr + cmp_bias + cmp_len + <span class="number">1</span>)</span><br><span class="line">                            new_jmp = ori_jmp - code2_len</span><br><span class="line">                            PatchByte(addr + cmp_bias + cmp_len + <span class="number">1</span>, new_jmp)</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cmp_len + code1_len, cmp_len + code1_len + code2_len):</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, <span class="number">0x90</span>)</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cmp_len + code1_len + code2_len - <span class="number">1</span>, cmp_len + code2_len - <span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, Byte(addr + cmp_bias + i - code2_len))</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm)):</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, asm[i])</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm), cmp_len + code2_len):</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, <span class="number">0x90</span>)</span><br><span class="line">                <span class="keyword">elif</span> GetMnem(addr + cmp_bias + cmp_len + code1_len + code2_len) == <span class="string">&quot;nop&quot;</span>:</span><br><span class="line">                    code3_len = idaapi.get_item_size(addr + cmp_bias + cmp_len + code1_len + code2_len)</span><br><span class="line">                    <span class="keyword">if</span> GetMnem(addr + cmp_bias + cmp_len) == <span class="string">&quot;jz&quot;</span>:</span><br><span class="line">                        <span class="keyword">if</span> code1_len == <span class="number">6</span>:</span><br><span class="line">                            ori_jmp = Dword(addr + cmp_bias + cmp_len + <span class="number">2</span>)</span><br><span class="line">                            new_jmp = ori_jmp - code3_len</span><br><span class="line">                            jmp_data = struct.pack(<span class="string">&#x27;&lt;I&#x27;</span>, new_jmp)</span><br><span class="line">                            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(jmp_data)):</span><br><span class="line">                                PatchByte(addr + cmp_bias + cmp_len + <span class="number">2</span> + i, jmp_data[i])</span><br><span class="line">                        <span class="keyword">elif</span> code1_len == <span class="number">2</span>:</span><br><span class="line">                            ori_jmp = Byte(addr + cmp_bias + cmp_len + <span class="number">1</span>)</span><br><span class="line">                            new_jmp = ori_jmp - code3_len</span><br><span class="line">                            PatchByte(addr + cmp_bias + cmp_len + <span class="number">1</span>, new_jmp)</span><br><span class="line">                    <span class="keyword">elif</span> GetMnem(addr + cmp_bias + cmp_len + code1_len) == <span class="string">&quot;jz&quot;</span>:</span><br><span class="line">                        <span class="keyword">if</span> code2_len == <span class="number">6</span>:</span><br><span class="line">                            ori_jmp = Dword(addr + cmp_bias + cmp_len + code1_len + <span class="number">2</span>)</span><br><span class="line">                            new_jmp = ori_jmp - code3_len</span><br><span class="line">                            jmp_data = struct.pack(<span class="string">&#x27;&lt;I&#x27;</span>, new_jmp)</span><br><span class="line">                            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(jmp_data)):</span><br><span class="line">                                PatchByte(addr + cmp_bias + cmp_len + code1_len + <span class="number">2</span> + i, jmp_data[i])</span><br><span class="line">                        <span class="keyword">elif</span> code2_len == <span class="number">2</span>:</span><br><span class="line">                            ori_jmp = Byte(addr + cmp_bias + cmp_len + code1_len + <span class="number">1</span>)</span><br><span class="line">                            new_jmp = ori_jmp - code3_len</span><br><span class="line">                            PatchByte(addr + cmp_bias + cmp_len + code1_len + <span class="number">1</span>, new_jmp)</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cmp_len + code1_len + code2_len, cmp_len + code1_len + code2_len + code3_len):</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, <span class="number">0x90</span>)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;nop <span class="subst">&#123;<span class="built_in">hex</span>(addr + cmp_bias + i)&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cmp_len + code1_len + code2_len + code3_len - <span class="number">1</span>, cmp_len + code3_len - <span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">                        <span class="built_in">print</span>(</span><br><span class="line">                            <span class="string">f&quot;<span class="subst">&#123;<span class="built_in">hex</span>(addr + cmp_bias + i - code3_len)&#125;</span>:<span class="subst">&#123;Byte(addr + cmp_bias + i - code3_len)&#125;</span> -&gt; <span class="subst">&#123;<span class="built_in">hex</span>(addr + cmp_bias + i)&#125;</span>:<span class="subst">&#123;Byte(addr + cmp_bias + i)&#125;</span>&quot;</span>)</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, Byte(addr + cmp_bias + i - code3_len))</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm)):</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;asm[i]&#125;</span> -&gt; <span class="subst">&#123;<span class="built_in">hex</span>(addr + cmp_bias + i)&#125;</span>:<span class="subst">&#123;Byte(addr + cmp_bias + i)&#125;</span>&quot;</span>)</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, asm[i])</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm), cmp_len + code3_len):</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;nop <span class="subst">&#123;<span class="built_in">hex</span>(addr + cmp_bias + i)&#125;</span>&quot;</span>)</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, <span class="number">0x90</span>)</span><br><span class="line">        <span class="keyword">elif</span> GetMnem(addr + jnz_bias + <span class="number">7</span>) == <span class="string">&quot;cmp&quot;</span>:</span><br><span class="line">            cmp_bias = jnz_bias + <span class="number">7</span></span><br><span class="line">            mnem = <span class="string">f&quot;cmp <span class="subst">&#123;result&#125;</span>,0&quot;</span></span><br><span class="line">            <span class="built_in">print</span>(mnem)</span><br><span class="line">            asm = get_asm(mnem)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(asm) == idaapi.get_item_size(addr + cmp_bias):</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm)):</span><br><span class="line">                    PatchByte(addr + cmp_bias + i, asm[i])</span><br><span class="line">            <span class="keyword">elif</span> <span class="built_in">len</span>(asm) &lt; idaapi.get_item_size(addr + cmp_bias):</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm)):</span><br><span class="line">                    PatchByte(addr + cmp_bias + i, asm[i])</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm), idaapi.get_item_size(addr + cmp_bias)):</span><br><span class="line">                    PatchByte(addr + cmp_bias + i, <span class="number">0x90</span>)</span><br><span class="line">            <span class="keyword">elif</span> <span class="built_in">len</span>(asm) &gt; idaapi.get_item_size(addr + cmp_bias):</span><br><span class="line">                cmp_len = idaapi.get_item_size(addr + cmp_bias)</span><br><span class="line">                code1_len = idaapi.get_item_size(addr + cmp_bias + cmp_len)</span><br><span class="line">                code2_len = idaapi.get_item_size(addr + cmp_bias + cmp_len + code1_len)</span><br><span class="line">                <span class="keyword">if</span> GetMnem(addr + cmp_bias + cmp_len) == <span class="string">&quot;nop&quot;</span>:</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm)):</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, asm[i])</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm), cmp_len + code1_len):</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, <span class="number">0x90</span>)</span><br><span class="line">                <span class="keyword">elif</span> GetMnem(addr + cmp_bias + cmp_len + code1_len) == <span class="string">&quot;nop&quot;</span>:</span><br><span class="line">                    <span class="keyword">if</span> GetMnem(addr + cmp_bias + cmp_len) == <span class="string">&quot;jz&quot;</span>:</span><br><span class="line">                        <span class="keyword">if</span> code1_len == <span class="number">6</span>:</span><br><span class="line">                            ori_jmp = Dword(addr + cmp_bias + cmp_len + <span class="number">2</span>)</span><br><span class="line">                            new_jmp = ori_jmp - code2_len</span><br><span class="line">                            jmp_data = struct.pack(<span class="string">&#x27;&lt;I&#x27;</span>, new_jmp)</span><br><span class="line">                            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(jmp_data)):</span><br><span class="line">                                PatchByte(addr + cmp_bias + cmp_len + <span class="number">2</span> + i, jmp_data[i])</span><br><span class="line">                        <span class="keyword">elif</span> code1_len == <span class="number">2</span>:</span><br><span class="line">                            ori_jmp = Byte(addr + cmp_bias + cmp_len + <span class="number">1</span>)</span><br><span class="line">                            new_jmp = ori_jmp - code2_len</span><br><span class="line">                            PatchByte(addr + cmp_bias + cmp_len + <span class="number">1</span>, new_jmp)</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cmp_len + code1_len, cmp_len + code1_len + code2_len):</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, <span class="number">0x90</span>)</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cmp_len + code1_len + code2_len - <span class="number">1</span>, cmp_len + code2_len - <span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, Byte(addr + cmp_bias + i - code2_len))</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm)):</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, asm[i])</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm), cmp_len + code2_len):</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, <span class="number">0x90</span>)</span><br><span class="line">                <span class="keyword">elif</span> GetMnem(addr + cmp_bias + cmp_len + code1_len + code2_len) == <span class="string">&quot;nop&quot;</span>:</span><br><span class="line">                    code3_len = idaapi.get_item_size(addr + cmp_bias + cmp_len + code1_len + code2_len)</span><br><span class="line">                    <span class="keyword">if</span> GetMnem(addr + cmp_bias + cmp_len) == <span class="string">&quot;jz&quot;</span>:</span><br><span class="line">                        <span class="keyword">if</span> code1_len == <span class="number">6</span>:</span><br><span class="line">                            ori_jmp = Dword(addr + cmp_bias + cmp_len + <span class="number">2</span>)</span><br><span class="line">                            new_jmp = ori_jmp - code3_len</span><br><span class="line">                            jmp_data = struct.pack(<span class="string">&#x27;&lt;I&#x27;</span>, new_jmp)</span><br><span class="line">                            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(jmp_data)):</span><br><span class="line">                                PatchByte(addr + cmp_bias + cmp_len + <span class="number">2</span> + i, jmp_data[i])</span><br><span class="line">                        <span class="keyword">elif</span> code1_len == <span class="number">2</span>:</span><br><span class="line">                            ori_jmp = Byte(addr + cmp_bias + cmp_len + <span class="number">1</span>)</span><br><span class="line">                            new_jmp = ori_jmp - code3_len</span><br><span class="line">                            PatchByte(addr + cmp_bias + cmp_len + <span class="number">1</span>, new_jmp)</span><br><span class="line">                    <span class="keyword">elif</span> GetMnem(addr + cmp_bias + cmp_len + code1_len) == <span class="string">&quot;jz&quot;</span>:</span><br><span class="line">                        <span class="keyword">if</span> code2_len == <span class="number">6</span>:</span><br><span class="line">                            ori_jmp = Dword(addr + cmp_bias + cmp_len + code1_len + <span class="number">2</span>)</span><br><span class="line">                            new_jmp = ori_jmp - code3_len</span><br><span class="line">                            jmp_data = struct.pack(<span class="string">&#x27;&lt;I&#x27;</span>, new_jmp)</span><br><span class="line">                            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(jmp_data)):</span><br><span class="line">                                PatchByte(addr + cmp_bias + cmp_len + code1_len + <span class="number">2</span> + i, jmp_data[i])</span><br><span class="line">                        <span class="keyword">elif</span> code2_len == <span class="number">2</span>:</span><br><span class="line">                            ori_jmp = Byte(addr + cmp_bias + cmp_len + code1_len + <span class="number">1</span>)</span><br><span class="line">                            new_jmp = ori_jmp - code3_len</span><br><span class="line">                            PatchByte(addr + cmp_bias + cmp_len + code1_len + <span class="number">1</span>, new_jmp)</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cmp_len + code1_len + code2_len, cmp_len + code1_len + code2_len + code3_len):</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, <span class="number">0x90</span>)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;nop <span class="subst">&#123;<span class="built_in">hex</span>(addr + cmp_bias + i)&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cmp_len + code1_len + code2_len + code3_len - <span class="number">1</span>, cmp_len + code3_len - <span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">                        <span class="built_in">print</span>(</span><br><span class="line">                            <span class="string">f&quot;<span class="subst">&#123;<span class="built_in">hex</span>(addr + cmp_bias + i - code3_len)&#125;</span>:<span class="subst">&#123;Byte(addr + cmp_bias + i - code3_len)&#125;</span> -&gt; <span class="subst">&#123;<span class="built_in">hex</span>(addr + cmp_bias + i)&#125;</span>:<span class="subst">&#123;Byte(addr + cmp_bias + i)&#125;</span>&quot;</span>)</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, Byte(addr + cmp_bias + i - code3_len))</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm)):</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;asm[i]&#125;</span> -&gt; <span class="subst">&#123;<span class="built_in">hex</span>(addr + cmp_bias + i)&#125;</span>:<span class="subst">&#123;Byte(addr + cmp_bias + i)&#125;</span>&quot;</span>)</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, asm[i])</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(asm), cmp_len + code3_len):</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;nop <span class="subst">&#123;<span class="built_in">hex</span>(addr + cmp_bias + i)&#125;</span>&quot;</span>)</span><br><span class="line">                        PatchByte(addr + cmp_bias + i, <span class="number">0x90</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">seg_addr = idc.here()</span><br><span class="line">fun_start = idc.get_func_off_str(seg_addr)</span><br><span class="line"><span class="comment"># print(fun_start)</span></span><br><span class="line">fun_start = seg_addr - <span class="built_in">int</span>(fun_start.split(<span class="string">&quot;+&quot;</span>)[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line"><span class="comment"># fun_start = int(re.search(r&#x27;sub_(\w+):&#x27;, fun_start)[1],16)</span></span><br><span class="line">fun_end = idc.find_func_end(seg_addr)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(fun_start), <span class="built_in">hex</span>(fun_end))</span><br><span class="line"><span class="keyword">for</span> addr <span class="keyword">in</span> <span class="built_in">range</span>(fun_start, fun_end):</span><br><span class="line">    <span class="keyword">if</span> GetMnem(addr + <span class="number">0xb</span>) == <span class="string">&quot;add&quot;</span> <span class="keyword">and</span> GetMnem(addr + <span class="number">0xd</span>) == <span class="string">&quot;jnz&quot;</span> <span class="keyword">and</span> GetMnem(addr) == <span class="string">&quot;mov&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(addr))</span><br><span class="line">        handle(addr, <span class="number">0xb</span>, <span class="number">0xd</span>)</span><br><span class="line">    <span class="keyword">elif</span> GetMnem(addr + <span class="number">0x9</span>) == <span class="string">&quot;add&quot;</span> <span class="keyword">and</span> GetMnem(addr + <span class="number">0xb</span>) == <span class="string">&quot;jnz&quot;</span> <span class="keyword">and</span> GetMnem(addr) == <span class="string">&quot;mov&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(addr))</span><br><span class="line">        handle(addr, <span class="number">0x9</span>, <span class="number">0xb</span>)</span><br><span class="line">    <span class="keyword">elif</span> GetMnem(addr + <span class="number">0x8</span>) == <span class="string">&quot;add&quot;</span> <span class="keyword">and</span> GetMnem(addr + <span class="number">0xa</span>) == <span class="string">&quot;jnz&quot;</span> <span class="keyword">and</span> GetMnem(addr) == <span class="string">&quot;mov&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(addr))</span><br><span class="line">        handle(addr, <span class="number">0x8</span>, <span class="number">0xa</span>)</span><br><span class="line">    <span class="keyword">elif</span> GetMnem(addr + <span class="number">0x8</span>) == <span class="string">&quot;add&quot;</span> <span class="keyword">and</span> GetMnem(addr + <span class="number">0xd</span>) == <span class="string">&quot;jnz&quot;</span> <span class="keyword">and</span> GetMnem(addr) == <span class="string">&quot;mov&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(addr))</span><br><span class="line">        handle(addr, <span class="number">0x8</span>, <span class="number">0xd</span>)</span><br><span class="line">    <span class="keyword">elif</span> GetMnem(addr + <span class="number">0x6</span>) == <span class="string">&quot;add&quot;</span> <span class="keyword">and</span> GetMnem(addr + <span class="number">0xa</span>) == <span class="string">&quot;jnz&quot;</span> <span class="keyword">and</span> GetMnem(addr) == <span class="string">&quot;mov&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(addr))</span><br><span class="line">        handle(addr, <span class="number">0x6</span>, <span class="number">0xa</span>)</span><br><span class="line">    <span class="keyword">elif</span> GetMnem(addr + <span class="number">12</span>) == <span class="string">&quot;add&quot;</span> <span class="keyword">and</span> GetMnem(addr + <span class="number">15</span>) == <span class="string">&quot;jnz&quot;</span> <span class="keyword">and</span> GetMnem(addr) == <span class="string">&quot;mov&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(addr))</span><br><span class="line">        handle(addr, <span class="number">12</span>, <span class="number">15</span>)</span><br><span class="line">    <span class="keyword">elif</span> GetMnem(addr + <span class="number">12</span>) == <span class="string">&quot;add&quot;</span> <span class="keyword">and</span> GetMnem(addr + <span class="number">14</span>) == <span class="string">&quot;jnz&quot;</span> <span class="keyword">and</span> GetMnem(addr) == <span class="string">&quot;mov&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(addr))</span><br><span class="line">        handle(addr, <span class="number">12</span>, <span class="number">14</span>)</span><br><span class="line">    <span class="keyword">elif</span> GetMnem(addr + <span class="number">10</span>) == <span class="string">&quot;add&quot;</span> <span class="keyword">and</span> GetMnem(addr + <span class="number">12</span>) == <span class="string">&quot;jnz&quot;</span> <span class="keyword">and</span> GetMnem(addr) == <span class="string">&quot;mov&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(addr))</span><br><span class="line">        handle(addr, <span class="number">10</span>, <span class="number">12</span>)</span><br></pre></td></tr></table></figure>

<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>网上大伙的wp都说是DES，但说实话除了找到数据特征是DES，以及最后对输入处理都是与和或，没看出大概DES &#x2F;(ㄒoㄒ)&#x2F;。</p>
<p><img src="/2023/11/21/CTF-wp-1/image-20230908122758787.png"></p>
<p>爆破6位code（0-999999），进行换表base64作为DES密钥。</p>
<p>这里给出网上的exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&quot;DASCTF&#123;1234567890abcdef1234567890abcdef&#125;&quot;</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">key = <span class="built_in">bytes</span>([<span class="number">0x6D</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x50</span>, <span class="number">0x6E</span>, <span class="number">0x64</span>, <span class="number">0x75</span>, <span class="number">0x53</span> ])</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">base64_encode</span>(<span class="params">data</span>):</span><br><span class="line">    oldtable=<span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span><span class="comment">#老表</span></span><br><span class="line">    newtable=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ+/&#x27;</span><span class="comment">#这里输入魔改变表</span></span><br><span class="line">    tmp = base64.b64encode(data.encode()).decode()</span><br><span class="line">    result=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> tmp:</span><br><span class="line">        result +=newtable[oldtable.index(ch)]</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment">## key = base64_encode(&quot;123456&quot;)</span></span><br><span class="line"><span class="comment">## print(key)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">1000000</span>):</span><br><span class="line">    tmp_key = <span class="built_in">str</span>(i).rjust(<span class="number">6</span>,<span class="string">&quot;0&quot;</span>)</span><br><span class="line">    tmp_key = base64_encode(tmp_key)</span><br><span class="line">    <span class="comment">#print(tmp_key)</span></span><br><span class="line">    des = DES.new(tmp_key.encode(),mode=DES.MODE_ECB)</span><br><span class="line">    c = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;0723105D5C12217DCDC3601F5ECB54DA9CCEC2279F1684A13A0D716D17217F4C9EA85FF1A42795731CA3C55D3A4D7BEA&quot;</span>)</span><br><span class="line">    m = des.decrypt(c)</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;DAS&quot;</span> <span class="keyword">in</span> m):</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://hahbiubiubiu.github.io">hahbiubiubiu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://hahbiubiubiu.github.io/2023/11/21/CTF-wp-1/">http://hahbiubiubiu.github.io/2023/11/21/CTF-wp-1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://hahbiubiubiu.github.io" target="_blank">hahbiubiubiu</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Reverse/">Reverse</a><a class="post-meta__tags" href="/tags/CTF/">CTF</a></div><div class="post_share"><div class="social-share" data-image="/./img/preview.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/11/21/CTF-wp-2/"><img class="prev-cover" src="/./img/preview.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">babyLoginPlus——bugku</div></div></a></div><div class="next-post pull-right"><a href="/2023/09/12/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/"><img class="next-cover" src="/./img/preview.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">电子取证</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/10/04/Bingo%E2%80%94%E2%80%94bugku/" title="Bingo——bugku"><img class="cover" src="/./img/preview.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-04</div><div class="title">Bingo——bugku</div></div></a></div><div><a href="/2023/06/23/DASCTF2023%E4%BA%8C%E8%BF%9B%E5%88%B6/" title="DASCTF2023二进制"><img class="cover" src="/./img/preview.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-23</div><div class="title">DASCTF2023二进制</div></div></a></div><div><a href="/2023/03/23/QExtend/" title="QExtend-300"><img class="cover" src="/./img/preview.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-23</div><div class="title">QExtend-300</div></div></a></div><div><a href="/2022/11/18/SCU2022%E6%96%B0%E7%94%9F%E8%B5%9B/" title="SCU2022新生赛"><img class="cover" src="/./img/preview.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-18</div><div class="title">SCU2022新生赛</div></div></a></div><div><a href="/2022/10/03/babyLoginPlus-bugku/" title="babyLoginPlus——bugku"><img class="cover" src="/./img/preview.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-03</div><div class="title">babyLoginPlus——bugku</div></div></a></div><div><a href="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/" title="d3ctf2023学习"><img class="cover" src="/./img/preview.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-05-07</div><div class="title">d3ctf2023学习</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/./img/Valkyrie.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">hahbiubiubiu</div><div class="author-info__description">派派玩家搞搞震</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/hahbiubiubiu"><i class="fab fa-github"></i><span>biubiaboom</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/965116991@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Hello!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023"><span class="toc-number">1.</span> <span class="toc-text">巅峰极客2023</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#g0Re"><span class="toc-number">1.1.</span> <span class="toc-text">g0Re</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%98%E5%8E%9F%E7%89%B9%E5%BE%81%E7%A0%81"><span class="toc-number">1.1.1.</span> <span class="toc-text">还原特征码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A8%8B%E5%BA%8F%E9%80%BB%E8%BE%91"><span class="toc-number">1.1.2.</span> <span class="toc-text">程序逻辑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exp"><span class="toc-number">1.1.3.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezlua"><span class="toc-number">1.2.</span> <span class="toc-text">ezlua</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A8%8B%E5%BA%8F%E9%80%BB%E8%BE%91-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">程序逻辑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E7%BC%96%E8%AF%91luajit"><span class="toc-number">1.2.2.</span> <span class="toc-text">反编译luajit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exp-1"><span class="toc-number">1.2.3.</span> <span class="toc-text">exp</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CTF2023"><span class="toc-number">2.</span> <span class="toc-text">*CTF2023</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ezcode"><span class="toc-number">2.1.</span> <span class="toc-text">ezcode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flagfile"><span class="toc-number">2.2.</span> <span class="toc-text">flagfile</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%951"><span class="toc-number">2.2.0.1.</span> <span class="toc-text">方法1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%952"><span class="toc-number">2.2.0.2.</span> <span class="toc-text">方法2</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NepCTF2023"><span class="toc-number">3.</span> <span class="toc-text">NepCTF2023</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#eeeeerte"><span class="toc-number">3.1.</span> <span class="toc-text">eeeeerte</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%98%93%E8%AF%AD%E8%A8%80%E5%8F%8D%E7%BC%96%E8%AF%91%E6%A8%A1%E5%9D%97"><span class="toc-number">3.1.1.</span> <span class="toc-text">安装易语言反编译模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E9%80%BB%E8%BE%91"><span class="toc-number">3.1.2.</span> <span class="toc-text">主逻辑</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.2.1.</span> <span class="toc-text">加密函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%90%E4%BE%9B%E4%BA%86%E5%AF%86%E6%96%87"><span class="toc-number">3.1.2.2.</span> <span class="toc-text">提供了密文</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%BB%E5%AF%86%E9%92%A5"><span class="toc-number">3.1.2.3.</span> <span class="toc-text">画密钥</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="toc-number">3.1.2.3.1.</span> <span class="toc-text">方法一</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="toc-number">3.1.2.3.2.</span> <span class="toc-text">方法二</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exp-2"><span class="toc-number">3.1.3.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E9%BE%99%E6%8B%89%E6%A3%BA"><span class="toc-number">3.2.</span> <span class="toc-text">九龙拉棺</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%98%A0%E5%B0%84%E5%AF%B9%E8%B1%A1"><span class="toc-number">3.2.1.</span> <span class="toc-text">文件映射对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E8%B0%83%E8%AF%95"><span class="toc-number">3.2.2.</span> <span class="toc-text">反调试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AB%E4%B8%AA%E7%BA%BF%E7%A8%8B"><span class="toc-number">3.2.3.</span> <span class="toc-text">八个线程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%EF%BC%9ARc4%E8%A7%A3%E5%AF%86"><span class="toc-number">3.2.3.1.</span> <span class="toc-text">第一个线程：Rc4解密</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E4%B8%AA%E7%BA%BF%E7%A8%8B%EF%BC%9Abase32%E8%A7%A3%E6%9E%90"><span class="toc-number">3.2.3.2.</span> <span class="toc-text">第二个线程：base32解析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E4%B8%AA%E7%BA%BF%E7%A8%8B%EF%BC%9Abase58"><span class="toc-number">3.2.3.3.</span> <span class="toc-text">第三个线程：base58</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E4%B8%AA%E7%BA%BF%E7%A8%8B%EF%BC%9Abase64"><span class="toc-number">3.2.3.4.</span> <span class="toc-text">第四个线程：base64</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E4%B8%AA%E7%BA%BF%E7%A8%8B%EF%BC%9AStartAddress"><span class="toc-number">3.2.3.5.</span> <span class="toc-text">第五个线程：StartAddress</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E4%B8%AA%E7%BA%BF%E7%A8%8B%EF%BC%9Atea%E3%80%81compare"><span class="toc-number">3.2.3.6.</span> <span class="toc-text">第六个线程：tea、compare</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%83%E4%B8%AA%E7%BA%BF%E7%A8%8B%EF%BC%9A%E6%9C%80%E7%BB%88%E7%BB%93%E6%9E%9C"><span class="toc-number">3.2.3.7.</span> <span class="toc-text">第七个线程：最终结果</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E5%85%AB%E4%B8%AA%E7%BA%BF%E7%A8%8B%EF%BC%9A%E5%8F%8D%E8%B0%83%E8%AF%95"><span class="toc-number">3.2.3.8.</span> <span class="toc-text">第八个线程：反调试</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96text%E6%AE%B5%E5%9C%B0%E5%9D%80"><span class="toc-number">3.2.3.8.1.</span> <span class="toc-text">获取text段地址</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8E%8B%E7%BC%A9%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%BD%A2%E6%88%90%E4%B8%80%E4%B8%AA%E6%95%B4%E6%95%B0%EF%BC%88%E7%B1%BB%E4%BC%BC%E6%A0%A1%E9%AA%8C%E7%A0%81%EF%BC%89"><span class="toc-number">3.2.3.8.2.</span> <span class="toc-text">压缩数据，形成一个整数（类似校验码）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E6%AF%94%E5%AF%B9"><span class="toc-number">3.2.3.8.3.</span> <span class="toc-text">循环比对</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E8%BF%9B%E7%A8%8B"><span class="toc-number">3.2.4.</span> <span class="toc-text">子进程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#FindFunction"><span class="toc-number">3.2.4.1.</span> <span class="toc-text">FindFunction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#tea"><span class="toc-number">3.2.4.2.</span> <span class="toc-text">tea</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#main"><span class="toc-number">3.2.4.3.</span> <span class="toc-text">main</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WMCTF2023"><span class="toc-number">4.</span> <span class="toc-text">WMCTF2023</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#RightBack"><span class="toc-number">4.1.</span> <span class="toc-text">RightBack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E7%BC%96%E8%AF%91pyc"><span class="toc-number">4.1.1.</span> <span class="toc-text">反编译pyc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90%E9%80%BB%E8%BE%91"><span class="toc-number">4.1.2.</span> <span class="toc-text">分析逻辑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exp-3"><span class="toc-number">4.1.3.</span> <span class="toc-text">exp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E5%B8%88%E5%82%85%E7%9A%84patch%E8%84%9A%E6%9C%AC"><span class="toc-number">4.1.4.</span> <span class="toc-text">其他师傅的patch脚本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezAndroid"><span class="toc-number">4.2.</span> <span class="toc-text">ezAndroid</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#apk%E9%80%BB%E8%BE%91"><span class="toc-number">4.2.1.</span> <span class="toc-text">apk逻辑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8Dfrida"><span class="toc-number">4.2.2.</span> <span class="toc-text">反frida</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%A7%E8%87%B4%E9%80%BB%E8%BE%91"><span class="toc-number">4.2.2.1.</span> <span class="toc-text">大致逻辑</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#frida-hook"><span class="toc-number">4.2.2.2.</span> <span class="toc-text">frida hook</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#native%E5%87%BD%E6%95%B0"><span class="toc-number">4.2.3.</span> <span class="toc-text">native函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SO%E5%87%BD%E6%95%B0"><span class="toc-number">4.2.4.</span> <span class="toc-text">SO函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CheckUsername"><span class="toc-number">4.2.4.1.</span> <span class="toc-text">CheckUsername</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%98%E5%8E%9F%E4%BB%A3%E7%A0%81"><span class="toc-number">4.2.4.1.1.</span> <span class="toc-text">还原代码</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D"><span class="toc-number">4.2.4.1.1.1.</span> <span class="toc-text">第一种</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D"><span class="toc-number">4.2.4.1.1.2.</span> <span class="toc-text">第二种</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#frida-hook-RC4%E5%87%BD%E6%95%B0%E7%9A%84%E5%8F%82%E6%95%B0"><span class="toc-number">4.2.4.1.2.</span> <span class="toc-text">frida hook RC4函数的参数</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#check2"><span class="toc-number">4.2.4.2.</span> <span class="toc-text">check2</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E6%9E%90%E5%8A%A0%E5%AF%86%E8%BF%87%E7%A8%8B"><span class="toc-number">4.2.4.2.1.</span> <span class="toc-text">分析加密过程</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BabyAnti-2-0"><span class="toc-number">4.3.</span> <span class="toc-text">BabyAnti-2.0</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#patch-libanticheat-so"><span class="toc-number">4.3.1.</span> <span class="toc-text">patch libanticheat.so</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80-%E2%80%94%E2%80%94-patch-libapp-so"><span class="toc-number">4.3.2.</span> <span class="toc-text">方法一 —— patch libapp.so</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C-%E2%80%94%E2%80%94-patch-smali%E4%BB%A3%E7%A0%81%E5%90%8E%E7%94%A8CE"><span class="toc-number">4.3.3.</span> <span class="toc-text">方法二 —— patch smali代码后用CE</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF"><span class="toc-number">5.</span> <span class="toc-text">羊城杯</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#babyobfu"><span class="toc-number">5.1.</span> <span class="toc-text">babyobfu</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%BB%E6%B7%B7%E6%B7%86"><span class="toc-number">5.1.1.</span> <span class="toc-text">去混淆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E5%88%86%E6%9E%90"><span class="toc-number">5.1.2.</span> <span class="toc-text">逻辑分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exp-4"><span class="toc-number">5.1.3.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Blast"><span class="toc-number">5.2.</span> <span class="toc-text">Blast</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%BB%E6%B7%B7%E6%B7%86-1"><span class="toc-number">5.2.1.</span> <span class="toc-text">去混淆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E9%80%BB%E8%BE%91"><span class="toc-number">5.2.2.</span> <span class="toc-text">主要逻辑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exp-5"><span class="toc-number">5.2.3.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSGO"><span class="toc-number">5.3.</span> <span class="toc-text">CSGO</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vm-wo"><span class="toc-number">5.4.</span> <span class="toc-text">vm_wo</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#exp-6"><span class="toc-number">5.4.1.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ez%E5%8A%A0%E5%AF%86%E5%99%A8"><span class="toc-number">5.5.</span> <span class="toc-text">Ez加密器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%BB%E6%B7%B7%E6%B7%86-2"><span class="toc-number">5.5.1.</span> <span class="toc-text">去混淆</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%811"><span class="toc-number">5.5.1.1.</span> <span class="toc-text">代码1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%812"><span class="toc-number">5.5.1.2.</span> <span class="toc-text">代码2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%813"><span class="toc-number">5.5.1.3.</span> <span class="toc-text">代码3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%814"><span class="toc-number">5.5.1.4.</span> <span class="toc-text">代码4</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%815"><span class="toc-number">5.5.1.5.</span> <span class="toc-text">代码5</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E5%8E%BB%E6%B7%B7%E6%B7%86"><span class="toc-number">5.5.1.6.</span> <span class="toc-text">脚本去混淆</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF"><span class="toc-number">5.5.2.</span> <span class="toc-text">思路</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/11/21/CTF-wp-2/" title="babyLoginPlus——bugku"><img src="/./img/preview.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="babyLoginPlus——bugku"/></a><div class="content"><a class="title" href="/2023/11/21/CTF-wp-2/" title="babyLoginPlus——bugku">babyLoginPlus——bugku</a><time datetime="2023-11-21T03:49:36.000Z" title="发表于 2023-11-21 11:49:36">2023-11-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/21/CTF-wp-1/" title="CTF-WP-1"><img src="/./img/preview.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CTF-WP-1"/></a><div class="content"><a class="title" href="/2023/11/21/CTF-wp-1/" title="CTF-WP-1">CTF-WP-1</a><time datetime="2023-11-21T03:49:36.000Z" title="发表于 2023-11-21 11:49:36">2023-11-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/12/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/" title="电子取证"><img src="/./img/preview.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="电子取证"/></a><div class="content"><a class="title" href="/2023/09/12/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/" title="电子取证">电子取证</a><time datetime="2023-09-12T05:59:27.000Z" title="发表于 2023-09-12 13:59:27">2023-09-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2023 By hahbiubiubiu</div><div class="footer_custom_text">hahahahah biubiubiu boomboomboom</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>