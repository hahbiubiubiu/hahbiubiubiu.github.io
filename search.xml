<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ciscn2023</title>
      <link href="/2023/06/27/ciscn2023/"/>
      <url>/2023/06/27/ciscn2023/</url>
      
        <content type="html"><![CDATA[<h1 id="babyre"><a href="#babyre" class="headerlink" title="babyre"></a>babyre</h1><p>snap.berkeley.eduæ‰“å¼€xmlæ–‡ä»¶ã€‚</p><p>ä¿®æ”¹è®¾ç½®<code>secret</code>å˜é‡çš„æµç¨‹ï¼š</p><p><img src="/2023/06/27/ciscn2023/image-20230528171633929.png" alt="æ•°æ®ç”Ÿæˆ"></p><p>åœ¨å…¶è®¾ç½®å®Œ<code>secret</code>åå±•ç¤ºï¼š</p><p><img src="/2023/06/27/ciscn2023/image-20230528171717916.png" alt="å±•ç¤º"></p><p>å¾—åˆ°<code>secret</code>ï¼š</p><p><img src="/2023/06/27/ciscn2023/image-20230528171755771.png" alt="æ•°æ®"></p><p>é€†å‘å¦‚å›¾æ‰€ç¤ºçš„ç®—æ³•ï¼š</p><p><img src="/2023/06/27/ciscn2023/image-20230528171838714.png" alt="æ¯”å¯¹ç®—æ³•"></p><p>å…·ä½“æµç¨‹å°±æ˜¯å°†è¾“å…¥çš„æ¯ä¸¤ä¸ªå­—ç¬¦è¿›è¡Œå¼‚æˆ–ï¼Œæ”¾ç½®åˆ°<code>test</code>ä¸­ï¼Œç„¶åå°†<code>test[1:-1]</code>ä¸<code>secret</code>æ¯”å¯¹</p><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data=[<span class="number">102</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">28</span>,<span class="number">74</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">85</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">75</span>,<span class="number">20</span>,<span class="number">92</span>,<span class="number">92</span>,<span class="number">8</span>,<span class="number">28</span>,<span class="number">25</span>,<span class="number">81</span>,<span class="number">83</span>,<span class="number">7</span>,<span class="number">28</span>,<span class="number">76</span>,<span class="number">88</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">29</span>,<span class="number">73</span>,<span class="number">0</span>,<span class="number">86</span>,<span class="number">4</span>,<span class="number">87</span>,<span class="number">87</span>,<span class="number">82</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">4</span>,<span class="number">85</span>,<span class="number">87</span>,<span class="number">30</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(data)):</span><br><span class="line">    data[i]^=data[i-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(data))</span><br></pre></td></tr></table></figure><h1 id="ezbyte"><a href="#ezbyte" class="headerlink" title="ezbyte"></a>ezbyte</h1><p><img src="/2023/06/27/ciscn2023/image-20230627181710006.png" alt="æ¯”å¯¹é€»è¾‘"></p><p>æŸ¥çœ‹ç¨‹åºå¯ä»¥çŸ¥é“flagçš„å‰äº”ä½å’Œåäº”ä½ï¼Œç„¶åå°†ä¸­é—´çš„åˆ†åˆ«æ”¾å…¥r12ã€r13ã€r14ã€r15ä¸­ï¼Œä½†ä¹‹åçš„ç¨‹åºæ²¡æœ‰å¯¹r12æœ‰å¤„ç†ã€‚</p><p>ä½¿ç”¨<code>readelf --debug-dump=frame ezbyte</code>æˆ–<code>readelf -Wwr ezbyte</code>è·å–Dwarfè°ƒè¯•ä¿¡æ¯ã€‚</p><p><img src="/2023/06/27/ciscn2023/image-20230627181143587.png" alt="r12å¤„ç†è¿‡ç¨‹"></p><p>é€»è¾‘ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">r12, r13, r14, r15 = 0, 0, 0, 0</span><br><span class="line">r12 = (r12 + 1892739) ^ 1237891274917891239 ^ 2616514329260088143</span><br><span class="line">r13 = (r13 + 8971237) ^ 1209847170981118947 ^ 8502251781212277489</span><br><span class="line">r14 = (r14 + 1512312) ^ 1098791727398412397 ^ 2451795628338718684</span><br><span class="line">r15 = (r15 + 9123704) ^ 1890878197237214971 ^ 8722213363631027234</span><br><span class="line">r12 = r12 | r13 | r14 | r15</span><br></pre></td></tr></table></figure><p>æœ€åç»“æœåº”è¯¥æ˜¯0ã€‚</p><h1 id="moveAside"><a href="#moveAside" class="headerlink" title="moveAside"></a>moveAside</h1><p>movæ··æ·†ï¼Œæˆ‘ä¸ä¼šã€‚</p><p>ä½†çœ‹wpå’Œè°ƒè¯•å¯ä»¥å‘ç°ï¼Œç¨‹åºåº”è¯¥æ˜¯ä¸€ä¸ªä¸ªå­—ç¬¦å˜æ¢ï¼Œä¸”ç”¨strcmpæ¯”è¾ƒï¼Œåœ¨strcmpä¸‹æ–­ç‚¹ï¼Œå¯ä»¥åœ¨æ ˆä¸­æ‰¾åˆ°è¦æ¯”è¾ƒçš„ä¸¤ä¸ªå­—ç¬¦ã€‚</p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨<code>ltrace</code>è·å–ç¨‹åºçš„ç³»ç»Ÿè°ƒç”¨ï¼š</p><p>æ‰§è¡Œäº†ä¸€æ¬¡<code>strcmp</code>å°±ç»“æŸäº†ï¼š</p><p><img src="/2023/06/27/ciscn2023/image-20230628132748435.png" alt="è¾“å…¥1234567890"></p><p>æ‰§è¡Œäº†å…­æ¬¡<code>strcmp</code>æ‰ç»“æŸï¼š</p><p><img src="/2023/06/27/ciscn2023/image-20230628132910371.png" alt="è¾“å…¥flag{...}"></p><h2 id="æ„é€ è¾“å…¥è¾“å‡ºè¡¨"><a href="#æ„é€ è¾“å…¥è¾“å‡ºè¡¨" class="headerlink" title="æ„é€ è¾“å…¥è¾“å‡ºè¡¨"></a>æ„é€ è¾“å…¥è¾“å‡ºè¡¨</h2><p>å¯ä»¥è¾“å…¥<code>0123456789abcdefghijklmnopqrstuvwxyz&#123;&#125;-111</code>å°è¯•è·å–è¾“å…¥è¾“å‡ºè¡¨ï¼Œä¸”è®°å½•è¦æ¯”è¾ƒçš„å­—ç¬¦ï¼Œå¹¶ä¸”æ¯æ¬¡æ¯”è¾ƒæ—¶å°†æ›´æ”¹å˜æ¢åçš„å­—ç¬¦ä½¿å…¶æ¯”è¾ƒæˆåŠŸã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(&quot;table:&quot;,Byte(0x8600154),Byte(0x860014C))</span><br><span class="line">PatchByte(0x8600154,Byte(0x860014C))</span><br></pre></td></tr></table></figure><h2 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">table = []</span><br><span class="line">final = []</span><br><span class="line"><span class="built_in">input</span> = <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz&#123;&#125;-&quot;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./out.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        line = f.readline()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> line:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> line.startswith(<span class="string">&quot;table&quot;</span>):</span><br><span class="line">            lines = line.split()</span><br><span class="line">            table.append(<span class="built_in">int</span>(lines[<span class="number">1</span>]))</span><br><span class="line">            final.append(<span class="built_in">int</span>(lines[<span class="number">2</span>]))</span><br><span class="line"><span class="built_in">print</span>(table)</span><br><span class="line"><span class="built_in">print</span>(final)</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(final)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table) - <span class="number">3</span>):</span><br><span class="line">        <span class="keyword">if</span> final[i] == table[j]:</span><br><span class="line">            flag += <span class="built_in">input</span>[j]</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;781dda4e-d910-4f06-8f5b-5c3755182337&#125;</span></span><br></pre></td></tr></table></figure><h1 id="ezAndroid"><a href="#ezAndroid" class="headerlink" title="ezAndroid"></a>ezAndroid</h1><p>ä¸ä¼šï¼Œåšçš„æ—¶å€™å®Œå…¨ä¸çŸ¥é“è¦å¹²å˜›ï¼Œçœ‹äº†wpæ‰ç¨å¾®æ‡‚äº›ã€‚</p><p>è´´ä¸ªå…¶ä»–å¸ˆå‚…çš„wpğŸ‘‰[CISCN2023 wp | å¿ƒæµ (natro92.github.io)](<a href="https://natro92.github.io/2023/05/29/CISCN2023">https://natro92.github.io/2023/05/29/CISCN2023</a> wp&#x2F;index.html)</p><h1 id="flutterror"><a href="#flutterror" class="headerlink" title="flutterror"></a>flutterror</h1><p>ä¸ä¼šï¼Œå†è´´ä¸ªå…¶ä»–å¸ˆå‚…æ¯”è¾ƒå–å·§çš„æ€è·¯ğŸ‘‰<a href="https://www.cnblogs.com/lordtianqiyi/articles/17438974.html">CISCN 2023 RE WP</a></p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DASCTF2023äºŒè¿›åˆ¶</title>
      <link href="/2023/06/23/DASCTF2023%E4%BA%8C%E8%BF%9B%E5%88%B6/"/>
      <url>/2023/06/23/DASCTF2023%E4%BA%8C%E8%BF%9B%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="careful"><a href="#careful" class="headerlink" title="careful"></a>careful</h1><p>ç›´æ¥ä¸Šä¼ å¾®æ­¥äº‘æ²™ç®±</p><p><img src="/2023/06/23/DASCTF2023%E4%BA%8C%E8%BF%9B%E5%88%B6/image-20230604203710296.png" alt="url"></p><h1 id="babyRe"><a href="#babyRe" class="headerlink" title="babyRe"></a>babyRe</h1><p>è°ƒè¯•ä¸€ä¸‹äº†è§£ä¸»è¦é€»è¾‘ï¼š</p><p><img src="/2023/06/23/DASCTF2023%E4%BA%8C%E8%BF%9B%E5%88%B6/2.PNG" alt="ä¸»é€»è¾‘"></p><p>v17çš„ä½ç½®æ˜¯å¤„ç†è¾“å…¥å­—ç¬¦ä¸²çš„ï¼›</p><p>StartAddressæ˜¯æœ€åè¿›è¡Œæ¯”è¾ƒçš„ï¼›</p><p>v17çš„ä½ç½®çš„æ•°æ®æ˜¯ç»è¿‡å‰é¢æœ‰ä¸ªå‡½æ•°å¼‚æˆ–è§£å¼€çš„ï¼Œå¸¦æœ‰ä¸€ç‚¹æ··æ·†ï¼Œå¤„ç†åå¯ä»¥å¾—åˆ°ï¼š</p><p><img src="/2023/06/23/DASCTF2023%E4%BA%8C%E8%BF%9B%E5%88%B6/1.PNG" alt="åŠ å¯†é€»è¾‘"></p><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">key = [</span><br><span class="line">    <span class="number">93</span>, <span class="number">66</span>, <span class="number">98</span>, <span class="number">41</span>, <span class="number">3</span>, <span class="number">54</span>, <span class="number">71</span>, <span class="number">65</span>, <span class="number">21</span>, <span class="number">54</span></span><br><span class="line">]</span><br><span class="line">data = [</span><br><span class="line">    <span class="number">0xF7</span>, <span class="number">0x2E</span>, <span class="number">0x34</span>, <span class="number">0xF0</span>, <span class="number">0x72</span>, <span class="number">0xCF</span>, <span class="number">0x5E</span>, <span class="number">0x0A</span>, <span class="number">0xBB</span>, <span class="number">0xEC</span>,</span><br><span class="line">    <span class="number">0xB1</span>, <span class="number">0x2B</span>, <span class="number">0x70</span>, <span class="number">0x88</span>, <span class="number">0x88</span>, <span class="number">0xED</span>, <span class="number">0x46</span>, <span class="number">0x38</span>, <span class="number">0xDB</span>, <span class="number">0xDA</span>,</span><br><span class="line">    <span class="number">0x6C</span>, <span class="number">0xBD</span>, <span class="number">0xD4</span>, <span class="number">0x06</span>, <span class="number">0x77</span>, <span class="number">0xF2</span>, <span class="number">0xCF</span>, <span class="number">0x56</span>, <span class="number">0x88</span>, <span class="number">0xC6</span>,</span><br><span class="line">    <span class="number">0x31</span>, <span class="number">0xD2</span>, <span class="number">0xB7</span>, <span class="number">0x5A</span>, <span class="number">0xC1</span>, <span class="number">0x42</span>, <span class="number">0xB0</span>, <span class="number">0xF4</span>, <span class="number">0x48</span>, <span class="number">0x37</span>,</span><br><span class="line">    <span class="number">0xF5</span>, <span class="number">0x2C</span>, <span class="number">0xF5</span>, <span class="number">0x58</span></span><br><span class="line">]</span><br><span class="line">v4 = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x100</span>)]</span><br><span class="line"></span><br><span class="line">v7 = <span class="number">0</span></span><br><span class="line">v6 = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x100</span>):</span><br><span class="line">    v6 = (key[v7 % <span class="number">10</span>] + v4[i] + <span class="number">2</span> * v6) % <span class="number">0x100</span></span><br><span class="line">    v7 += <span class="number">1</span></span><br><span class="line">    v4[i], v4[v6] = v4[v6], v4[i]</span><br><span class="line"></span><br><span class="line">v7, v6 = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    v6 = (v7 + v6) % <span class="number">0x100</span></span><br><span class="line">    v7 = (v4[v6] + v7) % <span class="number">0x100</span></span><br><span class="line">    v4[v6], v4[v7] = v4[v7], v4[v6]</span><br><span class="line">    v12 = v4[(v4[v6] + v7 + v4[v7]) % <span class="number">0x100</span>]</span><br><span class="line">    data[i] -= i % <span class="number">0xD</span></span><br><span class="line">    data[i] %= <span class="number">0x100</span></span><br><span class="line">    data[i] ^= v12</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> data))</span><br></pre></td></tr></table></figure><h1 id="ez-exe"><a href="#ez-exe" class="headerlink" title="ez_exe"></a>ez_exe</h1><h2 id="è·å–bin2"><a href="#è·å–bin2" class="headerlink" title="è·å–bin2"></a>è·å–bin2</h2><p>ç”¨pyinstxtractorç”Ÿæˆpycï¼Œå†ç”¨pycdcåç¼–è¯‘ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> wintypes</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">_STARTUPINFO</span>(<span class="title class_ inherited__">Structure</span>):</span><br><span class="line">    _fields_ = [</span><br><span class="line">        (<span class="string">&#x27;cb&#x27;</span>, c_ulong),</span><br><span class="line">        (<span class="string">&#x27;lpReserved&#x27;</span>, c_char_p),</span><br><span class="line">        (<span class="string">&#x27;lpDesktop&#x27;</span>, c_char_p),</span><br><span class="line">        (<span class="string">&#x27;lpTitle&#x27;</span>, c_char_p),</span><br><span class="line">        (<span class="string">&#x27;dwX&#x27;</span>, c_ulong),</span><br><span class="line">        (<span class="string">&#x27;dwY&#x27;</span>, c_ulong),</span><br><span class="line">        (<span class="string">&#x27;dwXSize&#x27;</span>, c_ulong),</span><br><span class="line">        (<span class="string">&#x27;dwYSize&#x27;</span>, c_ulong),</span><br><span class="line">        (<span class="string">&#x27;dwXCountChars&#x27;</span>, c_ulong),</span><br><span class="line">        (<span class="string">&#x27;dwYCountChars&#x27;</span>, c_ulong),</span><br><span class="line">        (<span class="string">&#x27;dwFillAttribute&#x27;</span>, c_ulong),</span><br><span class="line">        (<span class="string">&#x27;dwFlags&#x27;</span>, c_ulong),</span><br><span class="line">        (<span class="string">&#x27;wShowWindow&#x27;</span>, c_ushort),</span><br><span class="line">        (<span class="string">&#x27;cbReserved2&#x27;</span>, c_ushort),</span><br><span class="line">        (<span class="string">&#x27;lpReserved2&#x27;</span>, c_char_p),</span><br><span class="line">        (<span class="string">&#x27;hStdInput&#x27;</span>, c_ulong),</span><br><span class="line">        (<span class="string">&#x27;hStdOutput&#x27;</span>, c_ulong),</span><br><span class="line">        (<span class="string">&#x27;hStdError&#x27;</span>, c_ulong)]</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">_PROCESS_INFORMATION</span>(<span class="title class_ inherited__">Structure</span>):</span><br><span class="line">    _fields_ = [</span><br><span class="line">        (<span class="string">&#x27;hProcess&#x27;</span>, c_void_p),</span><br><span class="line">        (<span class="string">&#x27;hThread&#x27;</span>, c_void_p),</span><br><span class="line">        (<span class="string">&#x27;dwProcessId&#x27;</span>, c_ulong),</span><br><span class="line">        (<span class="string">&#x27;dwThreadId&#x27;</span>, c_ulong)]</span><br><span class="line"> </span><br><span class="line">StartupInfo = _STARTUPINFO()</span><br><span class="line">ProcessInfo = _PROCESS_INFORMATION()</span><br><span class="line">key1 = <span class="built_in">bytes</span>(md5(<span class="string">b&#x27;bin1bin1bin1&#x27;</span>).hexdigest().encode())</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&#x27;bin1&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">arr = <span class="built_in">range</span>(<span class="built_in">len</span>(file))()</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;bin1&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>).write(<span class="built_in">bytes</span>(arr))</span><br><span class="line">sleep(<span class="number">0</span>)</span><br><span class="line">bet = ctypes.windll.kernel32.CreateProcessA(<span class="string">b&#x27;bin1&#x27;</span>, ctypes.c_int(<span class="number">0</span>), ctypes.c_int(<span class="number">0</span>), ctypes.c_int(<span class="number">0</span>), ctypes.c_int(<span class="number">0</span>), ctypes.c_int(<span class="number">0</span>), ctypes.c_int(<span class="number">0</span>), ctypes.c_int(<span class="number">0</span>), byref(StartupInfo), byref(ProcessInfo))</span><br><span class="line">ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(ProcessInfo.hProcess), ctypes.c_int(-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;bin1&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>).write(file)</span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾ï¼Œ<code>arr = range(len(file))() å’Œ open(&#39;bin1&#39;, &#39;wb&#39;).write(bytes(arr))</code>æ˜¯æœ‰äº›å¥‡æ€ªçš„ï¼Œå¯èƒ½æ˜¯æ— æ³•å½»åº•åœ°åç¼–è¯‘ï¼Œäºæ˜¯ç”¨pycdaså¾—åˆ°pythonå­—èŠ‚ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">b&#x27;bin1bin1bin1&#x27;</span><br><span class="line">&#x27;bin1&#x27;</span><br><span class="line">&#x27;rb&#x27;</span><br><span class="line">[Code]</span><br><span class="line">    File Name: ez_py.py</span><br><span class="line">    Object Name: &lt;listcomp&gt;</span><br><span class="line">    Qualified Name: &lt;listcomp&gt;</span><br><span class="line">    Arg Count: 1</span><br><span class="line">    Pos Only Arg Count: 0</span><br><span class="line">    KW Only Arg Count: 0</span><br><span class="line">    Stack Size: 7</span><br><span class="line">    Flags: 0x00000003 (CO_OPTIMIZED | CO_NEWLOCALS)</span><br><span class="line">    [Names]</span><br><span class="line">        &#x27;key1&#x27;</span><br><span class="line">        &#x27;len&#x27;</span><br><span class="line">        &#x27;file&#x27;</span><br><span class="line">    [Constants]</span><br><span class="line">    [Disassembly]</span><br><span class="line">        0       RESUME                        0</span><br><span class="line">        2       BUILD_LIST                    0</span><br><span class="line">        4       LOAD_FAST                     0: .0</span><br><span class="line">        6       FOR_ITER                      50 (to 108)</span><br><span class="line">        8       STORE_FAST                    1: i</span><br><span class="line">        10      LOAD_GLOBAL                   0: key1</span><br><span class="line">        22      LOAD_FAST                     1: i</span><br><span class="line">        24      LOAD_GLOBAL                   3: NULL + len</span><br><span class="line">        36      LOAD_GLOBAL                   0: key1</span><br><span class="line">        48      PRECALL                       1</span><br><span class="line">        52      CALL                          1</span><br><span class="line">        62      BINARY_OP                     6</span><br><span class="line">        66      BINARY_SUBSCR                 </span><br><span class="line">        76      LOAD_GLOBAL                   4: file</span><br><span class="line">        88      LOAD_FAST                     1: i</span><br><span class="line">        90      BINARY_SUBSCR                 </span><br><span class="line">        100     BINARY_OP                     12</span><br><span class="line">        104     LIST_APPEND                   2</span><br><span class="line">        106     JUMP_BACKWARD                 51</span><br><span class="line">        108     RETURN_VALUE                  </span><br><span class="line">&#x27;wb&#x27;</span><br><span class="line">b&#x27;bin1&#x27;</span><br><span class="line">-1</span><br></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨disæ¥è·å–pythonå­—èŠ‚ç ï¼Œä½†å¾—ä½¿ç”¨python3.11ç‰ˆæœ¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Disassembly of &lt;code object &lt;listcomp&gt; at 0x00000160F71B8FA0, file &quot;ez_py.py&quot;, line 59&gt;:</span><br><span class="line"> 59           0 RESUME                   0</span><br><span class="line">              2 BUILD_LIST               0</span><br><span class="line">              4 LOAD_FAST                0 (.0)</span><br><span class="line">        &gt;&gt;    6 FOR_ITER                50 (to 108)</span><br><span class="line">              8 STORE_FAST               1 (i)</span><br><span class="line">             10 LOAD_GLOBAL              0 (key1)</span><br><span class="line">             22 LOAD_FAST                1 (i)</span><br><span class="line">             24 LOAD_GLOBAL              3 (NULL + len)</span><br><span class="line">             36 LOAD_GLOBAL              0 (key1)</span><br><span class="line">             48 PRECALL                  1</span><br><span class="line">             52 CALL                     1</span><br><span class="line">             62 BINARY_OP                6 (%)</span><br><span class="line">             66 BINARY_SUBSCR</span><br><span class="line">             76 LOAD_GLOBAL              4 (file)</span><br><span class="line">             88 LOAD_FAST                1 (i)</span><br><span class="line">             90 BINARY_SUBSCR</span><br><span class="line">            100 BINARY_OP               12 (^)</span><br><span class="line">            104 LIST_APPEND              2</span><br><span class="line">            106 JUMP_BACKWARD           51 (to 6)</span><br><span class="line">        &gt;&gt;  108 RETURN_VALUE</span><br></pre></td></tr></table></figure><p>é€†å‡ºé€»è¾‘ï¼Œå¹¶å°†å…¶æ”¹ä¸ºbin2æ¥è§£å¯†bin2æ–‡ä»¶ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">key1 = <span class="built_in">bytes</span>(md5(<span class="string">b&quot;bin2bin2bin2&quot;</span>).hexdigest().encode())</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&quot;bin2&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">arr = [key1[i % <span class="built_in">len</span>(key1)] ^ file[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(file))]</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&quot;bin_dump&quot;</span>, <span class="string">&quot;wb&quot;</span>).write(<span class="built_in">bytes</span>(arr))</span><br></pre></td></tr></table></figure><h2 id="è§£å¯†bin2"><a href="#è§£å¯†bin2" class="headerlink" title="è§£å¯†bin2"></a>è§£å¯†bin2</h2><p><img src="/2023/06/23/DASCTF2023%E4%BA%8C%E8%BF%9B%E5%88%B6/image-20230623123050061.png" alt="bin2ä¸»é€»è¾‘"></p><p><img src="/2023/06/23/DASCTF2023%E4%BA%8C%E8%BF%9B%E5%88%B6/image-20230623123109217.png" alt="bteaå‡½æ•°"></p><p>å¯ä»¥ç›´æ¥å†™è„šæœ¬äº†ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x7937B99E</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">btea</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">int</span> n, <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">    rounds = <span class="number">52</span> / n;</span><br><span class="line">    sum = rounds * DELTA;</span><br><span class="line">    y = v[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> (p = n - <span class="number">1</span>; p &gt; <span class="number">0</span>; p--) &#123;</span><br><span class="line">            z = v[p - <span class="number">1</span>];</span><br><span class="line">            y = v[p] -= MX;</span><br><span class="line">        &#125;</span><br><span class="line">        z = v[n - <span class="number">1</span>];</span><br><span class="line">        y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">    &#125; <span class="keyword">while</span> ((sum -= DELTA) != <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>] = &#123; <span class="number">0x4B5F</span>, <span class="number">0xDEAD</span>, <span class="number">0x11ED</span>, <span class="number">0xB3CC</span> &#125;;</span><br><span class="line">    <span class="type">uint32_t</span> data[<span class="number">11</span>] = &#123; <span class="number">0xCC45699D</span>, <span class="number">0x683D5352</span>,<span class="number">0xB8BB71A0</span>,<span class="number">0xD3817AD</span>,<span class="number">0x7547E79E</span>,<span class="number">0x4BDD8C7C</span>,<span class="number">0x95E25A81</span>,<span class="number">0xC4525103</span>,<span class="number">0x7049B46F</span>,<span class="number">0x5417F77C</span>,<span class="number">0x65567138</span> &#125;;</span><br><span class="line">    <span class="type">uint32_t</span>* sent = data;</span><br><span class="line">    <span class="built_in">btea</span>(sent, <span class="number">11</span>, key);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">11</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, sent[i] &amp; <span class="number">0xff</span>);</span><br><span class="line">            sent[i] &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="cap"><a href="#cap" class="headerlink" title="cap"></a>cap</h1><p>ä¸»é€»è¾‘ï¼šç¨‹åºæˆªå›¾å¹¶è¿›è¡Œå¤„ç†ä¿å­˜ä¸ºcap.binã€‚</p><p><img src="/2023/06/23/DASCTF2023%E4%BA%8C%E8%BF%9B%E5%88%B6/image-20230623163326221.png" alt="ä¸»é€»è¾‘"></p><p>åŠ¨æ€è°ƒè¯•å¯å¾—ï¼Œ</p><p>è¿™éƒ¨åˆ†å¤„ç†binæ–‡ä»¶çš„1-14ä¸ªå­—èŠ‚ï¼š</p><p><img src="/2023/06/23/DASCTF2023%E4%BA%8C%E8%BF%9B%E5%88%B6/image-20230623193403249.png" alt="0-14"></p><p>è¿™éƒ¨åˆ†å¤„ç†binæ–‡ä»¶çš„15-40ä¸ªå­—èŠ‚ï¼š</p><p><img src="/2023/06/23/DASCTF2023%E4%BA%8C%E8%BF%9B%E5%88%B6/image-20230623194710994.png" alt="15-40"></p><p>è¿™éƒ¨åˆ†å¤„ç†binæ–‡ä»¶çš„å‰©ä½™å­—èŠ‚ï¼Œä¸”ä¸‹æ ‡èµ·å§‹äº3ï¼š</p><p><img src="/2023/06/23/DASCTF2023%E4%BA%8C%E8%BF%9B%E5%88%B6/image-20230623193603271.png" alt="41-..."></p><h2 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">        a[i] ^= ((b &gt;&gt; i * <span class="number">8</span>) &amp; <span class="number">0xFF</span>)</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = [<span class="number">0x65</span>, <span class="number">0x6E</span>, <span class="number">0x63</span>, <span class="number">0x5F</span>, <span class="number">0x62</span>, <span class="number">0x79</span>, <span class="number">0x5F</span>, <span class="number">0x64</span>, <span class="number">0x61</span>, <span class="number">0x73</span>, <span class="number">0x63</span>, <span class="number">0x74</span>, <span class="number">0x66</span>]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./cap.bin&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data1 = <span class="built_in">bytearray</span>(f.read(<span class="number">14</span>))</span><br><span class="line">    data2 = <span class="built_in">bytearray</span>(f.read(<span class="number">40</span>))</span><br><span class="line">    data3 = <span class="built_in">bytearray</span>(f.read())</span><br><span class="line"><span class="comment"># data1[0] ^= 0x6E</span></span><br><span class="line"><span class="comment"># data1[1] ^= 0x63</span></span><br><span class="line"><span class="comment"># data1[2] ^= 0x5f</span></span><br><span class="line"><span class="comment"># data1[3] ^= 0x62</span></span><br><span class="line"><span class="comment"># data1[4] ^= 0x79</span></span><br><span class="line"><span class="comment"># data1[5] ^= 0x5f</span></span><br><span class="line"><span class="comment"># data1[6] ^= 0x64</span></span><br><span class="line"><span class="comment"># data1[7] ^= 0x61</span></span><br><span class="line"><span class="comment"># data1[8] ^= 0x73</span></span><br><span class="line"><span class="comment"># data1[9] ^= 0x63</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data1)):</span><br><span class="line">    data1[i] ^= key[(i + <span class="number">1</span>) % <span class="number">13</span>]</span><br><span class="line">data2[:<span class="number">4</span>] = handle(data2[:<span class="number">4</span>], <span class="number">0x79625f63</span>)</span><br><span class="line">data2[<span class="number">4</span>:<span class="number">8</span>] = handle(data2[<span class="number">4</span>:<span class="number">8</span>], <span class="number">0x7361645f</span>)</span><br><span class="line">data2[<span class="number">8</span>:<span class="number">12</span>] = handle(data2[<span class="number">8</span>:<span class="number">12</span>], <span class="number">0x65667463</span>)</span><br><span class="line">data2[<span class="number">12</span>:<span class="number">20</span>] = handle(data2[<span class="number">12</span>:<span class="number">20</span>], <span class="number">0x61645f79625f636e</span>)</span><br><span class="line">data2[<span class="number">20</span>:<span class="number">28</span>] = handle(data2[<span class="number">20</span>:<span class="number">28</span>], <span class="number">0x5f636e6566746373</span>)</span><br><span class="line">data2[<span class="number">28</span>:<span class="number">36</span>] = handle(data2[<span class="number">28</span>:<span class="number">36</span>], <span class="number">0x74637361645f7962</span>)</span><br><span class="line">data2[<span class="number">36</span>:<span class="number">40</span>] = handle(data2[<span class="number">36</span>:<span class="number">40</span>], <span class="number">0x636e6566</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data3)):</span><br><span class="line">    data3[i] ^= key[(i + <span class="number">3</span>) % <span class="number">13</span>]</span><br><span class="line"><span class="built_in">print</span>(data1[<span class="number">2</span>])</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.bmp&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">bytes</span>(data1 + data2 + data3))</span><br></pre></td></tr></table></figure><h1 id="unsym"><a href="#unsym" class="headerlink" title="unsym"></a>unsym</h1><p>è¿™é¢˜è¿˜æ˜¯æˆ‘æœ‰ç‚¹è¿·ï¼Œçœ‹wpçŸ¥æ™“æµç¨‹:</p><ol><li>è¾“å…¥å¯†é’¥</li><li>ç”¨RSAè§£å¯†ï¼Œn&#x3D;0x1d884d54d21694ccd120f145c8344b729b301e782c69a8f3073325b9c5ï¼Œe&#x3D;0x10001ï¼Œåˆ†è§£nï¼Œæ±‚å‡ºd</li><li>ç»“æœåº”è¯¥æ˜¯0xfad53ce897d2c26f8cad910417fbdd1f0f9a18f6c1748faca10299dc8</li><li>å°†ç»“æœå½“ä½œå¯†é’¥å’ŒIVè¿›è¡ŒAES CBCæ¨¡å¼è§£å¯†è§£encrypted.bin</li></ol><p><img src="/2023/06/23/DASCTF2023%E4%BA%8C%E8%BF%9B%E5%88%B6/image-20230623232435870.png"></p><p><img src="/2023/06/23/DASCTF2023%E4%BA%8C%E8%BF%9B%E5%88%B6/image-20230623232502821.png"></p><p><img src="/2023/06/23/DASCTF2023%E4%BA%8C%E8%BF%9B%E5%88%B6/image-20230623232520446.png" alt="result"></p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®‰æ´µæ¯2023-wp</title>
      <link href="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/"/>
      <url>/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/</url>
      
        <content type="html"><![CDATA[<h1 id="ez-cpp"><a href="#ez-cpp" class="headerlink" title="ez_cpp"></a>ez_cpp</h1><h2 id="æ­£å‘é€»è¾‘ï¼š"><a href="#æ­£å‘é€»è¾‘ï¼š" class="headerlink" title="æ­£å‘é€»è¾‘ï¼š"></a>æ­£å‘é€»è¾‘ï¼š</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_bit</span>(<span class="params">num, bit</span>):</span><br><span class="line">    result = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bit):</span><br><span class="line">        result |= ((num &gt;&gt; i) &amp; <span class="number">1</span>) &lt;&lt; (bit - i - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">b = <span class="string">&quot;SYC&#123;xxxxxxxxxxxxxxxxxxxxxxxx&#125;&quot;</span></span><br><span class="line">d = []</span><br><span class="line">c = <span class="number">0x1EF035</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b)):</span><br><span class="line">    eax = (c &amp; <span class="number">0xFFFF00</span>) + <span class="built_in">ord</span>(b[i]) - <span class="number">0x3D</span></span><br><span class="line">    <span class="keyword">if</span> eax &amp; <span class="number">0xFF</span> &lt; <span class="number">0x3E</span>:</span><br><span class="line">        v7 = <span class="built_in">ord</span>(b[i]) + <span class="number">13</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(b[i]) &gt; <span class="number">0x5A</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">ord</span>(b[i]) + <span class="number">13</span> &lt;= <span class="number">0x7A</span>:</span><br><span class="line">                d.append(<span class="built_in">ord</span>(b[i]) + <span class="number">13</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                d.append(<span class="built_in">ord</span>(b[i]) - <span class="number">13</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">ord</span>(b[i]) + <span class="number">13</span> &lt;= <span class="number">0x5A</span>:</span><br><span class="line">                d.append(<span class="built_in">ord</span>(b[i]) + <span class="number">13</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                d.append(<span class="built_in">ord</span>(b[i]) - <span class="number">13</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        d.append(<span class="built_in">ord</span>(b[i]))</span><br><span class="line">str2 = []</span><br><span class="line">v6 = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">16</span>:</span><br><span class="line">        str2.append(d[i] ^ <span class="number">4</span>)</span><br><span class="line">    <span class="keyword">elif</span> i &lt; <span class="number">16</span>:</span><br><span class="line">        <span class="keyword">if</span> v6[i] == <span class="number">1</span>:</span><br><span class="line">            str2.append(d[i] ^ <span class="number">9</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            str2.append(d[i] - <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">elif</span> i &gt; <span class="number">16</span>:</span><br><span class="line">        <span class="keyword">if</span> v6[i] == <span class="number">1</span>:</span><br><span class="line">            str2.append(d[i] ^ <span class="number">6</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            str2.append(d[i] - <span class="number">5</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    str2[i] = <span class="number">1</span> ^ (reverse_bit(str2[i], <span class="number">8</span>) + <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">hex</span>(i)[<span class="number">2</span>:] + <span class="string">&quot; &quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> str2))</span><br></pre></td></tr></table></figure><h2 id="é€†å‘é€»è¾‘"><a href="#é€†å‘é€»è¾‘" class="headerlink" title="é€†å‘é€»è¾‘"></a>é€†å‘é€»è¾‘</h2><p>å…¶ä¸­ç¬¬ä¸€ä¸ªåŠ å¯†ç”¨å¯è§å­—ç¬¦è¾“å…¥å¾—åˆ°å¯è§å­—ç¬¦è¾“å‡ºæ¥é€†ï¼Œå› æ­¤å¯èƒ½äº§ç”Ÿä¸€ä¸ªå­—ç¬¦å¯¹åº”å¤šä¸ªï¼Œæ‰€ä»¥ç­›æ‰çœ‹ä¸Šå»ä¸åƒçš„å°±å¥½äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_bit</span>(<span class="params">num, bit</span>):</span><br><span class="line">    result = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bit):</span><br><span class="line">        result |= ((num &gt;&gt; i) &amp; <span class="number">1</span>) &lt;&lt; (bit - i - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">v6 = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line">result = [<span class="number">0x00000022</span>, <span class="number">0xFFFFFFA2</span>, <span class="number">0x00000072</span>, <span class="number">0xFFFFFFE6</span>, <span class="number">0x00000052</span>, <span class="number">0xFFFFFF8C</span>, <span class="number">0xFFFFFFF2</span>, <span class="number">0xFFFFFFD4</span>, <span class="number">0xFFFFFFA6</span>,</span><br><span class="line">          <span class="number">0x0000000A</span>, <span class="number">0x0000003C</span>, <span class="number">0x00000024</span>, <span class="number">0xFFFFFFA6</span>, <span class="number">0xFFFFFF9C</span>, <span class="number">0xFFFFFF86</span>, <span class="number">0x00000024</span>, <span class="number">0x00000042</span>, <span class="number">0xFFFFFFD4</span>,</span><br><span class="line">          <span class="number">0x00000022</span>, <span class="number">0xFFFFFFB6</span>, <span class="number">0x00000014</span>, <span class="number">0x00000042</span>, <span class="number">0xFFFFFFCE</span>, <span class="number">0xFFFFFFAC</span>, <span class="number">0x00000014</span>, <span class="number">0x0000006A</span>, <span class="number">0x0000002C</span>,</span><br><span class="line">          <span class="number">0x0000007C</span>, <span class="number">0xFFFFFFE4</span>, <span class="number">0xFFFFFFE4</span>, <span class="number">0xFFFFFFE4</span>, <span class="number">0x0000001E</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    result[i] = result[i] &amp; <span class="number">0xFF</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    result[i] = reverse_bit((result[i] ^ <span class="number">1</span>) - <span class="number">1</span>, <span class="number">8</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">16</span>:</span><br><span class="line">        result[i] ^= <span class="number">4</span></span><br><span class="line">    <span class="keyword">elif</span> i &lt; <span class="number">16</span>:</span><br><span class="line">        <span class="keyword">if</span> v6[i] == <span class="number">1</span>:</span><br><span class="line">            result[i] ^= <span class="number">9</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[i] += <span class="number">2</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> v6[i] == <span class="number">1</span>:</span><br><span class="line">            result[i] ^= <span class="number">6</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[i] += <span class="number">5</span></span><br><span class="line">flag = []</span><br><span class="line">c1 = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">128</span>)]</span><br><span class="line">c2 = [<span class="number">32</span>, <span class="number">33</span>, <span class="number">34</span>, <span class="number">35</span>, <span class="number">36</span>, <span class="number">37</span>, <span class="number">38</span>, <span class="number">39</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">42</span>, <span class="number">43</span>, <span class="number">44</span>, <span class="number">45</span>, <span class="number">46</span>, <span class="number">47</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">54</span>, <span class="number">55</span>, <span class="number">56</span>, <span class="number">57</span>, <span class="number">58</span>, <span class="number">59</span>,</span><br><span class="line">      <span class="number">60</span>, <span class="number">74</span>, <span class="number">75</span>, <span class="number">76</span>, <span class="number">77</span>, <span class="number">78</span>, <span class="number">79</span>, <span class="number">80</span>, <span class="number">81</span>, <span class="number">82</span>, <span class="number">83</span>, <span class="number">84</span>, <span class="number">85</span>, <span class="number">86</span>, <span class="number">87</span>, <span class="number">88</span>, <span class="number">89</span>, <span class="number">90</span>, <span class="number">65</span>, <span class="number">66</span>, <span class="number">67</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">70</span>, <span class="number">71</span>, <span class="number">72</span>, <span class="number">73</span>, <span class="number">74</span>,</span><br><span class="line">      <span class="number">75</span>, <span class="number">76</span>, <span class="number">77</span>, <span class="number">104</span>, <span class="number">105</span>, <span class="number">106</span>, <span class="number">107</span>, <span class="number">108</span>, <span class="number">109</span>, <span class="number">110</span>, <span class="number">111</span>, <span class="number">112</span>, <span class="number">113</span>, <span class="number">114</span>, <span class="number">115</span>, <span class="number">116</span>, <span class="number">117</span>, <span class="number">118</span>, <span class="number">119</span>, <span class="number">120</span>, <span class="number">121</span>, <span class="number">122</span>, <span class="number">97</span>,</span><br><span class="line">      <span class="number">98</span>, <span class="number">99</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">102</span>, <span class="number">103</span>, <span class="number">104</span>, <span class="number">105</span>, <span class="number">106</span>, <span class="number">107</span>, <span class="number">108</span>, <span class="number">109</span>, <span class="number">123</span>, <span class="number">124</span>, <span class="number">125</span>, <span class="number">126</span>, <span class="number">127</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c2)):</span><br><span class="line">        <span class="keyword">if</span> result[i] == c2[j]:</span><br><span class="line">            flag.append(c1[j])</span><br><span class="line">    flag.append(<span class="built_in">ord</span>(<span class="string">&quot;\n&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> flag))</span><br><span class="line"><span class="comment"># SYC&#123;Y3S-yE5-y0u-S0Ve-Th3-C9P!!!&#125;</span></span><br></pre></td></tr></table></figure><h2 id="å…¶ä»–å¸ˆå‚…WPçš„æ€è·¯"><a href="#å…¶ä»–å¸ˆå‚…WPçš„æ€è·¯" class="headerlink" title="å…¶ä»–å¸ˆå‚…WPçš„æ€è·¯"></a>å…¶ä»–å¸ˆå‚…WPçš„æ€è·¯</h2><p>å…·ä½“å¯çœ‹ ğŸ‘‰ <a href="https://mp.weixin.qq.com/s?__biz=Mzg4MjcxMTAwMQ==&mid=2247487028&idx=1&sn=4a73d839a64b6c1071c519ed2195aa25&chksm=cf53ce82f8244794da9dd9b9034709ee5e71d8b3931a75fd87ac31d450869f87411054ea3ed9&mpshare=1&scene=23&srcid=0611rfRKf6I8RnGhn24J0TzY&sharer_sharetime=1686452556948&sharer_shareid=6eea79ff6da57fc6752ab0bc570bf392#rd">2023 å®‰æ´µæ¯SYCTF writeup by Arr3stY0u</a></p><p>ç”±äºæ•´ä½“çš„åŠ å¯†è¿‡ç¨‹æ˜¯å•ä¸ªå­—ç¬¦çš„åŠ å¯†ï¼Œå› æ­¤å¯ä»¥é€šè¿‡çˆ†ç ´ä¸€ä¸ªä¸ªå­—ç¬¦æ¥å¾—åˆ°flagã€‚</p><p>æ–¹æ³•ï¼špatchæ‰éƒ¨åˆ†ä»£ç ï¼Œä½¿<code>exitcode</code>ä¸ºç¬¦åˆæ¡ä»¶çš„å­—ç¬¦æ•°ã€‚</p><p>åŸä»£ç ï¼š</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611132142148.png" alt="åŸä»£ç "></p><p>patchåçš„ä»£ç ï¼š</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611132025951.png" alt="patchåçš„ä»£ç "></p><p>çˆ†ç ´è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">table = string.ascii_letters+string.digits+<span class="string">&#x27;!-&#123;&#125;&#x27;</span></span><br><span class="line">theflag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(theflag) &lt; <span class="number">32</span>:</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> table:</span><br><span class="line">        flag = (theflag+ch).ljust(<span class="number">32</span>, <span class="string">&#x27;#&#x27;</span>)</span><br><span class="line">        exitcode = os.system(<span class="string">f&quot;echo <span class="subst">&#123;flag&#125;</span> | ez_cpp.exe 1&gt;&amp;0&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;try: &quot;</span> + theflag + ch + <span class="string">&quot; exitcode:&quot;</span> + <span class="built_in">hex</span>(exitcode))</span><br><span class="line">        <span class="keyword">if</span> exitcode &gt;= <span class="built_in">len</span>(theflag) + <span class="number">1</span>:</span><br><span class="line">            theflag += ch</span><br><span class="line">            <span class="built_in">print</span>(theflag, exitcode)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(theflag + <span class="string">&#x27;not found&#x27;</span>)</span><br><span class="line">    time.sleep(<span class="number">0.1</span>)</span><br></pre></td></tr></table></figure><h1 id="3D-Maze"><a href="#3D-Maze" class="headerlink" title="3D_Maze"></a>3D_Maze</h1><p>äº†è§£é€»è¾‘ï¼Œè·å–è¿·å®«åæ‰‹åŠ¨èµ°èµ°ï¼ˆæ³¨æ„ï¼šzçš„é¡ºåºæ˜¯æœ‰è¦æ±‚çš„ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line">maze = [</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(maze)):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\nz=&quot;</span>+ <span class="built_in">str</span>(i//<span class="number">100</span>))</span><br><span class="line">    <span class="keyword">match</span> maze[i]:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> _:</span><br><span class="line">            <span class="built_in">print</span>(maze[i], end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment"># z=0</span></span><br><span class="line"><span class="comment"># ==1=======</span></span><br><span class="line"><span class="comment"># ==1====1==</span></span><br><span class="line"><span class="comment"># ==1=1111==</span></span><br><span class="line"><span class="comment"># ==1=1=====</span></span><br><span class="line"><span class="comment"># ==1=111111</span></span><br><span class="line"><span class="comment"># ==1=1=====</span></span><br><span class="line"><span class="comment"># ==11111111</span></span><br><span class="line"><span class="comment"># ==5=1=====</span></span><br><span class="line"><span class="comment"># ===*======</span></span><br><span class="line"><span class="comment"># ===1======</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># wddwwdddddD</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># z=1</span></span><br><span class="line"><span class="comment"># ==========</span></span><br><span class="line"><span class="comment"># =1111=====</span></span><br><span class="line"><span class="comment"># =1==111111</span></span><br><span class="line"><span class="comment"># =1========</span></span><br><span class="line"><span class="comment"># 11========</span></span><br><span class="line"><span class="comment"># ==========</span></span><br><span class="line"><span class="comment"># 11111=====</span></span><br><span class="line"><span class="comment"># ==========</span></span><br><span class="line"><span class="comment"># ==========</span></span><br><span class="line"><span class="comment"># ==========</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># dwwwdddsdddddD</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># z=2</span></span><br><span class="line"><span class="comment"># 1=========</span></span><br><span class="line"><span class="comment"># 1=========</span></span><br><span class="line"><span class="comment"># 1==1=1===1</span></span><br><span class="line"><span class="comment"># ==1=1=1=1=</span></span><br><span class="line"><span class="comment"># ==1====1==</span></span><br><span class="line"><span class="comment"># ===1===1==</span></span><br><span class="line"><span class="comment"># ====1==1==</span></span><br><span class="line"><span class="comment"># ==1=1==1==</span></span><br><span class="line"><span class="comment"># ===1===1==</span></span><br><span class="line"><span class="comment"># ==========</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># wwW</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># z=4</span></span><br><span class="line"><span class="comment"># ========11</span></span><br><span class="line"><span class="comment"># ========1=</span></span><br><span class="line"><span class="comment"># 111111111=</span></span><br><span class="line"><span class="comment"># ==========</span></span><br><span class="line"><span class="comment"># ==========</span></span><br><span class="line"><span class="comment"># ==========</span></span><br><span class="line"><span class="comment"># ==========</span></span><br><span class="line"><span class="comment"># ==========</span></span><br><span class="line"><span class="comment"># ==========</span></span><br><span class="line"><span class="comment"># ==========</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># assaaaaaaaaA</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># z=3</span></span><br><span class="line"><span class="comment"># ==1=======</span></span><br><span class="line"><span class="comment"># ==1=======</span></span><br><span class="line"><span class="comment"># ==1=11====</span></span><br><span class="line"><span class="comment"># ==11==1===</span></span><br><span class="line"><span class="comment"># ==11======</span></span><br><span class="line"><span class="comment"># ==11======</span></span><br><span class="line"><span class="comment"># ==11==1===</span></span><br><span class="line"><span class="comment"># ==1=11====</span></span><br><span class="line"><span class="comment"># ==1=======</span></span><br><span class="line"><span class="comment"># ==1=======</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># sssssssssS</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># z=5</span></span><br><span class="line"><span class="comment"># ===1======</span></span><br><span class="line"><span class="comment"># ===1======</span></span><br><span class="line"><span class="comment"># ===1======</span></span><br><span class="line"><span class="comment"># ===1======</span></span><br><span class="line"><span class="comment"># ===1======</span></span><br><span class="line"><span class="comment"># ==11======</span></span><br><span class="line"><span class="comment"># ==1=======</span></span><br><span class="line"><span class="comment"># 111=======</span></span><br><span class="line"><span class="comment"># ==========</span></span><br><span class="line"><span class="comment"># ==========</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># dddwwdwwwwwW</span></span><br><span class="line"><span class="comment"># w</span></span><br><span class="line"><span class="comment"># wddwwdddddDdwwwdddsdddddDwwWassaaaaaaaaAsssssssssSddwwdwwwwwWw</span></span><br></pre></td></tr></table></figure><h1 id="ezr3"><a href="#ezr3" class="headerlink" title="ezr3"></a>ezr3</h1><h2 id="è„±å£³"><a href="#è„±å£³" class="headerlink" title="è„±å£³"></a>è„±å£³</h2><p>åŠ äº†å£³ï¼Œä½†æ˜¯ç‰¹å¾ç è¢«è¦†ç›–äº†ï¼Œæ”¹å›UPXï¼Œç„¶åè„±å£³ï¼š</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611140348555.png" alt="ç‰¹å¾ç 1"></p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611140524739.png" alt="ç‰¹å¾ç 2"></p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611140408937.png" alt="ç‰¹å¾ç 3"></p><p>å…¶ä¸­ â€˜#â€™ çš„æ•°æ®ï¼š</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611140504793.png" alt="â€˜#â€™ çš„æ•°æ®â€”â€”æ¥è‡ªå…¶ä»–ç”¨UPXåŠ å£³çš„ELF"></p><h2 id="ç¨‹åºé€»è¾‘"><a href="#ç¨‹åºé€»è¾‘" class="headerlink" title="ç¨‹åºé€»è¾‘"></a>ç¨‹åºé€»è¾‘</h2><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611232914599.png" alt="ä¸»é€»è¾‘1"></p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611232937745.png" alt="ä¸»é€»è¾‘2"></p><p>ä¸»è¦å‡½æ•°ä¸º<code>v(), p()</code>ã€‚</p><p><code>v()</code>ï¼šæ›´æ”¹ä¸€äº›æ•°æ®ã€‚</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611234030720.png" alt="vå‡½æ•°"></p><p><code>p()</code>ï¼šå¤„ç†è¾“å…¥ç„¶åæ¯”å¯¹ã€‚</p><ul><li>å¤„ç†è¾“å…¥ï¼š<ul><li><code>input[i] = (input[i] &gt;&gt; 4) || (input[i] &lt;&lt; 4)</code></li><li><code>input[i] = input[i] ^ input[len(input) - i]</code></li></ul></li></ul><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611234055600.png" alt="på‡½æ•°"></p><h2 id="è„šæœ¬"><a href="#è„šæœ¬" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h2><p>è¿‡ç¨‹ä¸­çš„æ•°æ®å¯é€šè¿‡åŠ¨è°ƒè·å¾—ï¼Œè¿˜æ²¡è¯•ï¼Œä¹‹åå†è¯•è¯•æŠŠã€‚&#x2F;(ã„’oã„’)&#x2F;&#x2F;(ã„’oã„’)&#x2F;</p><h1 id="snake"><a href="#snake" class="headerlink" title="snake"></a>snake</h1><p>ä¸€ä¸ªè´ªåƒè›‡æ¸¸æˆï¼Œæ­»åä¼šç”Ÿæˆä¸€ä¸ªflagï¼Œåªæœ‰è›‡åˆ°361é•¿åº¦ç”Ÿæˆçš„flagæ‰æ˜¯çœŸçš„flagï¼ˆæ¯”èµ›çš„æ—¶å€™ä¸€ç›´ä¸çŸ¥é“è¿™é¢˜è¦å¹²å˜›ï¼‰ï¼Œçœ‹äº†å…¶ä»–å¸ˆå‚…çš„wpæ‰çŸ¥é“ã€‚</p><h2 id="ç¨‹åºä¸»é€»è¾‘"><a href="#ç¨‹åºä¸»é€»è¾‘" class="headerlink" title="ç¨‹åºä¸»é€»è¾‘"></a>ç¨‹åºä¸»é€»è¾‘</h2><p>ç”±äºè·å–flagçš„è¿‡ç¨‹ä¸æ¸¸æˆå…³ç³»ä¸å¤§ï¼Œæ‰€ä»¥æ¸¸æˆéƒ¨åˆ†é€»è¾‘ä¸é˜è¿°ã€‚</p><p>mainå‡½æ•°ä¸­ï¼Œåˆå§‹åŒ–è›‡ï¼Œèº«å­ç”¨é“¾è¡¨æ¥å®ç°ï¼Œæ¯èŠ‚èº«å­æœ‰å®ƒçš„ä½ç½®xã€yä»¥åŠå…¶ä»–ä¿¡æ¯ã€‚</p><p>è›‡çš„èº«å­é•¿åº¦ä¸€å¼€å§‹ä¸º3ï¼Œå¯é€šè¿‡åŠ¨è°ƒå¾—åˆ°ã€‚</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611151313654.png" alt="åˆå§‹åŒ–è›‡"></p><p>è·å–éšæœºæ•°åºåˆ—ï¼Œåœ¨ä¹‹åçš„æœå®ç”Ÿæˆä»¥åŠåŠ å¯†ä¼šç”¨åˆ°ï¼š</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611151725890.png" alt="éšæœºæ•°åºåˆ—"></p><p>åœ¨ç¨‹åºæ¸¸æˆæ¯è½®çš„è¿›è¡Œä¸­ï¼Œéƒ½ä¼šæ›´æ–°åˆ†æ•°ä»¥åŠå…¶å®ƒç»†èŠ‚ï¼š</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611152126183.png" alt="æ¸¸æˆæ›´æ–°"></p><p>å½“è›‡åƒåˆ°æœå®æ—¶ï¼Œå°±ä¼šè¿›å…¥ifè¯­å¥ï¼Œæœ€å<code>CxxThrowException</code>æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œå…·ä½“å¤„ç†åœ¨æ±‡ç¼–ä»£ç å¤„å¯ä»¥çœ‹å‡ºï¼š</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611152426840.png" alt="å¤„ç†å¼‚å¸¸"></p><p>æŠ›å‡ºå¼‚å¸¸æ‰§è¡Œçš„åœ°æ–¹åº”è¯¥æ˜¯<code>0x401E92</code>å¤„ï¼Œå°†å‰é¢è·³åˆ°<code>0x401F92</code>çš„è·³è½¬æŒ‡ä»¤æ”¹æˆè·³è½¬è‡³<code>0x401E92</code>å¤„ï¼Œå¯ä»¥è·å–åæ±‡ç¼–ä»£ç ï¼š</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611181440981.png" alt="è›‡åƒåˆ°æœå®çš„å¤„ç†"></p><ol><li><p>ç¨‹åºæ›´æ–°æœ€åå°†ä¼šè¢«ç”Ÿæˆmd5çš„æ•°æ®ä¸ºç›®å‰çš„è›‡çš„å„èŠ‚ç‚¹çš„ç¬¬äº”ä¸ªæ•°æ®ã€‚</p></li><li><p>å¯¹æ•°æ®è¿›è¡Œä¸€æ¬¡RC4åŠ å¯†ã€‚</p></li><li><p>å€’è½¬è›‡èŠ‚ç‚¹çš„æ•°æ®ï¼Œå³å°†åŠ å¯†åçš„<code>will_be_md5</code>åè½¬æ”¾å…¥è›‡çš„èŠ‚ç‚¹ã€‚ï¼ˆ<code>dword_C1DEA4</code>çš„ä¸‹ä¸€ä¸ªåœ°å€å°±æ˜¯<code>will_be_md5</code>ï¼‰</p></li><li><p>æ–°å¢ä¸€ä¸ªè›‡èŠ‚ç‚¹<code>node</code>ï¼Œå…¶<code>node[5]</code>ä¸º<code>index_data</code>ï¼ŒåŒæ—¶æ›´æ–°<code>index_data</code>ï¼ˆæœ€å¼€å§‹ä¸º0x92ï¼‰ä¸º<code>(index_data - 1) ^ (final_node[5] - 1)</code>ï¼Œå…¶ä¸­final_nodeä¸ºè›‡æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼ˆä¸åŒ…æ‹¬æ–°å¢çš„ï¼‰ã€‚</p></li></ol><p>æ–°çš„æœå®çš„ç”Ÿæˆï¼š</p><p>ç”±äº<code>dowrd_4BDEA4</code>å½“è›‡åƒåˆ°æœå®æ—¶ä¸º0ï¼Œå› æ­¤å½“èµ°æœå®ç”Ÿæˆçš„æ¡ä»¶åˆ†æ”¯æ—¶ï¼Œè›‡çš„ä½ç½®å’Œæœå®çš„ä½ç½®ä¸€å®šç›¸åŒï¼Œå› æ­¤ä¼šèµ°ç¬¬ä¸€ä¸ªæ¡ä»¶åˆ†æ”¯ï¼šç”±éšæœºæ•°åºåˆ—çš„ä¸€ä¸ªæ•°ä½œä¸ºç§å­æ¥ç”Ÿæˆæœå®ä½ç½®ã€‚</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611170551372.png" alt="æœå®ç”Ÿæˆ"></p><h2 id="RC4-for-dataçš„é€»è¾‘"><a href="#RC4-for-dataçš„é€»è¾‘" class="headerlink" title="RC4_for_dataçš„é€»è¾‘"></a>RC4_for_dataçš„é€»è¾‘</h2><p>æ•´ä½“æµç¨‹å°±æ˜¯RC4ã€‚</p><p>RC4çš„keyæ˜¯ä»¥è›‡çš„ä½ç½®ä½œä¸ºç§å­ï¼Œè¿ç»­ç”Ÿæˆçš„éšæœºæ•°ï¼Œè€Œç”±äºåªæœ‰è›‡åƒåˆ°æœå®æ‰èƒ½è¿›å…¥è¿™ä¸ªå‡½æ•°ï¼Œå› æ­¤ä¹Ÿæ˜¯æœå®çš„ä½ç½®ã€‚</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611165503791.png" alt="RC4åˆå§‹åŒ–"></p><p>å…ˆå°†RC4åŠ å¯†å¼‚æˆ–çš„å€¼å­˜å‚¨ä¸‹æ¥ï¼Œç„¶ååœ¨ä¸‹é¢å¼‚æˆ–æ•°æ®ï¼Œå¼‚æˆ–çš„å¤„ç†æ— è®ºèµ°å“ªä¸ªæ¡ä»¶åˆ†æ”¯éƒ½å°†æ•°æ®ä¸ä¸Šé¢ä¿å­˜çš„å¼‚æˆ–æ•°æ®è¿›è¡Œå¼‚æˆ–ã€‚</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611163658407.png" alt="åŠ å¯†"></p><h2 id="flagç”Ÿæˆ"><a href="#flagç”Ÿæˆ" class="headerlink" title="flagç”Ÿæˆ"></a>flagç”Ÿæˆ</h2><p>è·å–æ•°æ®ï¼Œç”Ÿæˆmd5ï¼š</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611164021052.png" alt="flagç”Ÿæˆå‡½æ•°"></p><h2 id="è„šæœ¬-1"><a href="#è„šæœ¬-1" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h2><p>è´´ä¸€ä¸ªå…¶ä»–å¸ˆå‚…çš„è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">libc = ctypes.CDLL(<span class="string">&quot;ucrtbase.dll&quot;</span>)</span><br><span class="line">libc.srand.argtypes = [ctypes.c_uint]</span><br><span class="line">libc.rand.restype = ctypes.c_int</span><br><span class="line"></span><br><span class="line">srand = libc.srand</span><br><span class="line">rand = libc.rand</span><br><span class="line"></span><br><span class="line">srand(<span class="number">0x94307F97</span>)</span><br><span class="line">seed_list = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">361</span>):</span><br><span class="line">    seed_list.append(rand())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">buf, size, seed</span>):</span><br><span class="line">    srand(seed)</span><br><span class="line">    keysize = <span class="built_in">int</span>(rand()*<span class="number">1.0</span>/<span class="number">32767.0</span> * <span class="number">256.0</span>)</span><br><span class="line">    table = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\x00&#x27;</span></span><br><span class="line">    pwd = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(keysize):</span><br><span class="line">        idx = <span class="built_in">int</span>(rand()*<span class="number">1.0</span> / <span class="number">32767.0</span> * <span class="number">63.0</span>)</span><br><span class="line">        pwd += table[idx]</span><br><span class="line"></span><br><span class="line">    cipher = ARC4.ARC4Cipher(pwd.encode())</span><br><span class="line">    xorstream = <span class="string">b&#x27;\x00&#x27;</span>*size</span><br><span class="line">    xorstream = cipher.encrypt(xorstream)</span><br><span class="line">    outbuf = <span class="built_in">bytearray</span>(buf)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(size):</span><br><span class="line">        outbuf[i] ^= xorstream[i]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(outbuf)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">foods = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">361</span>):</span><br><span class="line">    srand(seed_list[i])</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        y = rand() % <span class="number">20</span></span><br><span class="line">        x = rand() % <span class="number">20</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (x == <span class="number">0</span> <span class="keyword">or</span> x == <span class="number">19</span> <span class="keyword">or</span> y == <span class="number">0</span> <span class="keyword">or</span> y == <span class="number">19</span>):</span><br><span class="line">            <span class="comment"># print(i, y, x)</span></span><br><span class="line">            foods.append((y, x))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">tmp = <span class="number">0x92</span></span><br><span class="line"></span><br><span class="line">data = <span class="string">b&#x27;\x02&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    data += <span class="built_in">bytes</span>([data[-<span class="number">1</span>] ^ <span class="number">0xBE</span>])</span><br><span class="line"><span class="comment"># print(data.hex())</span></span><br><span class="line"></span><br><span class="line">flag_data = data[:]</span><br><span class="line">eat_count = <span class="number">361</span> <span class="comment"># åˆå§‹é•¿åº¦å°±æ˜¯3, ä½†æ˜¯è¦æ±‚åƒ361ä¸ª ???</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(eat_count):</span><br><span class="line">    y, x = foods[i]</span><br><span class="line">    pos = y &lt;&lt; <span class="number">8</span> | x</span><br><span class="line">    data = enc(data, <span class="number">3</span>+i, pos)</span><br><span class="line">    <span class="comment"># print(data.hex())</span></span><br><span class="line"></span><br><span class="line">    _tmp = tmp</span><br><span class="line">    <span class="comment"># print(hex(tmp-1), hex(data[0]-1))</span></span><br><span class="line">    tmp = ((tmp-<span class="number">1</span>) ^ (data[<span class="number">0</span>]-<span class="number">1</span>)) &amp; <span class="number">0xFF</span></span><br><span class="line">    flag_data = data[:]</span><br><span class="line">    data = data[::-<span class="number">1</span>]</span><br><span class="line">    data += <span class="built_in">bytes</span>([_tmp])</span><br><span class="line">    <span class="comment"># print(hex(tmp))</span></span><br><span class="line"></span><br><span class="line">s = flag_data.ljust(<span class="number">361</span>, <span class="string">b&#x27;\x00&#x27;</span>).<span class="built_in">hex</span>().encode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag_data&#x27;</span>, <span class="built_in">len</span>(flag_data))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;SYC&#123;&#x27;</span>+md5(s[:<span class="number">722</span>]).hexdigest()+<span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure><h1 id="babyThread"><a href="#babyThread" class="headerlink" title="babyThread"></a>babyThread</h1><h2 id="é€»è¾‘"><a href="#é€»è¾‘" class="headerlink" title="é€»è¾‘"></a>é€»è¾‘</h2><p>æµç¨‹å¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯åŠ å¯†å’Œæ¯”å¯¹ï¼Œä¸»è¦æ˜¯åˆ¤æ–­ç”Ÿæˆå¯†é’¥çš„å­—ç¬¦ä¸²æ˜¯å“ªä¸€ä¸ªã€‚</p><p>åŠ å¯†è¿‡ç¨‹ï¼š</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611200355369.png" alt="åŠ å¯†è¿‡ç¨‹"></p><p>ä¸»è¿‡ç¨‹ï¼š</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611200429997.png" alt="ä¸»è¿‡ç¨‹"></p><p>ä¸‰ä¸ªå¯†é’¥ï¼ˆä¸‰ä¸ªåªæœ‰ä¸€ä¸ªæ˜¯è¢«ç”¨åˆ°çš„ï¼‰ï¼š</p><ol><li><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611200618444.png" alt="ç¬¬ä¸€ä¸ªå¯†é’¥"></li><li><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611200531434.png" alt="ç¬¬äºŒä¸ªå¯†é’¥"></li><li><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611200559786.png" alt="ç¬¬ä¸‰ä¸ªå¯†é’¥"></li></ol><p>æ‰€ä»¥ç›´æ¥ä¸‰ä¸ªéƒ½è¯•ä¸€ä¸‹ã€‚</p><h2 id="è„šæœ¬-2"><a href="#è„šæœ¬-2" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">rc4_init</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>*key, <span class="type">unsigned</span> <span class="type">long</span> Len, <span class="type">unsigned</span> <span class="type">char</span>*s)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> k[<span class="number">256</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> tmp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i&lt;<span class="number">256</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">s[i] = i;</span><br><span class="line">k[i] = (<span class="type">unsigned</span> <span class="type">char</span>)key[i%Len];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i&lt;<span class="number">256</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">        j = (j + s[i] + k[i]) % <span class="number">256</span>;</span><br><span class="line">tmp = s[i];</span><br><span class="line">s[i] = s[j];</span><br><span class="line">s[j] = tmp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">rc4_crypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>*s, <span class="type">unsigned</span> <span class="type">char</span>*Data, <span class="type">unsigned</span> <span class="type">long</span> Len)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, t = <span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> k = <span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> tmp;</span><br><span class="line"><span class="keyword">for</span> (k = <span class="number">0</span>; k&lt;Len; k++)</span><br><span class="line">&#123;</span><br><span class="line">i = (i + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">j = (j + s[i]) % <span class="number">256</span>;</span><br><span class="line">tmp = s[i];</span><br><span class="line">s[i] = s[j];</span><br><span class="line">s[j] = tmp;</span><br><span class="line">t = (s[i] + s[j]) % <span class="number">256</span>;</span><br><span class="line">Data[k] ^= s[t];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> v8[<span class="number">7</span>];</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, i_ = <span class="number">0</span>, j = <span class="number">0</span>, j_, t;</span><br><span class="line">    <span class="type">int</span> v4, v9;</span><br><span class="line">    <span class="comment">// char Str[100] = &quot;FD,B0?YORg@:*VTCLnY4&quot;;</span></span><br><span class="line">    <span class="comment">// char Str[100] = &quot;D..^!ARBIh@;K:dAU-K`&quot;;</span></span><br><span class="line">    <span class="comment">// char Str[100] = &quot;!This_program_cannot&quot;;</span></span><br><span class="line">    <span class="type">char</span> Str[<span class="number">21</span>];</span><br><span class="line">    FILE * f = fopen(<span class="string">&quot;./babyThread.exe&quot;</span>, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">    fseek(f, <span class="number">0x4D</span>, <span class="number">0</span>);</span><br><span class="line">    fread(Str, <span class="number">1</span>, <span class="number">0x14</span>, f);</span><br><span class="line">    fclose(f);</span><br><span class="line">    </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">24</span>];</span><br><span class="line">    v8[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    v8[<span class="number">1</span>] = <span class="number">85</span>;</span><br><span class="line">    v8[<span class="number">2</span>] = <span class="number">0x1C39</span>;</span><br><span class="line">    v8[<span class="number">3</span>] = <span class="number">0x95EED</span>;</span><br><span class="line">    v8[<span class="number">4</span>] = <span class="number">0x31C84B1</span>;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>, i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(Str); j += <span class="number">4</span>, i += <span class="number">5</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        v9 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (t = <span class="number">0</span>; t &lt; <span class="number">5</span>; ++t)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (Str[t + i] == <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">                key[t + j] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                v9 += v8[<span class="number">4</span> - t] * (Str[t + i] - <span class="number">33</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        key[j + <span class="number">3</span>] = (*((<span class="type">char</span> *)&amp;v9));</span><br><span class="line">        key[j + <span class="number">2</span>] = (*((<span class="type">char</span> *)&amp;v9 + <span class="number">1</span>));</span><br><span class="line">        key[j + <span class="number">1</span>] = (*((<span class="type">char</span> *)&amp;v9 + <span class="number">2</span>));</span><br><span class="line">        key[j] = (*((<span class="type">char</span> *)&amp;v9 + <span class="number">3</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> data[<span class="number">32</span>] = &#123;</span><br><span class="line">        <span class="number">0xDE</span>, <span class="number">0x1C</span>, <span class="number">0x22</span>, <span class="number">0x27</span>, <span class="number">0x1D</span>, <span class="number">0xAE</span>, <span class="number">0xAD</span>, <span class="number">0x65</span>, <span class="number">0xAD</span>, <span class="number">0xEF</span>, </span><br><span class="line">        <span class="number">0x6E</span>, <span class="number">0x41</span>, <span class="number">0x4C</span>, <span class="number">0x34</span>, <span class="number">0x75</span>, <span class="number">0xF1</span>, <span class="number">0x16</span>, <span class="number">0x50</span>, <span class="number">0x50</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0x48</span>, <span class="number">0x69</span>, <span class="number">0x6D</span>, <span class="number">0x93</span>, <span class="number">0x36</span>, <span class="number">0x1C</span>, <span class="number">0x86</span>, <span class="number">0x3B</span>, <span class="number">0xBB</span>, <span class="number">0xD0</span>, </span><br><span class="line">        <span class="number">0x4C</span>, <span class="number">0x91</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">char</span> s[<span class="number">264</span>];</span><br><span class="line">    rc4_init(key, <span class="number">16</span>, s);</span><br><span class="line">    rc4_crypt(s, data, <span class="number">32</span>);</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i&lt;<span class="number">32</span> ; i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="gowhere"><a href="#gowhere" class="headerlink" title="gowhere"></a>gowhere</h1><p>ç”¨IDAGolangè„šæœ¬è¿˜åŸç¬¦å·ã€å‡½æ•°åç§°ã€‚</p><p>å¤§æ¦‚çš„é€»è¾‘æ˜¯è¾“å…¥30ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œè¿›è¡Œä¸‰è½®ä¸‰ä¸ªå‡½æ•°åŠ å¯†ç„¶åä¸å¯†æ–‡æ¯”å¯¹ã€‚</p><h2 id="å‡½æ•°ä¸€é€»è¾‘"><a href="#å‡½æ•°ä¸€é€»è¾‘" class="headerlink" title="å‡½æ•°ä¸€é€»è¾‘"></a>å‡½æ•°ä¸€é€»è¾‘</h2><p>é€»è¾‘ï¼š<code>input = (input + enc1_key) ^ 0x17</code></p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611210036323.png" alt="åŠ å¯†ä¸€"></p><p>ä¸»è¦æ˜¯å¯»æ‰¾<code>enc1_key</code>çš„å˜åŒ–ã€‚</p><p><code>enc_key1</code>åˆå§‹ä¸º9ã€‚</p><p>æ¯æ¬¡è¿›å…¥<code>main_enc1()</code>æ—¶ï¼Œ<code>enc_key1</code>ä¼šåŠ ä¸€ï¼š</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611210240590.png" alt="enc_key1å˜åŒ–"></p><p>æ¯æ¬¡è¿›å…¥<code>main_enc2()</code>æ—¶ï¼Œ<code>enc_key1</code>ä¹Ÿä¼šåŠ ä¸€ï¼š</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611210358258.png" alt="enc_key1å˜åŒ–"></p><p>æ¯æ¬¡è¿›å…¥<code>main_enc3()</code>æ—¶ï¼Œ<code>enc_key1</code>ä¹Ÿä¼šåŠ ä¸€ï¼š</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611210443173.png" alt="enc_key1å˜åŒ–"></p><h2 id="å‡½æ•°äºŒé€»è¾‘"><a href="#å‡½æ•°äºŒé€»è¾‘" class="headerlink" title="å‡½æ•°äºŒé€»è¾‘"></a>å‡½æ•°äºŒé€»è¾‘</h2><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611210608263.png" alt="å‡½æ•°äºŒ"></p><h2 id="å‡½æ•°ä¸‰é€»è¾‘"><a href="#å‡½æ•°ä¸‰é€»è¾‘" class="headerlink" title="å‡½æ•°ä¸‰é€»è¾‘"></a>å‡½æ•°ä¸‰é€»è¾‘</h2><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611211829162.png" alt="å‡½æ•°ä¸‰"></p><h2 id="ä¸»é€»è¾‘"><a href="#ä¸»é€»è¾‘" class="headerlink" title="ä¸»é€»è¾‘"></a>ä¸»é€»è¾‘</h2><p>ä¸‰ä¸ªåŠ å¯†çš„ä»£ç ç‰‡æ®µéƒ½å¼„æ‡‚äº†ï¼Œä½†è°ƒç”¨çš„é¡ºåºå´æ²¡æœ‰ï¼Œç¨‹åºçš„å…·ä½“é€»è¾‘æˆ‘è¿˜æ²¡æœ‰å¼„æ‡‚ã€‚</p><p>åˆ†åˆ«ä¸ºä¸‰ä¸ªåŠ å¯†çš„ä»£ç ç‰‡æ®µèµ°è¿‡ä¸”æ¯æ¬¡åŠ å¯†åªèµ°ä¸€æ¬¡çš„ä»£ç ä¸‹æ¡ä»¶æ–­ç‚¹ï¼Œæ‰“å°ä¸€äº›ä¿¡æ¯ï¼š</p><p><img src="/2023/06/11/%E5%AE%89%E6%B4%B5%E6%9D%AF2023-wp/image-20230611215638395.png" alt="æ–­ç‚¹ä¿¡æ¯"></p><p>å¯ä»¥çŸ¥æ™“åŠ å¯†æµç¨‹ï¼šenc1-2-3-2-3-1-2-3-2-3</p><h2 id="è„šæœ¬-3"><a href="#è„šæœ¬-3" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dec1</span>(<span class="params">data, key</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">        data[i] = (data[i] ^ <span class="number">0x17</span>) - key</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec2</span>(<span class="params"><span class="built_in">input</span></span>):</span><br><span class="line">    <span class="built_in">input</span>[<span class="number">0</span>] -= <span class="number">2</span></span><br><span class="line">    <span class="built_in">input</span>[<span class="number">1</span>] += <span class="number">28</span></span><br><span class="line">    <span class="built_in">input</span>[<span class="number">2</span>] ^= <span class="number">0x47</span></span><br><span class="line">    <span class="built_in">input</span>[<span class="number">3</span>] -= <span class="built_in">input</span>[<span class="number">4</span>]</span><br><span class="line">    <span class="built_in">input</span>[<span class="number">5</span>] -= <span class="number">73</span></span><br><span class="line">    <span class="built_in">input</span>[<span class="number">6</span>] -= <span class="number">12</span></span><br><span class="line">    <span class="built_in">input</span>[<span class="number">8</span>] ^= <span class="number">0x5A</span></span><br><span class="line">    <span class="built_in">input</span>[<span class="number">7</span>] += <span class="built_in">input</span>[<span class="number">8</span>]</span><br><span class="line">    <span class="built_in">input</span>[<span class="number">9</span>] ^= <span class="number">0x22</span></span><br><span class="line">    <span class="built_in">input</span>[<span class="number">10</span>] -= <span class="number">20</span></span><br><span class="line">    <span class="built_in">input</span>[<span class="number">12</span>] += <span class="number">84</span></span><br><span class="line">    <span class="built_in">input</span>[<span class="number">13</span>] ^= <span class="number">4</span></span><br><span class="line">    <span class="built_in">input</span>[<span class="number">14</span>] ^= <span class="number">0x1C</span></span><br><span class="line">    <span class="built_in">input</span>[<span class="number">17</span>] += <span class="number">1</span></span><br><span class="line">    <span class="built_in">input</span>[<span class="number">27</span>] ^= <span class="number">0x11</span></span><br><span class="line">    <span class="built_in">input</span>[<span class="number">28</span>] ^= <span class="number">3</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">input</span>)):</span><br><span class="line">        <span class="built_in">input</span>[i] &amp;= <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">input</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec3</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data) // <span class="number">2</span>):</span><br><span class="line">        data[i], data[<span class="number">29</span>-i] = data[<span class="number">29</span>-i], data[i]</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = [</span><br><span class="line">    <span class="number">0x4D</span>, <span class="number">0x63</span>, <span class="number">0x5D</span>, <span class="number">0x34</span>, <span class="number">0x43</span>, <span class="number">0x09</span>, <span class="number">0xA2</span>, <span class="number">0x77</span>, <span class="number">0x0A</span>, <span class="number">0xBF</span>,</span><br><span class="line">    <span class="number">0xC9</span>, <span class="number">0xB3</span>, <span class="number">0xE9</span>, <span class="number">0x6F</span>, <span class="number">0x79</span>, <span class="number">0x7D</span>, <span class="number">0x7B</span>, <span class="number">0xE8</span>, <span class="number">0x99</span>, <span class="number">0x90</span>,</span><br><span class="line">    <span class="number">0x43</span>, <span class="number">0x08</span>, <span class="number">0xBB</span>, <span class="number">0x99</span>, <span class="number">0x0E</span>, <span class="number">0x2E</span>, <span class="number">0xD4</span>, <span class="number">0x7B</span>, <span class="number">0x27</span>, <span class="number">0xB7</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">flag = dec3(flag)</span><br><span class="line">flag = dec2(flag)</span><br><span class="line">flag = dec3(flag)</span><br><span class="line">flag = dec2(flag)</span><br><span class="line">flag = dec1(flag, <span class="number">16</span>)</span><br><span class="line">flag = dec3(flag)</span><br><span class="line">flag = dec2(flag)</span><br><span class="line">flag = dec3(flag)</span><br><span class="line">flag = dec2(flag)</span><br><span class="line">flag = dec1(flag, <span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> flag))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤©å ‚ä¹‹é—¨åŸç†</title>
      <link href="/2023/05/10/%E5%A4%A9%E5%A0%82%E4%B9%8B%E9%97%A8%E5%8E%9F%E7%90%86/"/>
      <url>/2023/05/10/%E5%A4%A9%E5%A0%82%E4%B9%8B%E9%97%A8%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ¬ç¯‡æ–‡ç« ä»…ä¸ºçœ‹wpå­¦ä¹ åˆ°çš„å¤©å ‚ä¹‹é—¨æŠ€æœ¯åšä¸ªæ€»ç»“ã€‚</p><p>å…·ä½“å­¦ä¹ ï¼Œçœ‹çœ‹è¿™äº›âœŒï¼š</p><p>ğŸ‘‰<a href="http://blog.bluesadi.cn:4000/2021/11/06/%E5%A4%A9%E5%A0%82%E4%B9%8B%E9%97%A8-Heaven-s-Gate-C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0/">å¤©å ‚ä¹‹é—¨ (Heavenâ€™s Gate) Cè¯­è¨€å®ç° | 34r7hm4nâ€™s blog (bluesadi.cn)</a> ğŸ‘ˆè®²å¾—å¾ˆç»†ï¼Œçœ‹å®Œå°±æ‡‚</p><p>ğŸ‘‰<a href="http://s0rry.cn/archives/tian-tang-zhi-men-heavensgate#toc-head-2">å¤©å ‚ä¹‹é—¨ (Heavenâ€™s Gate) - s0rryâ€™s Blog</a></p><h1 id="WoW64"><a href="#WoW64" class="headerlink" title="WoW64"></a>WoW64</h1><p>WOW64ï¼ˆWindows-On-Windows 64bitï¼‰æ˜¯X64 Windowsæ“ä½œç³»ç»Ÿçš„ä¸€ä¸ªå­ç³»ç»Ÿï¼Œä¸º32ä½åº”ç”¨ç¨‹åºæä¾›è¿è¡Œç¯å¢ƒã€‚ç±»ä¼¼çš„è¿˜æœ‰WOW32å­ç³»ç»Ÿï¼Œè´Ÿè´£åœ¨32ä½Windowsç³»ç»Ÿä¸Šè¿è¡Œ16ä½åº”ç”¨ç¨‹åºã€‚</p><p>åœ¨64ä½ç³»ç»Ÿä¸­ï¼Œ32ä½çš„åº”ç”¨ç¨‹åºè¿è¡Œåœ¨ä¸€ä¸ªWoW64çš„å­ç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªå­ç³»ç»Ÿä¸º32ä½ç¨‹åºæä¾›äº†ä¸€ä¸ªç±»ä¼¼æ²™ç®±çš„è¿è¡Œç¯å¢ƒã€‚äº‹å®ä¸Šè¿™ä¸ª32ä½ç¨‹åºè¿è¡Œçš„ç¯å¢ƒä¹Ÿæ˜¯ä¸€ä¸ª64ä½çš„è¿è¡Œç¯å¢ƒï¼Œç³»ç»Ÿåœ¨åˆ›å»º32ä½è¿›ç¨‹æ—¶ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ª64ä½çš„è¿›ç¨‹ï¼Œç„¶åå†åœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ª32ä½çš„å­ç¯å¢ƒã€‚32ä½ç¨‹åºæ‰€è°ƒç”¨çš„ç³»ç»Ÿå‡½æ•°ï¼Œæœ€ç»ˆéƒ½è¦é€šè¿‡64ä½çš„åŠ¨æ€é“¾æ¥åº“è€Œå®ç°ã€‚</p><p>Winodwsç³»ç»Ÿä¸­ï¼ŒCSæ®µå¯„å­˜å™¨ç”¨æ¥æ ‡è¯†ç›®å‰æ‰€è¿è¡Œçš„ä»£ç æ˜¯32ä½çš„ï¼Œè¿˜æ˜¯64ä½çš„ã€‚</p><p>ä»¥ä¸€ä¸ªä½¿ç”¨å¤©å ‚ä¹‹é—¨çš„ç¨‹åºä¸ºä¾‹ï¼Œå…¶ä¸º64ä½ç¨‹åºã€‚</p><p>ä¸€å¼€å§‹ä¸º64ä½æ¨¡å¼ï¼š</p><p><img src="/2023/05/10/%E5%A4%A9%E5%A0%82%E4%B9%8B%E9%97%A8%E5%8E%9F%E7%90%86/image-20230510114220317.png" alt="64ä½ç¨‹åºçš„CSå¯„å­˜å™¨"></p><p>åˆ‡æ¢åˆ°32ä½æ¨¡å¼åï¼š</p><p><img src="/2023/05/10/%E5%A4%A9%E5%A0%82%E4%B9%8B%E9%97%A8%E5%8E%9F%E7%90%86/image-20230510114530659.png" alt="åˆ‡æ¢åˆ°32ä½æ¨¡å¼"></p><h1 id="å¤©å ‚ä¹‹é—¨å®ç°"><a href="#å¤©å ‚ä¹‹é—¨å®ç°" class="headerlink" title="å¤©å ‚ä¹‹é—¨å®ç°"></a>å¤©å ‚ä¹‹é—¨å®ç°</h1><h2 id="32ä½å’Œ64ä½ä¹‹é—´çš„è½¬åŒ–"><a href="#32ä½å’Œ64ä½ä¹‹é—´çš„è½¬åŒ–" class="headerlink" title="32ä½å’Œ64ä½ä¹‹é—´çš„è½¬åŒ–"></a>32ä½å’Œ64ä½ä¹‹é—´çš„è½¬åŒ–</h2><p>32ä½ â†’ 64ä½ï¼š</p><ul><li>å°†<code>0x33</code>å…¥æ ˆ</li><li>å°†64ä½æŒ‡ä»¤åœ°å€å…¥æ ˆ</li><li><code>retf</code> è¿œè¿”å›ï¼šå…ˆå–è¿”å›åœ°å€ï¼Œå†å–<code>0x33</code>ä½œä¸ºCSå¯„å­˜å™¨ï¼Œå› æ­¤è·³è½¬çš„åœ°å€ä¸º<code>0x33:64ä½æŒ‡ä»¤åœ°å€</code></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">push 0x33</span><br><span class="line">push _next_x64_code</span><br><span class="line">retf</span><br></pre></td></tr></table></figure><p>64ä½ â†’ 32ä½ï¼š</p><ul><li>å°†<code>0x23</code>å…¥æ ˆ</li><li>å°†32ä½æŒ‡ä»¤åœ°å€å…¥æ ˆ</li><li><code>retfq</code> è¿œè¿”å›ï¼šå…ˆå–è¿”å›åœ°å€ï¼Œå†å–<code>0x23</code>ä½œä¸ºCSå¯„å­˜å™¨ï¼Œå› æ­¤è·³è½¬çš„åœ°å€ä¸º<code>0x23:32ä½æŒ‡ä»¤åœ°å€</code><ul><li><code>retq</code>ç›¸å½“äº<code>pop ip; pop cs</code></li><li><code>retfq</code>æ˜¯æŒ‰64ä½è¿›è¡Œ<code>pop</code>ï¼Œ<code>retf</code>æ˜¯æŒ‰32ä½è¿›è¡Œ<code>pop</code></li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">push 0x23</span><br><span class="line">push _nexr_x86_code</span><br><span class="line">retfq</span><br></pre></td></tr></table></figure><p>å…¶å®å®ç°çš„æ–¹å¼åº”è¯¥å¹¶ä¸æ˜¯é‚£ä¹ˆå›ºå®šï¼Œè™½ç„¶å¤§å·®ä¸å·®ï¼Œæ¯”å¦‚ä¸¾ä¾‹çš„ç¨‹åºä¸º64ä½ â†’ 32ä½ï¼Œå…¶æµç¨‹ä¸ºï¼š</p><p><img src="/2023/05/10/%E5%A4%A9%E5%A0%82%E4%B9%8B%E9%97%A8%E5%8E%9F%E7%90%86/image-20230509193351163.png" alt="64FC1628å‡½æ•°"></p><ul><li><code>call $+5</code>ï¼šè·³åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ŒcallæŒ‡ä»¤å¤§å°ä¸º5ï¼ŒåŒæ—¶å°†<code>0x666C1642</code>åœ°å€å…¥æ ˆï¼›<ul><li><img src="/2023/05/10/%E5%A4%A9%E5%A0%82%E4%B9%8B%E9%97%A8%E5%8E%9F%E7%90%86/image-20230510121041395.png" alt="call $+5"></li></ul></li><li><code>mov [rsp+0xA8-0xA4], 23h</code>ï¼šå°†æ ˆé¡¶32ä½æ•°æ®çš„å‰å…«ä½å˜æˆ0x23<ul><li><img src="/2023/05/10/%E5%A4%A9%E5%A0%82%E4%B9%8B%E9%97%A8%E5%8E%9F%E7%90%86/image-20230510121350591.png" alt="æ›´æ”¹è¿”å›åœ°å€çš„cs"></li></ul></li><li><code>add [rsp+0xA8-0xA8], 0Dh</code>ï¼šå°†æ ˆé¡¶64ä½æ•°æ® +&#x3D; 0x0Dï¼Œä½¿å…¶retfè¿”å›åœ°å€æŒ‡å‘<code>0x23:0x666C164E</code><ul><li><img src="/2023/05/10/%E5%A4%A9%E5%A0%82%E4%B9%8B%E9%97%A8%E5%8E%9F%E7%90%86/image-20230510121638859.png" alt="æ›´æ”¹è¿”å›åœ°å€"></li></ul></li><li><code>retf</code>ï¼šè¿œè¿”å›ï¼Œè¯¥æŒ‡ä»¤ä¼šä»æ ˆé¡¶å–å‡ºä¸€ä¸ªè¿”å›åœ°å€ï¼Œå†å–å‡ºä¸€ä¸ªcsæ®µé€‰æ‹©å­ï¼Œè¿™é‡Œçš„CSæ®µå˜æˆäº†0x23ï¼Œè¿”å›åœ°å€ä¸º<code>0x23:0x666C164E</code>ï¼Œç„¶åå¼€å§‹ä»¥32ä½æ¨¡å¼å¼€å§‹<code>0x666C164E</code>å¤„çš„æŒ‡ä»¤<ul><li><img src="/2023/05/10/%E5%A4%A9%E5%A0%82%E4%B9%8B%E9%97%A8%E5%8E%9F%E7%90%86/image-20230510121804080.png" alt="CSæ›´æ”¹äº†"></li></ul></li></ul><p>å®ƒ32ä½ â†’ 64ä½å°±æ›´å·®ä¸å¤šäº†ï¼š</p><p>å°†<code>push è¿”å›åœ°å€</code>æ‹†æˆ<code>call + add</code>ã€‚</p><p><img src="/2023/05/10/%E5%A4%A9%E5%A0%82%E4%B9%8B%E9%97%A8%E5%8E%9F%E7%90%86/image-20230510122409063.png" alt="32 â†’ 64"></p><h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>å®ç°æ­¥éª¤ï¼š</p><ol><li>å®ç°æ¨¡å¼çš„åˆ‡æ¢</li><li>ä»£ç ï¼ˆå¯ä»¥æ˜¯ä»…æŒ‡ä»¤ä»£ç ï¼Œä¹Ÿå¯ä»¥æ˜¯è°ƒç”¨ç›¸å¯¹åº”ä½æ•°çš„å‡½æ•°ï¼Œä½†è¿™ä¼šéº»çƒ¦ä¸€äº›ï¼‰</li><li>åˆ‡æ¢å›åŸæ¥çš„æ¨¡å¼</li></ol><p>å­—èŠ‚ç ä¸æ±‡ç¼–çš„è½¬æ¢å¯ä»¥é€šè¿‡<code>keystone</code>å’Œ<code>capstone</code>è·å–ã€‚</p><p>è¿™ä¸€éƒ¨åˆ†å°±æ²¡æœ‰å®è·µäº†ï¼Œçœ‹çœ‹å„ä½âœŒçš„ä»£ç ï¼š</p><p>ä»¥ä¸‹æ˜¯<a href="http://blog.bluesadi.cn:4000/2021/11/06/%E5%A4%A9%E5%A0%82%E4%B9%8B%E9%97%A8-Heaven-s-Gate-C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0/">32ä½ä¸‹å¯è¿è¡Œçš„64ä½memcpyå‡½æ•°</a>ï¼š</p><blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">memcpy64</span><span class="params">(<span class="type">uint64_t</span> dst, <span class="type">uint64_t</span> src, <span class="type">uint64_t</span> sz)</span> &#123;</span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> code[] = &#123;</span><br><span class="line"><span class="comment">/*[bits 32]</span></span><br><span class="line"><span class="comment">push 0x33</span></span><br><span class="line"><span class="comment">push _next_x64_code</span></span><br><span class="line"><span class="comment">retf</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="number">0x6A</span>, <span class="number">0x33</span>, <span class="number">0x68</span>, <span class="number">0x78</span>, <span class="number">0x56</span>, <span class="number">0x34</span>, <span class="number">0x12</span>, <span class="number">0xCB</span>,</span><br><span class="line"><span class="comment">/*[bits 64]</span></span><br><span class="line"><span class="comment">push rsi</span></span><br><span class="line"><span class="comment">push rdi</span></span><br><span class="line"><span class="comment">mov rsi, src</span></span><br><span class="line"><span class="comment">mov rdi, dst</span></span><br><span class="line"><span class="comment">mov rcx, sz</span></span><br><span class="line"><span class="comment">rep movsb</span></span><br><span class="line"><span class="comment">pop rsi</span></span><br><span class="line"><span class="comment">pop rdi</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x57</span>,</span><br><span class="line"><span class="number">0x48</span>, <span class="number">0xBE</span>, <span class="number">0x88</span>, <span class="number">0x77</span>, <span class="number">0x66</span>, <span class="number">0x55</span>, <span class="number">0x44</span>, <span class="number">0x33</span>, <span class="number">0x22</span>, <span class="number">0x11</span>,</span><br><span class="line"><span class="number">0x48</span>, <span class="number">0xBF</span>, <span class="number">0x88</span>, <span class="number">0x77</span>, <span class="number">0x66</span>, <span class="number">0x55</span>, <span class="number">0x44</span>, <span class="number">0x33</span>, <span class="number">0x22</span>, <span class="number">0x11</span>,</span><br><span class="line"><span class="number">0x48</span>, <span class="number">0xB9</span>, <span class="number">0x88</span>, <span class="number">0x77</span>, <span class="number">0x66</span>, <span class="number">0x55</span>, <span class="number">0x44</span>, <span class="number">0x33</span>, <span class="number">0x22</span>, <span class="number">0x11</span>,</span><br><span class="line"><span class="number">0xF3</span>, <span class="number">0xA4</span>,</span><br><span class="line"><span class="number">0x5E</span>, <span class="number">0x5F</span>,</span><br><span class="line"><span class="comment">/*[bits 64]</span></span><br><span class="line"><span class="comment">push 0x23</span></span><br><span class="line"><span class="comment">push _next_x86_code</span></span><br><span class="line"><span class="comment">retfq</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="number">0x6A</span>, <span class="number">0x23</span>, <span class="number">0x68</span>, <span class="number">0x78</span>, <span class="number">0x56</span>, <span class="number">0x34</span>, <span class="number">0x12</span>, <span class="number">0x48</span>, <span class="number">0xCB</span>,</span><br><span class="line"><span class="comment">/*[bits 32]</span></span><br><span class="line"><span class="comment">ret</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="number">0xC3</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> ptr = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">if</span> (!ptr) &#123;</span><br><span class="line">ptr = (<span class="type">uint32_t</span>)VirtualAlloc(<span class="literal">NULL</span>, <span class="keyword">sizeof</span>(code), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(code); i++) ((PBYTE)ptr)[i] = code[i];</span><br><span class="line">&#125;</span><br><span class="line">*(<span class="type">uint32_t</span>*)(ptr + <span class="number">3</span>) = ptr + <span class="number">8</span>;</span><br><span class="line">*(<span class="type">uint64_t</span>*)(ptr + <span class="number">12</span>) = src;</span><br><span class="line">*(<span class="type">uint64_t</span>*)(ptr + <span class="number">22</span>) = dst;</span><br><span class="line">*(<span class="type">uint64_t</span>*)(ptr + <span class="number">32</span>) = sz;</span><br><span class="line">*(<span class="type">uint32_t</span>*)(ptr + <span class="number">47</span>) = ptr + <span class="number">53</span>;</span><br><span class="line">((<span class="type">void</span>(*)())ptr)();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>d3ctf2023å­¦ä¹ </title>
      <link href="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/"/>
      <url>/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¹‹æ‰€ä»¥æ ‡é¢˜ä¸ºå­¦ä¹ ï¼Œæ˜¯å› ä¸ºæˆ‘ä¸ä¼šã€‚</p><p>è¿™ç¯‡æ–‡ç« ä»…ä¸ºçœ‹å®Œå„ä½ä½¬çš„wpä¹‹åï¼Œç…§è‘«èŠ¦ç”»ç“¢è·Ÿç€åšä¸€éçš„è¿‡ç¨‹ï¼Œéƒ¨åˆ†è„šæœ¬ä¼šç›´æ¥ä½¿ç”¨å„ä½ä½¬çš„wpã€‚</p><p>åœ¨è¿™æ¬¡CTFä¸­ï¼Œæˆ‘å‘ç°æˆ‘å…¶å®å¹¶æ²¡æœ‰ç³»ç»Ÿåœ°å­¦ä¹ é€†å‘ï¼Œä»å¤´åˆ°å°¾éƒ½æ˜¯çå­ä¹±æ’ï¼Œå¯¹äºå„å¼å„æ ·çš„çŸ¥è¯†çš„ç†è§£åªæ˜¯æµäºè¡¨é¢ã€‚</p><p>æ‰€ä»¥å•Šï¼Œè¿˜å¾—å­¦ï¼Œè€Œä¸”è¿˜å¾—æ‰å¾—æ·±ç‚¹å•Šã€‚</p><p>å„ä½âœŒçš„writeupï¼š</p><p>ğŸ‘‰<a href="https://fq6p9pyo5tt.feishu.cn/docx/InUFdQUKdozf8yx5IhGcf5zInSe">2023 AntCTF x D^3CTF äºšå†› Writeup By S1uM4in)</a></p><p>ğŸ‘‰<a href="https://mp.weixin.qq.com/s?__biz=Mzg4MjcxMTAwMQ==&mid=2247486967&idx=1&sn=ad55ddd11c6bfa17843270625f5f92fc&chksm=cf53cd41f8244457c2db68626c91f2e4564d756b903222f3a913e89f211d475418864c5041bc&mpshare=1&scene=23&srcid=0501bEUrW8ydbpm175TL5FFn&sharer_sharetime=1682949687637&sharer_shareid=6eea79ff6da57fc6752ab0bc570bf392#rd">2023 D^3CTF writeup by ä¸‡å¹´ä¸‰ç­‰å¥–</a></p><p>ğŸ‘‰è¿˜æœ‰ä¸ªå®˜æ–¹çš„wpï¼Œå°±ä¸æ”¾äº†</p><h1 id="d3syscall"><a href="#d3syscall" class="headerlink" title="d3syscall"></a>d3syscall</h1><p>é¦–å…ˆçœ‹mainï¼Œå¤§æ¦‚é€»è¾‘å°±æ˜¯è¾“å…¥flagï¼Œæ£€æµ‹ã€‚</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230507181209469.png" alt="mainå‡½æ•°"></p><p>sub_D3F5å°±æ˜¯æ£€æµ‹å‡½æ•°ã€‚</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230507181232317.png" alt="æ£€æµ‹å‡½æ•°sub_D3F5"></p><p>æ˜¯syscallè¿›è¡Œçš„ç³»ç»Ÿè°ƒç”¨ï¼Œè°ƒç”¨çš„æ“ä½œç”±eaxçš„å€¼å†³å®šã€‚</p><p>å› æ­¤éœ€è¦çœ‹syscallçš„è°ƒç”¨æœ‰ä»€ä¹ˆã€‚</p><p>æ¥åˆ°sub_1830ï¼Œè¿™é‡Œæœ‰å¯¹æ•°æ®æ®µå–éï¼Œå¹¶å†™æ–‡ä»¶çš„æ“ä½œï¼Œè¿˜æœ‰å¯¹å­—ç¬¦ä¸²å¼‚æˆ–çš„æ“ä½œã€‚</p><p>ä½†å…¶å®æˆ‘å¹¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆç¨‹åºä¼šæ¥åˆ°è¿™é‡Œï¼Œè¿˜æ˜¯éœ€è¦ç³»ç»Ÿåœ°å­¦ä¹ ä¸€ä¸‹ç¨‹åºæ‰§è¡Œçš„æµç¨‹ç­‰çŸ¥è¯†å•Šã€‚</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230507202136815.png" alt="sub_1830"></p><p>å¯¹unk_4020æ•°æ®æ®µçš„å–éæ“ä½œï¼Œå¯ä»¥åœ¨åŠ¨æ€è°ƒè¯•ä¸‹ç›´æ¥æŠŠç»“æœdumpå‡ºæ¥ï¼Œçœ‹æ–‡ä»¶å¤´å¯ä»¥çŸ¥é“æ˜¯ä¸€ä¸ªæ–°çš„ELFæ–‡ä»¶ã€‚</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230507181121914.png" alt="å–éç»“æœ"></p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ç”Ÿæˆçš„æ–‡ä»¶ï¼Œè·¯å¾„ä¸º<code>/tmp/my_module</code>ã€‚</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230507181136870.png" alt="æ–‡ä»¶è·¯å¾„"></p><p>åœ¨dumpæ–‡ä»¶çš„init_moduleå‡½æ•°ä¸­ï¼ŒçŒœæµ‹å°±æ˜¯æ›´æ”¹ç³»ç»Ÿè°ƒç”¨è¡¨çš„è¿‡ç¨‹ã€‚</p><p>v4çš„ä¸‹è¡¨å¯¹åº”æ£€æµ‹å‡½æ•°æ¯ä¸€ä¸ªsyscallçš„eaxå–å€¼ã€‚</p><blockquote><p>ç¨‹åºé¦–å…ˆä»<code>/proc/kallsyms</code>ä¸­è·å–äº†ç³»ç»Ÿè°ƒç”¨è¡¨çš„åœ°å€ï¼Œé€šè¿‡å‚æ•°ä¼ é€’åˆ°å†…æ ¸æ¨¡å—ä¸­ï¼Œå†…æ ¸æ¨¡å—é‡Œæ³¨å†Œäº†<code>Linux</code>ä¿ç•™çš„ç³»ç»Ÿè°ƒç”¨ï¼Œåˆ†åˆ«ä¸ºï¼š335ï¼šMOVï¼Œ336ï¼šALUï¼Œ337ï¼šPUSHï¼Œ338ï¼šPOPï¼Œ339ï¼šresetregï¼Œ340ï¼šcheckflagã€‚</p></blockquote><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230507204944395.png" alt="init_module"></p><p>ä¸€å…±æ›´æ”¹äº†äº”ä¸ªç³»ç»Ÿè°ƒç”¨ã€‚</p><p>MOVè°ƒç”¨ï¼š</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230507205002664.png" alt="MOV"></p><p>PUSHè°ƒç”¨ï¼š</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230507205018345.png" alt="PUSH"></p><p>POPè°ƒç”¨ï¼š</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230507205034902.png" alt="POP"></p><p>resetregè°ƒç”¨ï¼š</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230507181619340.png" alt="resetreg"></p><p>checkflagè°ƒç”¨ï¼š</p><p>å°†v4ä¸å¤„ç†è¿‡åçš„è¾“å…¥ä½œæ¯”è¾ƒï¼Œè¿›è¡Œæ£€æµ‹ã€‚</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230507204810730.png" alt="checkflag"></p><p>è¿ç®—æ“ä½œï¼š</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230507205445965.png" alt="AUL_1"></p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230507205505877.png" alt="AUL_2"></p><p>çŸ¥é“äº†è°ƒç”¨ï¼Œç°åœ¨åªéœ€è¦çŸ¥é“è°ƒç”¨çš„æµç¨‹å°±å¯ä»¥äº†ã€‚</p><p>wpé‡Œç»™å‡ºäº†ä¸€ä¸ªååˆ†æ–¹ä¾¿çš„æ–¹æ³•ï¼šä½¿ç”¨straceã€‚(ä½†å…¶å®æ ¹æ®æ±‡ç¼–æ¥çœ‹ä¹Ÿè¡Œï¼Œä½†å¾ˆéº»çƒ¦)</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230507181341809.png" alt="starce"></p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230507181409731.png" alt="æµç¨‹ï¼ˆæœªå®Œï¼‰"></p><p>å°†ç»“æœéƒ¨åˆ†è¿›è¡Œä¿®æ”¹ï¼Œå†ä»£å…¥wpä¸­çš„è„šæœ¬ä¸­å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°æ£€æµ‹çš„é€»è¾‘ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">bytecode = [</span><br><span class="line">    [<span class="number">0x14f</span>, <span class="number">0x1</span>, <span class="number">0</span>, <span class="number">0x3837363534333231</span>, <span class="number">0</span>, <span class="number">0x5564c32f4027</span>, <span class="number">0x7fd40816fa80</span>],</span><br><span class="line">    [<span class="number">0x14f</span>, <span class="number">0x1</span>, <span class="number">0x1</span>, <span class="number">0x6665646362613039</span>, <span class="number">0</span>, <span class="number">0x5564c32f4027</span>, <span class="number">0x7fd40816fa80</span>],</span><br><span class="line">    [<span class="number">0x151</span>, <span class="number">0</span>, <span class="number">0x1</span>, <span class="number">0x6665646362613039</span>, <span class="number">0</span>, <span class="number">0x5564c32f4027</span>, <span class="number">0x7fd40816fa80</span>],</span><br><span class="line">    ...</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mov</span>(<span class="params">code</span>):</span><br><span class="line">    <span class="keyword">match</span> code[<span class="number">1</span>]:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;mov reg[<span class="subst">&#123;code[<span class="number">2</span>]&#125;</span>],reg[<span class="subst">&#123;code[<span class="number">3</span>]&#125;</span>]&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;mov reg[<span class="subst">&#123;code[<span class="number">2</span>]&#125;</span>],<span class="subst">&#123;<span class="built_in">hex</span>(code[<span class="number">3</span>])&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">alu</span>(<span class="params">code</span>):</span><br><span class="line">    <span class="keyword">match</span> code[<span class="number">1</span>]:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;add reg[<span class="subst">&#123;code[<span class="number">2</span>]&#125;</span>],reg[<span class="subst">&#123;code[<span class="number">3</span>]&#125;</span>]&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;sub reg[<span class="subst">&#123;code[<span class="number">2</span>]&#125;</span>],reg[<span class="subst">&#123;code[<span class="number">3</span>]&#125;</span>]&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;mul reg[<span class="subst">&#123;code[<span class="number">2</span>]&#125;</span>],reg[<span class="subst">&#123;code[<span class="number">3</span>]&#125;</span>]&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;xor reg[<span class="subst">&#123;code[<span class="number">2</span>]&#125;</span>],reg[<span class="subst">&#123;code[<span class="number">3</span>]&#125;</span>]&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;shl reg[<span class="subst">&#123;code[<span class="number">2</span>]&#125;</span>],reg[<span class="subst">&#123;code[<span class="number">3</span>]&#125;</span>]&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;shr reg[<span class="subst">&#123;code[<span class="number">2</span>]&#125;</span>],reg[<span class="subst">&#123;code[<span class="number">3</span>]&#125;</span>]&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">push</span>(<span class="params">code</span>):</span><br><span class="line">    <span class="keyword">match</span> code[<span class="number">1</span>]:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;push reg[<span class="subst">&#123;code[<span class="number">2</span>]&#125;</span>]&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;push <span class="subst">&#123;<span class="built_in">hex</span>(code[<span class="number">2</span>])&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pop</span>(<span class="params">code</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;pop reg[<span class="subst">&#123;code[<span class="number">1</span>]&#125;</span>]&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> bytecode:</span><br><span class="line">    <span class="keyword">match</span> i[<span class="number">0</span>]:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">335</span>:</span><br><span class="line">            mov(i)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">336</span>:</span><br><span class="line">            alu(i)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">337</span>:</span><br><span class="line">            push(i)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">338</span>:</span><br><span class="line">            pop(i)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">339</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;resetreg&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">340</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;checkflag&quot;</span>)</span><br></pre></td></tr></table></figure><p>åœ¨å¯¹é€»è¾‘çš„ä»£ç é‡æ–°æ•´ç†å¾—åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">input = [32bit] * 6</span><br><span class="line">stack = []</span><br><span class="line">r0 = input[0]</span><br><span class="line">r1 = input[1]</span><br><span class="line">stack.append(r1)</span><br><span class="line">r2 = r0 &lt;&lt; 3 + 0x51e7647e</span><br><span class="line">r3 = r0 * 3 + 0xe0b4140a</span><br><span class="line">r2 = r2 ^ r3</span><br><span class="line">r2 ^= (r0 + 0xe6978f27)</span><br><span class="line">stack.pop()</span><br><span class="line">r1 = r1 + r2</span><br><span class="line">stack.append(r1)</span><br><span class="line">stack.append(r0)</span><br><span class="line">r2 = r1 &lt;&lt; 6 + 0x53a35337</span><br><span class="line">r3 = r1 * 5 + 0x9840294d</span><br><span class="line">r2 = r2 ^ r3</span><br><span class="line">r3 = r1 - 0x5eae4751</span><br><span class="line">r2 = r2 ^ r3</span><br><span class="line">stack.pop(r0)</span><br><span class="line">stack.append(r0 + r2)</span><br><span class="line"></span><br><span class="line">r0 = input[2]</span><br><span class="line">r1 = input[3]</span><br><span class="line">stack.append(0)</span><br><span class="line">r2 = r0 &lt;&lt; 3 + 0x51e7647e</span><br><span class="line">r3 = r0 * 3 + 0xe0b4140a</span><br><span class="line">r2 = r2 ^ r3</span><br><span class="line">r2 ^= (r0 + 0xe6978f27)</span><br><span class="line">stack.pop(r1)</span><br><span class="line">r1 += r2</span><br><span class="line">stack.append(r1)</span><br><span class="line">stack.append(r0)</span><br><span class="line">r2 = r1 &lt;&lt; 6 + 0x53a35337</span><br><span class="line">r3 = r1 * 5 + 0x9840294d</span><br><span class="line">r2 = r2 ^ r3</span><br><span class="line">r2 ^= r1 - 0x5eae4751</span><br><span class="line">stack.pop(r0)</span><br><span class="line">r0 += r2</span><br><span class="line">stack.append(r0)</span><br><span class="line"></span><br><span class="line">r0 = input[4]</span><br><span class="line">r1 = input[5]</span><br><span class="line">stack.append(r1)</span><br><span class="line">r2 = r0 &lt;&lt; 3 + 0x51e7647e</span><br><span class="line">r3 = r0 * 3 + 0xe0b4140a</span><br><span class="line">r2 = r2 ^ r3</span><br><span class="line">r2 ^= r0 + 0xe6978f27</span><br><span class="line">stack.pop(r1)</span><br><span class="line">r1 += r2</span><br><span class="line">stack.append(r1)</span><br><span class="line">stack.append(r0)</span><br><span class="line">r2 = r1 &lt;&lt; 6 + 0x53a35337</span><br><span class="line">r3 = r1 * 5 + 0x9840294d</span><br><span class="line">r2 = r2 ^ r3</span><br><span class="line">r2 ^= r1 - 0x5eae4751</span><br><span class="line">stack.pop(r0)</span><br><span class="line">r0 += r2</span><br><span class="line">stack.append(r0)</span><br></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥å†™è„šæœ¬å¾—åˆ°flagäº†ã€‚ğŸ‘ˆå®˜æ–¹çš„wp  (ã„’oã„’)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">v4 = [<span class="number">0</span>]*<span class="number">7</span></span><br><span class="line">v4[<span class="number">1</span>] = <span class="number">0xB0800699CB89CC89</span></span><br><span class="line">v4[<span class="number">2</span>] = <span class="number">0x4764FD523FA00B19</span></span><br><span class="line">v4[<span class="number">3</span>] = <span class="number">0x396A7E6DF099D700</span></span><br><span class="line">v4[<span class="number">4</span>] = <span class="number">0xB115D56BCDEAF50A</span></span><br><span class="line">v4[<span class="number">5</span>] = <span class="number">0x2521513C985791F4</span></span><br><span class="line">v4[<span class="number">6</span>] = <span class="number">0xB03C06AF93AD0BE</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">7</span>, <span class="number">2</span>):</span><br><span class="line">enc_result = v4[i]</span><br><span class="line">half_1 = v4[i+<span class="number">1</span>] - (((enc_result &lt;&lt; <span class="number">6</span>) + <span class="number">0x53A35337</span>) ^ (enc_result * <span class="number">5</span> +</span><br><span class="line"><span class="number">0x9840294D</span>) ^ (enc_result - <span class="number">0x5EAE4751</span>))</span><br><span class="line">half_1 &amp;= <span class="number">0xffffffffffffffff</span></span><br><span class="line"><span class="built_in">print</span>(half_1.to_bytes(<span class="number">8</span>, <span class="string">&#x27;little&#x27;</span>).decode(), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">half_2 = enc_result - ((((half_1 &lt;&lt; <span class="number">3</span>) + <span class="number">0x51E7647E</span>) ^ ((half_1 * <span class="number">3</span>) +</span><br><span class="line"><span class="number">0x0E0B4140A</span>)) ^ (half_1 + <span class="number">0xE6978F27</span>))</span><br><span class="line">half_2 &amp;= <span class="number">0xffffffffffffffff</span></span><br><span class="line"><span class="built_in">print</span>(half_2.to_bytes(<span class="number">8</span>, <span class="string">&#x27;little&#x27;</span>).decode(), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="comment"># d3ctf&#123;cef9b994-2547-4844-ac0d-a097b75806a0&#125;</span></span><br></pre></td></tr></table></figure><h1 id="d3Hell"><a href="#d3Hell" class="headerlink" title="d3Hell"></a>d3Hell</h1><h2 id="åˆ†ædll"><a href="#åˆ†ædll" class="headerlink" title="åˆ†ædll"></a>åˆ†ædll</h2><p>å…¶å®ï¼Œç¨‹åºä¸dllçš„å…·ä½“å…³ç³»æˆ‘è¿˜æ²¡ææ‡‚ï¼Œç¨‹åºåœ¨å“ªé‡Œè°ƒç”¨çš„dllæˆ‘è¿˜ä¸æ¸…æ¥šï¼Œå› æ­¤è·Ÿç€wpæç¤ºèµ°ã€‚</p><p>é¦–å…ˆï¼Œçœ‹DllMainï¼š</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230509193221462.png" alt="DllMain"></p><p>æ— è®ºç¨‹åºå¦‚ä½•è°ƒç”¨ï¼Œ64FC1628å‡½æ•°ä¸€å®šè¢«è°ƒç”¨äº†ï¼Œå› æ­¤æŸ¥çœ‹64FC1628ï¼š</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230509193351163.png" alt="64FC1628å‡½æ•°"></p><p>ç»wpæç¤ºï¼Œè¿™é‡Œä½¿ç”¨äº†å¤©å ‚ä¹‹é—¨ï¼ˆå¯ä»¥ä»<code>call $+5;</code>,<code>mov [ ], 23</code>,<code>retf</code>è§‚å¯Ÿå‡ºï¼‰ï¼Œå³ï¼š</p><ul><li><p><code>call $+5</code>ï¼šè·³åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ŒcallæŒ‡ä»¤å¤§å°ä¸º5ï¼ŒåŒæ—¶å°†0x666C1642åœ°å€å…¥æ ˆï¼›</p></li><li><p><code>mov [rsp+0xA8-0xA4], 23h</code>ï¼šå°†æ ˆé¡¶16ä½æ•°æ®çš„å‰å…«ä½å˜æˆ0x23</p></li><li><p><code>add [rsp+0xA8-0xA8], 0Dh</code>ï¼šå°†æ ˆé¡¶16ä½æ•°æ® +&#x3D; 0x0Dï¼Œä½¿å…¶retfè¿”å›åœ°å€æŒ‡å‘0x666C164E</p></li><li><p><code>retf</code>ï¼šè¿œè¿”å›ï¼Œè¯¥æŒ‡ä»¤ä¼šä»æ ˆé¡¶å–å‡ºä¸€ä¸ªè¿”å›åœ°å€ï¼Œå†å–å‡ºä¸€ä¸ªcsæ®µé€‰æ‹©å­ï¼Œè¿™é‡Œçš„CSæ®µå˜æˆäº†0x23ï¼Œè¿”å›åœ°å€ä¸º0x666C164Eï¼Œç„¶åå¼€å§‹ä»¥32ä½æ¨¡å¼å¼€å§‹0x666C164Eå¤„çš„æŒ‡ä»¤</p></li></ul><p>å…·ä½“äº†è§£å¤©å ‚ä¹‹é—¨ï¼Œçœ‹è¿™ä½âœŒ [å¤©å ‚ä¹‹é—¨ (Heavenâ€™s Gate) Cè¯­è¨€å®ç°</p><p>è¿™æ®µ32ä½çš„æŒ‡ä»¤å…·ä½“å¤šé•¿ç›®å‰è¿˜ä¸ç¡®å®šï¼Œæ‰€ä»¥å…ˆéƒ½dumpä¸‹æ¥ï¼Œè®©capstoneç¿»è¯‘æˆ32ä½æŒ‡ä»¤ã€‚</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230509195823808.png" alt="32ä½æŒ‡ä»¤"></p><p>å¾ˆæ˜æ˜¾ï¼Œå‰ä¸€éƒ¨åˆ†çš„ä»£ç æ˜¯åœ¨å¼‚æˆ–<code>0x666c169a - 0x666c18ea</code>è¿™éƒ¨åˆ†ï¼Œ</p><p>å› æ­¤ï¼Œæ‰‹åŠ¨å¼‚æˆ–åå†ç¿»è¯‘ï¼š</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230509201456498.png" alt="å¼‚æˆ–åçš„32ä½æŒ‡ä»¤"></p><p><code>0x666c169a - 0x666c16a5</code>çš„ä»£ç æ˜¯å›åˆ°64ä½æ¨¡å¼ï¼Œå› æ­¤å°†ä¹‹åçš„éƒ¨åˆ†ç”¨64ä½è§£é‡Šã€‚</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230509201924211.png" alt="ç»“æœæŒ‡ä»¤"></p><p>ä¸ºäº†æ–¹ä¾¿åˆ†æï¼Œå°†ä»¥ä¸Šçš„å¤„ç†åœ¨idaå†™è„šæœ¬å¤„ç†ï¼Œç„¶ånopæ‰å¼‚æˆ–æ•°æ®ä»¥åŠæ¨¡å¼è½¬æ¢éƒ¨åˆ†çš„ä»£ç ã€‚</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230509202310847.png" alt="61FC1628å‡½æ•°é€»è¾‘"></p><p>å½»åº•å¾—åˆ°å‡½æ•°é€»è¾‘äº†ï¼Œä½†<code>61FC1602()</code>è¿™ä¸ªå‡½æ•°åˆ†æèµ·æ¥å¥½éº»çƒ¦ï¼ˆæ„Ÿè§‰æ˜¯ä¸€ä¸ªå°†æ•°è½¬åŒ–ä¸ºåè¿›åˆ¶å­—ç¬¦ä¸²çš„è¿‡ç¨‹ï¼‰ï¼Œæ‰€ä»¥åŠ¨æ€è·å–flagç»“æœï¼š698740305822331500978964939673142241ã€‚</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230509202501985.png" alt="flagç»“æœ"></p><p>æ³¨æ„ï¼š</p><ol><li><p>è¿™ä¸ªflagç»“æœå°†æ”¾åœ¨exeçš„<code>0x405020</code>ã€‚</p></li><li><p><code>61FC1628()</code>æœ‰æ£€æŸ¥4,202,264 &#x3D; 0x401f18 åœ°å€éƒ¨åˆ†çš„æ•°æ®ï¼Œå› æ­¤å¦‚æœè¦ä¿®æ”¹Sleepä»£ç ï¼Œåˆ™éœ€è¦ä¿®æ”¹ä¸‹dllã€‚</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230509203924821.png" alt="0x401f18åœ°å€éƒ¨åˆ†ä»£ç "></p></li></ol><h2 id="åˆ†æexe"><a href="#åˆ†æexe" class="headerlink" title="åˆ†æexe"></a>åˆ†æexe</h2><p>è¿™ä¸ªç¨‹åºå…‰æ˜¯çœ‹ç€å°±å¤´å¤§ï¼Œæ‰€ä»¥å°±ä»dllè·å–çš„flagè°ƒå°ï¼Œå»çœ‹çœ‹æ¯ä¸ªå‡½æ•°çš„å¤§æ¦‚ä½œç”¨ã€‚</p><p>è¿™é‡Œå°†flagè°ƒä¸º 0x1ED &#x3D; 17 * 29ï¼Œç„¶åä¸€ä¸ªä¸ªå‡½æ•°å¤§æ¦‚çœ‹çœ‹ç»“æœå•¥çš„ã€‚</p><p>å› æ­¤ï¼Œå¤§æ¦‚é€»è¾‘å°±æ˜¯å°†flagåˆ†è§£ä¸ºä¸¤ä¸ªçº¦æ•°ï¼Œç„¶åéƒ½è¾“å‡ºåè¿›åˆ¶æ•°å‡ºæ¥ã€‚ğŸ‘ˆè¿™äº›æ˜¯wpä¸­è¯´çš„ï¼Œæˆ‘è¿˜æ²¡åˆ†æå‡ºæ¥å‘¢</p><p>ï¼ˆå…·ä½“åˆ†æçœ‹çœ‹æœ‰æ²¡æ—¶é—´å§  (ã„’oã„’ï¼‰ï¼‰</p><p>æ ¹æ®wpï¼Œå¯ä»¥è·³è¿‡æœ€è€—è´¹æ—¶é—´çš„<code>401E64</code>ï¼ˆåº”è¯¥æ˜¯æ±‚çº¦æ•°çš„å‡½æ•°ï¼‰ç„¶åå°†xmm0å¯„å­˜å™¨æ”¹ä¸ºflagçš„ä¸¤ä¸ªçº¦æ•°ä¹‹ä¸€ã€‚</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230510102958001.png" alt="æ›´æ”¹xmm0å¯„å­˜å™¨"></p><p>å¾—åˆ°flagï¼š</p><p><img src="/2023/05/07/d3ctf2023%E5%AD%A6%E4%B9%A0/image-20230510103101324.png" alt="flag"></p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸ç¨‹åºäº¤äº’çš„é—®é¢˜</title>
      <link href="/2023/04/05/%E4%B8%8E%E7%A8%8B%E5%BA%8F%E4%BA%A4%E4%BA%92%E7%9A%84%E9%97%AE%E9%A2%98/"/>
      <url>/2023/04/05/%E4%B8%8E%E7%A8%8B%E5%BA%8F%E4%BA%A4%E4%BA%92%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™ä¸ªé—®é¢˜æ˜¯åœ¨åšé€†å‘æ—¶ç¢°åˆ°çš„ï¼Œå°±æ˜¯ä¸€ä¸ªçŒœæ•°å­—çš„æ¸¸æˆï¼Œè¦çŒœå¯¹ä¸€ç™¾è½®ï¼Œè¿™æ—¶ï¼Œæˆ‘çš„ç¬¬ä¸€ä¸ªæƒ³æ³•æ˜¯å†™ä¸€ä¸ªè‡ªåŠ¨ä¸ç¨‹åºäº¤äº’çš„è„šæœ¬ï¼Œäºæ˜¯å°±å¼€å§‹ç½‘ä¸Šæ‰¾æœ‰æ²¡æœ‰ç±»ä¼¼çš„è„šæœ¬æˆ–æ–¹æ³•äº†ã€‚</p><p>é¦–å…ˆï¼Œè¦è¯´æ˜çš„æ˜¯æˆ‘å¹¶æ²¡æœ‰åšå‡ºæ¥å…³äºè¿™ä¸ªçŒœæ•°å­—ç¨‹åºçš„è‡ªåŠ¨äº¤äº’è„šæœ¬ï¼Œå› ä¸ºåœ¨è¿™è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸ªé—®é¢˜ï¼Œè¿™åœ¨ä¸‹é¢è®²è¿°ï¼Œæ‰€ä»¥æˆ‘çš„æ–¹æ³•åªæ˜¯é¢å‘ä¸€ä¸ªç®€å•çš„testç¨‹åºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="type">char</span> str[<span class="number">10</span>];</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;hello\n&quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, str);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s hello&quot;</span>, str);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,str);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;hello %s\n&quot;</span>, str);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶æ¬¡ï¼Œæˆ‘åªæ˜¯å¯¹æˆ‘çš„æ–¹æ³•è¿›è¡Œä¸€ä¸ªå™è¿°ï¼Œè¯´å®è¯ï¼Œè¿™ä¸ªæ–¹æ³•å¾ˆè‡­ï¼Œæˆ‘æ˜¯çœŸçš„æƒ³ä¸å‡ºæ¥å¥½çš„æ–¹æ³•äº†T_T T_T T_T</p><h1 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h1><p>ä½¿ç”¨pythonçš„subprocessæ¨¡å—ï¼Œ</p><p>å¦‚æœå°†ç¨‹åºè¾“å…¥è¾“å‡ºå¯¼å…¥subprocessæ¨¡å—çš„PIPEï¼Œå³ï¼š</p><p><code>p = subprocess.Popen(&quot;test_fflush.exe&quot;, stdin=subprocess.PIPE, stdout=subprocess.PIPE, shell=True, bufsize=0)</code></p><p>ä¹‹åè¯»å–ç¨‹åºè¾“å‡ºæ—¶ä½¿ç”¨<code>readline()</code>ä¼šå µå¡ç¨‹åºçš„è¿›è¡Œã€‚</p><p>å¦‚æœå°†ç¨‹åºçš„è¾“å‡ºå¯¼å…¥æ ‡å‡†è¾“å‡ºï¼Œç„¶åä½¿ç”¨ç»ˆç«¯è¿è¡Œè¯¥è„šæœ¬ï¼Œå³ï¼š</p><p><code>p = subprocess.Popen(&quot;test_fflush.exe&quot;, stdin=subprocess.PIPE, stdout=sys.stdout, shell=True, bufsize=0)</code></p><p>æ ‡å‡†è¾“å‡ºç›´æ¥è¿”å›åˆ°ç»ˆç«¯ä¸Šäº†ï¼Œæˆ‘çœ‹åˆ°ä½†æ— æ³•åœ¨ç¨‹åºä¸­è·å–ã€‚</p><p>å¦‚æœå°†ç¨‹åºçš„è¾“å‡ºå¯¼å…¥åˆ°æ–‡ä»¶ä¸­ï¼ŒåŒæ—¶å†™å…¥æ–‡ä»¶æ—¶çš„ç¼“å†²åŒºä¹Ÿä¸º0ï¼Œå³ï¼š</p><p><code>with open(&#39;file.txt&#39;, &#39;wb+&#39;, buffering=0) as f:</code></p><p><code>p = subprocess.Popen(&quot;test_fflush.exe&quot;, stdin=subprocess.PIPE, stdout=f, shell=True, bufsize=0)</code></p><p>ï¼ˆä»¥ä¸‹å…¶å®å¹¶ä¸å®Œå…¨ç¡®å®šæ˜¯å¦æ­£ç¡®ï¼‰å¦‚æœç¨‹åºå…·æœ‰ç¼“å†²åŒºï¼Œé‚£ç¨‹åºçš„è¾“å‡ºä¹Ÿæ— æ³•ç›´æ¥å®æ—¶åœ°æ¨åˆ°æ–‡ä»¶ä¸­ï¼Œæˆ‘å°±æ— æ³•åœ¨ç¨‹åºä¸­è¯»å–æ–‡ä»¶è·å–ç¨‹åºè¾“å‡ºäº†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœç¨‹åºçš„ç¼“å†²åŒºä¸º0ï¼Œå³æ¯æ¬¡è¾“å‡ºåæœ‰<code>fflush()</code>çš„è¯ï¼Œå°±å¯ä»¥é€šè¿‡æ‰§è¡Œsystemå‘½ä»¤è¯»å–æ–‡ä»¶å†…å®¹å®æ—¶è·å–è¾“å‡ºã€‚</p><p>ç®€è€Œè¨€ä¹‹å°±æ˜¯ï¼Œå•çº¯äº¤äº’çš„æ–¹æ³•åšä¸å‡ºæ¥ã€‚</p><h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><p>æœ¬æ¥æƒ³å«è¿™éƒ¨åˆ†å†…å®¹ä¸ºè§£å†³æ–¹æ³•çš„ï¼Œä½†è¿™å…¶å®å¹¶ä¸èƒ½ç§°ä¹‹ä¸ºè§£å†³æ–¹æ³•ï¼Œæ¯•ç«Ÿè¦è§£å†³çš„æ˜¯ä¸è‡ªå·±å†™çš„ä¸€ä¸ªç®€å•çš„testç¨‹åºè¿›è¡Œäº¤äº’ã€‚</p><p>æ‰€ä»¥ï¼Œç°åœ¨ç¢°åˆ°çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯æ— æ³•åœ¨è„šæœ¬æ‰§è¡Œè¿‡ç¨‹ä¸­è·å–ç¨‹åºçš„è¾“å‡ºã€‚</p><p>åœ¨ç¬¬ä¸‰ç§æƒ…å†µï¼šæŠŠè¾“å‡ºå¯¼å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œå› ä¸ºç¨‹åºçš„è¾“å‡ºåœ¨ç¼“å†²åŒºæ²¡æœ‰åˆ·æ–°ï¼Œæ–‡ä»¶é‡Œæ²¡æœ‰å†…å®¹ï¼Œæ‰€ä»¥è·å–ä¸äº†è¾“å‡ºã€‚</p><p>æ­£é“èµ°ä¸äº†å°±èµ°åä¸€ç‚¹ã€‚</p><p>å› æ­¤ï¼Œæƒ³åˆ°çš„ç¬¬ä¸€ä¸ªæ–¹æ³•DLLæ³¨å…¥ï¼šè®©ç¨‹åºæ‰§è¡Œä¸€æ¬¡<code>setvbuf()</code>ï¼Œä½¿ç¼“å†²åŒºä¸º0ã€‚</p><p>å¥½æ¶ˆæ¯ï¼šæ³¨å…¥æˆåŠŸäº†ï¼›åæ¶ˆæ¯ï¼šæ²¡ç”¨ã€‚</p><p>æŒ‰ç†æ¥è¯´æ˜¯å¯ä»¥çš„ï¼Œä½†æˆ‘å¹¶ä¸æ¸…æ¥šä¸ºå•¥ä¸æˆåŠŸã€‚</p><p>ç„¶åï¼Œæƒ³åˆ°çš„ç¬¬äºŒä¸ªæ–¹æ³•æ˜¯IAT hookï¼šæ¯æ¬¡ç¨‹åºæ‰§è¡Œå®Œä¸€æ¬¡è¾“å‡ºï¼Œå°±æ‰§è¡Œ<code>fflush()</code>ï¼Œåˆ·æ–°ç¼“å†²åŒºã€‚</p><p>è¿™é‡Œè¦è¯´æ˜çš„æ˜¯ï¼Œæˆ‘ç°åœ¨è¦è§£å†³çš„æ˜¯æˆ‘çš„testç¨‹åºï¼Œé‡Œé¢çš„è¾“å‡ºéƒ½æ˜¯ç”±<code>printf()</code>æ¥å®Œæˆçš„ï¼Œæ‰€ä»¥æˆ‘æ¸…æ¥šæˆ‘éœ€è¦ç›´æ¥hook <code>printf()</code>å‡½æ•°ï¼Œè¿™å…¶å®ä¹Ÿæ˜¯è¿™ä¸ªæ€è·¯çš„ä¸€ä¸ªå±€é™ï¼Œæˆ‘ä¸ä¸€å®šçŸ¥é“ç¨‹åºçš„è¾“å‡ºé‡‡ç”¨å“ªä¸€ä¸ªè¾“å‡ºå‡½æ•°ã€‚</p><p>ç»“æœåŒæ ·ä¸è¡Œã€‚</p><p>æœ€åï¼Œæƒ³åˆ°çš„ç¬¬ä¸‰ä¸ªæ–¹æ³•æ˜¯ï¼Œæ—¢ç„¶æˆ‘éƒ½å®ç°äº†IAT hookäº†ï¼Œé‚£æˆ‘ç›´æ¥åœ¨æˆ‘è‡ªå·±å†™çš„<code>printf()</code>ä¸­è·å–<code>printf()</code>çš„å‚æ•°ï¼Œç„¶åç›´æ¥å°†å…¶å†™å…¥ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè¿™æ ·æˆ‘çš„è„šæœ¬å°±å¯ä»¥è¯»å–æ–‡ä»¶çš„å†…å®¹è·å–æ¯ä¸€æ¬¡è¾“å‡ºçš„å†…å®¹äº†ã€‚</p><p>ç»“æœæ˜¯è¿™ä¸ªæ–¹æ³•æˆåŠŸäº†ï¼Œä½†éº»çƒ¦æ— æ¯”ã€‚</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><h4 id="è‡ªå·±çš„printf-å‡½æ•°"><a href="#è‡ªå·±çš„printf-å‡½æ•°" class="headerlink" title="è‡ªå·±çš„printf()å‡½æ•°"></a>è‡ªå·±çš„<code>printf()</code>å‡½æ•°</h4><p>é‡å†™äº†çš„<code>printf()</code>å‡½æ•°å…¶å®å¹¶ä¸ç¾ä¸½ï¼Œæˆ‘åªæ˜¯ç®€å•å†™äº†ä¸€ä¸‹ã€‚</p><p>å®é™…ä¸Šçš„<code>printf()</code>å‡½æ•°ä½¿ç”¨çš„æ˜¯å¯å˜å‚æ•°æ¥è·å–å…¶åé¢çš„å‚æ•°ï¼Œç„¶åæ ¹æ®ç¬¬ä¸€ä¸ªå‚æ•°æ ¼å¼å­—ç¬¦ä¸²æ¥è§£æåé¢å˜é‡çš„ç±»å‹ã€‚</p><p>è¿™é‡Œï¼Œæˆ‘é‡‡ç”¨åŒæ ·çš„æ€è·¯ï¼Œåªæ˜¯è§£æå†™å¾—ç®€å•äº†å¾ˆå¤šï¼Œç„¶åä½¿ç”¨å¯å˜å‚æ•°è·å–åé¢çš„å‚æ•°ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">MyPrintf</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* formatOri, ...)</span></span><br><span class="line">&#123;</span><br><span class="line">FILE* f = fopen(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (g_OldPfnMsgA != nullptr)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title function_">format</span><span class="params">(formatOri)</span>;</span><br><span class="line"><span class="type">size_t</span> pos = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> parmNum = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> parmType[<span class="number">25</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="keyword">while</span> ((pos = format.find(<span class="string">&#x27;%&#x27;</span>, pos)) != <span class="built_in">std</span>::<span class="built_in">string</span>::npos) &#123;</span><br><span class="line"><span class="type">char</span> type = format[pos + <span class="number">1</span>];</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> type_name;</span><br><span class="line"><span class="keyword">switch</span> (type) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">parmType[parmNum] = <span class="number">0</span>;</span><br><span class="line">pos += <span class="number">2</span>;</span><br><span class="line">parmNum++;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">parmType[parmNum] = <span class="number">1</span>;</span><br><span class="line">pos += <span class="number">2</span>;</span><br><span class="line">parmNum++;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;c&#x27;</span>:</span><br><span class="line">parmType[parmNum] = <span class="number">2</span>;</span><br><span class="line">pos += <span class="number">2</span>;</span><br><span class="line">parmNum++;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">va_list ap;</span><br><span class="line">        <span class="comment">// va_startçš„ç¬¬äºŒä¸ªå‚æ•°å¾—æ˜¯printfçš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¦åˆ™æ‰¾ä¸åˆ°åç»­å‚æ•°çš„åœ°å€</span></span><br><span class="line">va_start(ap, formatOri);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">fputs</span>(formatOri, f);</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; parmNum; i++) &#123;</span><br><span class="line"><span class="keyword">switch</span> (parmType[i]) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line"><span class="built_in">fprintf</span>(f, <span class="string">&quot;%s\n&quot;</span>, va_arg(ap, <span class="type">char</span>*));</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line"><span class="built_in">fprintf</span>(f, <span class="string">&quot;%d\n&quot;</span>, va_arg(ap, <span class="type">int</span>));</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line"><span class="built_in">fprintf</span>(f, <span class="string">&quot;%c\n&quot;</span>, va_arg(ap, <span class="type">char</span>));</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fclose(f);</span><br><span class="line">va_end(ap);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;çœŸçš„è¿›å»äº†ï¼ï¼ï¼&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="äº¤äº’è„šæœ¬"><a href="#äº¤äº’è„šæœ¬" class="headerlink" title="äº¤äº’è„šæœ¬"></a>äº¤äº’è„šæœ¬</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">p = subprocess.Popen(<span class="string">&quot;test.exe&quot;</span>, stdin=subprocess.PIPE,</span><br><span class="line">                     stdout=subprocess.PIPE, stderr=sys.stderr, shell=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">while</span> p.poll() <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    out = <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(out.readlines())</span><br><span class="line">    out.close()</span><br><span class="line">    p.stdin.write((<span class="built_in">input</span>() + <span class="string">&#x27;\n&#x27;</span>).encode())</span><br><span class="line">    p.stdin.flush()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ‚ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠ¨æ€è§„åˆ’</title>
      <link href="/2023/04/05/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
      <url>/2023/04/05/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä»¥ä¸‹åªæ˜¯ç¢°åˆ°é—®é¢˜çš„è§£å†³æ–¹æ³•ï¼Œé¡ºä¾¿å¯¹å­¦ä¹ åˆ°çš„ç®—æ³•è®°å½•ä¸€äº›ç¬”è®°ï¼Œå¹¶éå½»åº•åœ°è®²è§£åŠ¨æ€è§„åˆ’ç®—æ³•</p><h1 id="é—®é¢˜å™è¿°"><a href="#é—®é¢˜å™è¿°" class="headerlink" title="é—®é¢˜å™è¿°"></a>é—®é¢˜å™è¿°</h1><p>ä»¥ä¸‹ä»£ç åªæ˜¯å¯¹é—®é¢˜çš„ä¸€ä¸ªç®€è¦çš„æè¿°ï¼Œå®é™…ä¸Šåå…­ä¸ªæ•°ç»„çš„å…ƒç´ éƒ½ä¸ä¸º0ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line">b, c, d, e, f, g, h, i, j, k, l, m, n, o, p = [[<span class="number">0</span>] * <span class="number">16</span>] * <span class="number">16</span>, [[<span class="number">0</span>] * <span class="number">16</span>] * <span class="number">16</span>, [[<span class="number">0</span>] * <span class="number">16</span>] * <span class="number">16</span>, [[<span class="number">0</span>] * <span class="number">16</span>] * <span class="number">16</span>, </span><br><span class="line">[[<span class="number">0</span>] * <span class="number">16</span>] * <span class="number">16</span>, [[<span class="number">0</span>] * <span class="number">16</span>] * <span class="number">16</span>, [[<span class="number">0</span>] * <span class="number">16</span>] * <span class="number">16</span>, [[<span class="number">0</span>] * <span class="number">16</span>] * <span class="number">16</span>, </span><br><span class="line">[[<span class="number">0</span>] * <span class="number">16</span>] * <span class="number">16</span>, [[<span class="number">0</span>] * <span class="number">16</span>] * <span class="number">16</span>, [[<span class="number">0</span>] * <span class="number">16</span>] * <span class="number">16</span>, [[<span class="number">0</span>] * <span class="number">16</span>] * <span class="number">16</span>, </span><br><span class="line">[[<span class="number">0</span>] * <span class="number">16</span>] * <span class="number">16</span>, [[<span class="number">0</span>] * <span class="number">16</span>] * <span class="number">16</span>, [[<span class="number">0</span>] * <span class="number">16</span>] * <span class="number">16</span>, </span><br><span class="line">arrays = [b, c, d, e, f, g, h, i, j, k, l, m, n, o, p]</span><br><span class="line">result = <span class="number">1</span></span><br><span class="line">index_r = randon.randomint(<span class="number">0</span>, <span class="number">15</span>)</span><br><span class="line">result *= a[index_r]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">index_c = randon.randomint(<span class="number">0</span>, <span class="number">15</span>)</span><br><span class="line">result *= arrays[i][index_r][index_c]</span><br><span class="line">index_r = index_c</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œè¿™æ®µä»£ç é€šè¿‡åå…­æ¬¡çš„éšæœºé€‰æ‹©ç”Ÿæˆä¸€ä¸ªresultï¼Œç°åœ¨éœ€è¦å°†è¿™ä¸ªresultæœ€å°åŒ–ï¼Œå³æ±‚å‡ºresultçš„æœ€å°å€¼ã€‚</p><h1 id="è§£å†³è¿‡ç¨‹"><a href="#è§£å†³è¿‡ç¨‹" class="headerlink" title="è§£å†³è¿‡ç¨‹"></a>è§£å†³è¿‡ç¨‹</h1><p>å¯¹äºä¸€ä¸ªä¸æ‡‚ç®—æ³•çš„äººï¼Œç¬¬ä¸€æƒ³æ³•è‚¯å®šæ˜¯ç©·ä¸¾ï¼Œä½†å¤æ‚åº¦ä¸º$16^16$ï¼Œæ˜æ˜¾æ— æ³•è§£å†³ã€‚</p><p>ç¬¬äºŒä¸ªæƒ³æ³•æ˜¯è´ªå¿ƒç®—æ³•ï¼Œå³æ¯ä¸€æ¬¡é€‰æ‹©å°±é€‰æ‹©æœ€å°çš„é‚£ä¸€ä¸ªæ•°ï¼Œä½†è¿™æ— æ³•è¾¾åˆ°å…¨å±€æœ€ä¼˜è§£ã€‚</p><p>æœ€åçš„æ–¹æ³•å°±æ˜¯åŠ¨æ€è§„åˆ’äº†ã€‚</p><h2 id="åŠ¨æ€è§„åˆ’ç®—æ³•æ€æƒ³"><a href="#åŠ¨æ€è§„åˆ’ç®—æ³•æ€æƒ³" class="headerlink" title="åŠ¨æ€è§„åˆ’ç®—æ³•æ€æƒ³"></a>åŠ¨æ€è§„åˆ’ç®—æ³•æ€æƒ³</h2><blockquote><p>A * â€œ1+1+1+1+1+1+1+1 &#x3D;ï¼Ÿâ€ *</p><p>A : â€œä¸Šé¢ç­‰å¼çš„å€¼æ˜¯å¤šå°‘â€<br>B : <em>è®¡ç®—</em> â€œ8!â€</p><p>A *åœ¨ä¸Šé¢ç­‰å¼çš„å·¦è¾¹å†™ä¸Š â€œ1+â€ *<br>A : â€œæ­¤æ—¶ç­‰å¼çš„å€¼ä¸ºå¤šå°‘â€<br>B : <em>quickly</em> â€œ9!â€<br>A : â€œä½ æ€ä¹ˆè¿™ä¹ˆå¿«å°±çŸ¥é“ç­”æ¡ˆäº†â€<br>A : â€œåªè¦åœ¨8çš„åŸºç¡€ä¸ŠåŠ 1å°±è¡Œäº†â€<br>A : â€œæ‰€ä»¥ä½ ä¸ç”¨é‡æ–°è®¡ç®—å› ä¸ºä½ è®°ä½äº†ç¬¬ä¸€ä¸ªç­‰å¼çš„å€¼ä¸º8!</p><p>åŠ¨æ€è§„åˆ’ç®—æ³•ä¹Ÿå¯ä»¥è¯´æ˜¯ â€˜è®°ä½æ±‚è¿‡çš„è§£æ¥èŠ‚çœæ—¶é—´â€™â€</p></blockquote><p>ç®€å•æ¥è¯´ï¼ŒåŠ¨æ€è§„åˆ’å…¶å®å°±æ˜¯ï¼Œç»™å®šä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æŠŠå®ƒæ‹†æˆä¸€ä¸ªä¸ªå­é—®é¢˜ï¼Œç›´åˆ°å­é—®é¢˜å¯ä»¥ç›´æ¥è§£å†³ã€‚ç„¶åå‘¢ï¼ŒæŠŠå­é—®é¢˜ç­”æ¡ˆä¿å­˜èµ·æ¥ï¼Œä»¥å‡å°‘é‡å¤è®¡ç®—ã€‚å†æ ¹æ®å­é—®é¢˜ç­”æ¡ˆåæ¨ï¼Œå¾—å‡ºåŸé—®é¢˜è§£çš„ä¸€ç§æ–¹æ³•ã€‚</p><p>å¯¹äºæ–æ³¢æ‹‰å¥‘æ•°åˆ—ï¼Œæ±‚F(n)æ—¶ï¼Œä½¿ç”¨åŠ¨æ€è§„åˆ’ç®—æ³•æœ‰ä¸¤ç§æ–¹å¼ï¼šâ‘ è‡ªé¡¶å‘ä¸‹çš„å¤‡å¿˜å½•æ³•ï¼›â‘¡è‡ªåº•å‘ä¸Šã€‚</p><p>è‡ªé¡¶å‘ä¸‹çš„å¤‡å¿˜å½•æ³•å°±æ˜¯æ¯æ¬¡è®¡ç®—å‡ºF(a) (a &lt; n)æ—¶ï¼Œè®°å½•ä¸‹F(a)ï¼Œå¦‚æ­¤å°±ä¸éœ€è¦æ¯æ¬¡è®¡ç®—F(b)ï¼ŒF(b+1)æ—¶é‡å¤è®¡ç®—F(b)å’ŒF(b-1)äº†ã€‚</p><p>è‡ªåº•å‘ä¸Šçš„æ–¹æ³•å°±æ˜¯ä»F(1)å‡ºå‘ï¼Œä»¥æ­¤è®¡ç®—F(2)ã€F(3)ã€F(4)â€¦â€¦å¦‚æ­¤ï¼Œä¸€ç›´è®¡ç®—åˆ°F(n)ã€‚</p><h2 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h2><p>é‚£å¯¹äºä¸Šé¢çš„é—®é¢˜åº”è¯¥æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ</p><p>å…ˆç®€åŒ–ä¸€ä¸‹é—®é¢˜ï¼Œç°åœ¨é¢å¯¹çš„æ˜¯ä¸€ä¸ª1Ã—3çš„æ•°ç»„å’Œä¸¤ä¸ª3Ã—3çš„æ•°ç»„ï¼š</p><p><img src="/2023/04/05/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/image-20230405145317757.png" alt="ç®€åŒ–é—®é¢˜"></p><p>é€‰ä¸­açš„ä¸€ä¸ªå…ƒç´ ï¼Œä¸bä¸­å¯¹åº”çš„å…ƒç´ ç›¸ä¹˜ï¼Œå¾—åˆ°ç»“æœresult1ï¼šï¼ˆæŒ‰ç…§è§„åˆ™ï¼šaä¸­çš„åˆ—è¦å¯¹åº”bä¸­çš„è¡Œï¼‰</p><p><img src="/2023/04/05/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/image-20230405145420183.png" alt="result1"></p><p>æ˜¾ç„¶ï¼Œåˆ°bä¸ºæ­¢ï¼Œæœ€å°å€¼ä¸º10ã€‚</p><p>é€‰ä¸­result1çš„ä¸€ä¸ªå…ƒç´ ï¼Œä¸cä¸­å¯¹åº”çš„å…ƒç´ ç›¸ä¹˜ï¼Œå¾—åˆ°ç»“æœresult2ï¼šï¼ˆæŒ‰ç…§è§„åˆ™ï¼šresult1ä¸­çš„åˆ—è¦å¯¹åº”cä¸­çš„è¡Œï¼Œå› ä¸ºresult1çš„æ¯ä¸€ä¸ªå…ƒç´ çš„ä½ç½®ä¸ç›¸ä¹˜çš„bçš„å…ƒç´ çš„ä½ç½®ç›¸åŒï¼‰ã€‚å…ˆè€ƒè™‘result1[i][0]Ã—c[0][i]:</p><p><img src="/2023/04/05/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/image-20230405145626564.png" alt="result1(i)(0)Ã—c(0)(i)"></p><p>å› ä¸ºresult[i][0]ä¸­result[1][0]æ˜¯æœ€å°çš„ï¼Œå› æ­¤å¯¹äºresult1[i][0]Ã—c[0][i]çš„æ¯ä¸€åˆ—æ¥è¯´ï¼Œæœ€å°å€¼éƒ½æ˜¯ç¬¬äºŒè¡Œçš„å€¼ã€‚</p><p>è€Œå½“è¿˜è¦å¾€åè®¡ç®—dæ—¶ï¼Œresult1çš„ä½ç½®ä¿¡æ¯æ˜¯æ— ç”¨çš„ï¼Œåªéœ€è¦çŸ¥é“å¾—åˆ°è¯¥ç»“æœæ‰€ç›¸ä¹˜çš„cçš„å…ƒç´ çš„ä½ç½®ä¿¡æ¯ã€‚</p><p>å› æ­¤ï¼Œåªéœ€çŸ¥é“result1[1][0]Ã—c[0][i]ã€‚</p><p>å³ï¼šä½¿ç”¨resultçš„æ¯ä¸€åˆ—çš„æœ€å°å€¼ä¹˜ä»¥ä¸‹ä¸€ä¸ªæ•°ç»„çš„å¯¹åº”è¡Œçš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œå¾—åˆ°ä¸‹ä¸€ä¸ªresultæ•°ç»„ã€‚</p><p><img src="/2023/04/05/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/image-20230405145718352.png" alt="result2"></p><p>è¿ç”¨ç±»ä¼¼çš„æ€æƒ³å»æ›´æ–°resultæ•°ç»„ï¼Œè¿™ä¸ªresultæ•°ç»„å…¶å®å°±æ˜¯æ¯ä¸€å±‚çš„dpï¼Œdpçš„æœ€åä¸€å±‚çš„æœ€å°å€¼å°±æ˜¯æˆ‘ä»¬æ‰€è¦æ±‚æœ€å°å€¼ã€‚</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># stepæ˜¯æ‰€æœ‰16Ã—16çš„äºŒç»´æ•°ç»„ï¼Œstep0æ˜¯1Ã—16çš„ä¸€ç»´æ•°ç»„</span></span><br><span class="line">n = <span class="built_in">len</span>(step)</span><br><span class="line">dp = [[[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>)]</span><br><span class="line"><span class="comment"># prevçš„ç›®çš„ï¼šè·å–æœ€å°å€¼çš„æ¯ä¸€è½®é€‰æ‹©</span></span><br><span class="line">prev = [[[<span class="literal">None</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        dp[<span class="number">0</span>][i][j] = step0[i] * step1[i][j]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">15</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        min_val_col = <span class="number">100</span></span><br><span class="line">        row_of_min_val = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">            <span class="comment"># éå†ç¬¬n-1å±‚çš„dpç¬¬iåˆ—çš„æœ€å°å€¼</span></span><br><span class="line">            <span class="keyword">if</span> dp[n-<span class="number">1</span>][m][i] &lt; min_val_col:</span><br><span class="line">                min_val_col = dp[n-<span class="number">1</span>][m][i]</span><br><span class="line">                row_of_min_val = m</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">            <span class="comment"># ç¬¬nä¸ªè¡¨å®Œå…¨ä¸ç¬¬n-1ä¸ªè¡¨æœ‰å…³ï¼Œ å¯ä»¥ä¸ç¬¬n-2ä¸ªè¡¨æœ‰å…³ã€ä½†å¯ä»¥çœ‹ä½œæ— å…³</span></span><br><span class="line">            dp[n][i][j] = min_val_col * step[n][i][j]</span><br><span class="line">            prev[n][i][j] = row_of_min_val</span><br><span class="line">            <span class="comment"># preè®°å½•äº†ç¬¬nå±‚[i][j]ä½ç½®æ¥è‡ªäºç¬¬n-1å±‚çš„å“ªä¸€è¡Œï¼Œç”±äºç¬¬n-1å±‚çš„åˆ—å†³å®šäº†ç¬¬nå±‚çš„è¡Œï¼Œå› æ­¤åˆå¯ä»¥é€šè¿‡iæ¥ç¡®å®šç¬¬n-1å±‚çš„åˆ—</span></span><br><span class="line"></span><br><span class="line">min_val_ans = <span class="number">100</span></span><br><span class="line">min_i = <span class="literal">None</span></span><br><span class="line">min_j = <span class="literal">None</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">if</span> min_val_ans &gt; dp[<span class="number">14</span>][i][j]:</span><br><span class="line">            min_val_ans = dp[<span class="number">14</span>][i][j]</span><br><span class="line">            min_i = i</span><br><span class="line">            min_j = j</span><br><span class="line"></span><br><span class="line">path = [(<span class="number">14</span>, min_i, min_j)]</span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">    i, j = path[-<span class="number">1</span>][<span class="number">1</span>], path[-<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">    m = prev[n][i][j]  </span><br><span class="line">    <span class="comment"># mæ˜¯ç¬¬nå±‚æ¥è‡ªäºç¬¬n-1å±‚çš„é‚£ä¸€è¡Œ</span></span><br><span class="line">    path.append((n-<span class="number">1</span>, m, i))</span><br><span class="line">path.reverse()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QExtend-300</title>
      <link href="/2023/03/23/QExtend/"/>
      <url>/2023/03/23/QExtend/</url>
      
        <content type="html"><![CDATA[<h1 id="QExtendâ€”â€”XCTF"><a href="#QExtendâ€”â€”XCTF" class="headerlink" title="QExtendâ€”â€”XCTF"></a>QExtendâ€”â€”XCTF</h1><h2 id="å‡½æ•°ä¸»é€»è¾‘"><a href="#å‡½æ•°ä¸»é€»è¾‘" class="headerlink" title="å‡½æ•°ä¸»é€»è¾‘"></a>å‡½æ•°ä¸»é€»è¾‘</h2><p><img src="/2023/03/23/QExtend/image-20230323103139408.png" alt="ä¸»é€»è¾‘"></p><p>å¼€å§‹å‡½æ•°çš„é€»è¾‘ï¼Œæ ‡è®°çš„ä¸€è¡Œä¸ºå°†è¾“å…¥çš„ç¬¬å››ä½å’Œæœ€åä¸€ä½éƒ½å˜æˆ0ï¼Œå³å»æ‰flagä¸­çš„{}ï¼Œç„¶åæ¯”è¾ƒå‰å››ä½æ˜¯å¦ä½ZCTFï¼Œæœ€åå†ä½¿ç”¨flagä¸­{}ä¸­çš„å­—ç¬¦ä¸²ã€‚</p><h2 id="sub-4026D0å‡½æ•°"><a href="#sub-4026D0å‡½æ•°" class="headerlink" title="sub_4026D0å‡½æ•°"></a>sub_4026D0å‡½æ•°</h2><p>è¿›å…¥<code>loc_4026D0</code>å¯ä»¥çœ‹åˆ°ï¼Œè¿™å…¶å®åº”è¯¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä½†è¢«æ•°æ®æ–­å¼€äº†ï¼Œä½†ç»è¿‡ä¸æ›´æ”¹ä»£ç çš„è°ƒè¯•å‘ç°<code>0x4026E5</code>çš„æ•°æ®åœ¨ä¹‹åä¼šè¢«ç”¨åˆ°ï¼Œå› æ­¤å¦‚æœè¦ç¨‹åºæ­£å¸¸æ‰§è¡Œå°±ä¸èƒ½ç›´æ¥ä½¿ç”¨nopå°†å…¶è¦†ç›–ã€‚</p><p><img src="/2023/03/23/QExtend/image-20230323103226099.png" alt="sub_4026D0æ±‡ç¼–ä»£ç "></p><p>å…ˆå¿½ç•¥è¿™ä¸ªæ•°æ®ï¼Œä½¿ç”¨nopè¦†ç›–ã€‚</p><p><img src="/2023/03/23/QExtend/image-20230323103259763.png" alt="nopåçš„æ±‡ç¼–ä»£ç "></p><p>è·å¾—<code>sub_4026D0</code>å‡½æ•°çš„ä¸»è¦é€»è¾‘ã€‚</p><p><img src="/2023/03/23/QExtend/image-20230323103310285.png" alt="sub_4026D0å‡½æ•°ä¸»è¦é€»è¾‘"></p><p>å†è¿›å…¥switchçš„å„ä¸ªcaseçš„å‡½æ•°ä¸­çœ‹ä¸€ä¸‹ã€‚</p><p><img src="/2023/03/23/QExtend/image-20230323103322567.png" alt="sub_4026D0å‡½æ•°çš„case0ä¸­çš„å‡½æ•°"></p><p>è¿™é‡Œè¢«æ ‡è®°çš„è¡Œæœ‰å°†å‡½æ•°è¿”å›åœ°å€è¿›è¡ŒåŠ ä¸€çš„æ“ä½œï¼Œå¯ä»¥å°†å…¶nopæ‰ï¼Œå› ä¸ºå‡½æ•°è¿”å›åœ°å€å¤„çš„æŒ‡ä»¤æ²¡æœ‰å•¥ä½œç”¨ã€‚</p><h3 id="å›çœ‹è¢«nopçš„æ•°æ®"><a href="#å›çœ‹è¢«nopçš„æ•°æ®" class="headerlink" title="å›çœ‹è¢«nopçš„æ•°æ®"></a>å›çœ‹è¢«nopçš„æ•°æ®</h3><p><img src="/2023/03/23/QExtend/image-20230323103357350.png" alt="hanoiæ•°æ®"></p><p>æ­¤å¤„çš„callä¼šå°†å‡½æ•°è¿”å›åœ°å€å‹å…¥æ ˆä¸­ï¼Œè€Œè¿”å›åœ°å€<code>0x4026E5</code>å°±æ˜¯æ•°æ®çš„åœ°å€ï¼Œé€šè¿‡è¿™ç§æ–¹æ³•ï¼Œå½“è·³å…¥<code>sub_4026F5</code>å‡½æ•°æ—¶ï¼Œä½¿ç”¨popå°±å¯ä»¥è·å¾—æ•°æ®çš„åœ°å€ï¼Œç„¶åç»§ç»­ä¸‹æ–¹çš„æŒ‡ä»¤ã€‚</p><p><code>sub_4026F5</code>å‡½æ•°æ²¡æœ‰<code>push ebpï¼›mov ebp espï¼›</code>ç¯èŠ‚å› æ­¤ï¼Œç¬¬ä¸€ä¸ªå‡ºæ ˆçš„å°±æ˜¯å‡½æ•°è¿”å›åœ°å€ã€‚</p><p><img src="/2023/03/23/QExtend/v2-039d97b92f66e84801938c0e4b63e7cf_720w.png" alt="è°ƒç”¨å‡½æ•°æ—¶çš„æ ˆæƒ…å†µ"></p><p>æ­¤å¤„å°†æ•°æ®çš„åœ°å€popåˆ°esiä¸­ï¼Œè€Œä¸”è¿˜ä½¿ç”¨<code>mov [ebp-0Ch]ï¼Œesi;</code>å°†æ•°æ®åœ°å€å¤åˆ¶åˆ°ä¸€ä¸ªå‚æ•°ä¸Šã€‚esiåˆ°switchçš„å„caseçš„å‡½æ•°ä¸­ä¹‹å‰éƒ½æ²¡æœ‰æ›´æ”¹ï¼Œå› æ­¤å„caseä¸­çš„å‡½æ•°ç›´æ¥ä½¿ç”¨esiæ¥è·å–æ•°æ®ã€‚</p><p><img src="/2023/03/23/QExtend/image-20230323103444426.png" alt="è·å–æ•°æ®"></p><p>å›¾ä¸­esiçš„ä½ç½®å°±æ˜¯æŒ‡å‘æ•°æ®çš„åœ°å€ï¼Œå‡½æ•°ç›´æ¥ä½¿ç”¨ã€‚</p><h3 id="switchå„caseä¸­çš„å‡½æ•°çš„é€»è¾‘ã€‚"><a href="#switchå„caseä¸­çš„å‡½æ•°çš„é€»è¾‘ã€‚" class="headerlink" title="switchå„caseä¸­çš„å‡½æ•°çš„é€»è¾‘ã€‚"></a>switchå„caseä¸­çš„å‡½æ•°çš„é€»è¾‘ã€‚</h3><p>å› ä¸ºè¿™é‡Œçœ‹äº†åˆ«çš„å¸ˆå‚…çš„wpï¼Œå› æ­¤çŸ¥é“è¿™æ˜¯ä¸€ä¸ªhanoiæ¸¸æˆã€‚</p><p><img src="/2023/03/23/QExtend/image-20230323114812681.png" alt="caseä¸­å‡½æ•°çš„é€»è¾‘"></p><p>å…¶ä»–caseä¸­çš„å‡½æ•°ï¼Œå¤§å·®ä¸å·®ã€‚</p><p>6ä¸ªcaseåˆ†åˆ«å¯¹åº”è¿™hanoiæ¸¸æˆä¸­ä¸‰åˆ—çš„äº’ç›¸ç§»åŠ¨ã€‚</p><p>switchå­˜åœ¨ä¸0xFç›¸ä¸å†å‡ä¸€çš„æ“ä½œï¼ˆçœ‹æ±‡ç¼–æˆ–è€…æœªnopçš„ç¨‹åºé€»è¾‘ï¼‰ã€‚</p><p><img src="/2023/03/23/QExtend/image-20230323103751307.png" alt="switch"></p><p>çœ‹ifä¸­çš„å‡½æ•°sub_402490ï¼Œè¿™æ˜¯æ£€æŸ¥æ¯ä¸€æ­¥æ“ä½œæ˜¯å¦ç¬¦åˆhanoiè§„åˆ™çš„ã€‚</p><p><img src="/2023/03/23/QExtend/image-20230323103644727.png" alt="æ£€éªŒå‡½æ•°"></p><h3 id="sub-4026F5çš„è¿”å›å€¼ã€‚"><a href="#sub-4026F5çš„è¿”å›å€¼ã€‚" class="headerlink" title="sub_4026F5çš„è¿”å›å€¼ã€‚"></a>sub_4026F5çš„è¿”å›å€¼ã€‚</h3><p><img src="/2023/03/23/QExtend/image-20230323103821747.png" alt="è¿”å›å€¼"></p><p>å¯¹æ¯”æ±‡ç¼–å’Œä¼ªä»£ç ã€‚å¯ä»¥çœ‹å‡ºa2å°±æ˜¯[ebp-0Ch]ï¼Œä¸Šé¢è¯´è¿‡è¿™æ˜¯æŸæ•°æ®çš„åœ°å€ï¼Œè¿™é‡Œè·å–äº†æ•°æ®çš„ç¬¬5ã€6ã€7ã€8ã€9ä½ï¼Œå†å°†å®ƒä»¬è¿›è¡Œ&amp;&amp;è¿ç®—ï¼Œå°†ç»“æœä½œä¸ºè¿”å›å€¼ã€‚</p><p><img src="/2023/03/23/QExtend/image-20230323103835935.png" alt="è¿”å›å€¼"></p><h2 id="sub-402800å‡½æ•°ã€‚"><a href="#sub-402800å‡½æ•°ã€‚" class="headerlink" title="sub_402800å‡½æ•°ã€‚"></a>sub_402800å‡½æ•°ã€‚</h2><p><img src="/2023/03/23/QExtend/image-20230323101337439.png" alt="æ±‡ç¼–ä»£ç "></p><p>å¯ä»¥çœ‹å‡ºå®ƒä¸ä¸‹æ–¹çš„<code>sub_40282E</code>å…¶å®åº”è¯¥æ˜¯è¿åœ¨ä¸€èµ·çš„ã€‚</p><p>ç°åœ¨çœ‹ç€æ±‡ç¼–è¿›è¡Œåˆ†æã€‚</p><p><img src="/2023/03/23/QExtend/image-20230323101536470.png" alt="å †è°ƒç”¨"></p><p>å½“ç¨‹åºæ‰§è¡Œ<code>sub_40282E</code>æ—¶ï¼Œ<code>sub_40282E</code>å‡½æ•°æ²¡æœ‰è¿›è¡Œæ­£å¸¸çš„è°ƒèŠ‚æ ˆé¡¶æ ˆåº•æ“ä½œï¼Œè€Œæ˜¯<code>pop esi;</code>ï¼Œè¿™å°†å‡½æ•°è¿”å›åœ°å€ç»™popå‡ºæ¥äº†ï¼Œç¨‹åºå°†å…¶æ”¾ç½®åœ¨<code>[ebp-4]</code>ä¸­ï¼Œè¿™åœ¨ç¨‹åºä¹‹åä¼šç”¨åˆ°ã€‚</p><p><img src="/2023/03/23/QExtend/image-20230323101900462.png" alt="å‡½æ•°è¿”å›å¤„"></p><p>åœ¨çœ‹åˆ°<code>sub_40282E</code>çš„æœ€åï¼Œå®ƒè¿›è¡Œäº†è°ƒèŠ‚æ ˆé¡¶æ ˆåº•çš„æ“ä½œï¼Œä½†å‡½æ•°å¼€å§‹æ—¶å¹¶æ²¡æœ‰å…¶å¯¹åº”çš„æ“ä½œï¼Œå› æ­¤åœ¨è¿™é‡Œå®ƒè°ƒèŠ‚çš„æ˜¯<code>sub_40282E</code>çš„ä¸Šä¸€çº§å‡½æ•°<code>sub_402800</code>å‡½æ•°çš„å †æ ˆï¼Œå®ƒå°†å †æ ˆè¿˜åŸæˆ<code>start</code>å‡½æ•°ï¼ˆå³ç¨‹åºä¸»é€»è¾‘å‡½æ•°ï¼‰è°ƒç”¨<code>sub_402800</code>å‡½æ•°æ—¶çš„å †æ ˆï¼Œè€Œæ­¤æ—¶æ ˆé¡¶çš„å€¼æ˜¯<code>sub_402800</code>å‡½æ•°çš„è¿”å›åœ°å€ã€‚</p><p>ç¨‹åºé€šè¿‡è¿™æ ·å­çš„é€»è¾‘è·³è¿‡äº†è°ƒç”¨<code>sub_40282E</code>å‡½æ•°éœ€è¦å†è¿”å›è°ƒç”¨å¤„çš„æµç¨‹ã€‚</p><p><img src="/2023/03/23/QExtend/image-20230323102432094.png" alt="md5æ•°æ®"></p><p>ä¸Šé¢è¯´äº†è¿™ä¸€éƒ¨åˆ†æ˜¯ç¨‹åºä¹‹åæµç¨‹éœ€è¦çš„æ•°æ®ï¼Œæ‰€ä»¥å¦‚æœè¦æƒ³ä¸å¹²æ‰°ç¨‹åºæ­£å¸¸æµç¨‹å°±ä¸èƒ½æ”¹å˜å®ƒï¼Œä½†åœ¨è¿™é‡Œä¸ºäº†è·å–ä¼ªä»£ç ï¼Œå…ˆå°†ä»–nopæ‰ï¼Œå°†<code>sub_402800</code>å’Œ<code>sub_40282E</code>è¿èµ·æ¥ã€‚</p><p><img src="/2023/03/23/QExtend/image-20230323102827971.png" alt="å…·ä½“é€»è¾‘"></p><p>è§‚å¯Ÿæœªnopçš„ç¨‹åºæ±‡ç¼–å°±å¯ä»¥å‘ç°æ¯”è¾ƒçš„å­—ç¬¦ä¸²string1å°±æ˜¯ä¹‹å‰<code>sub_40282E</code>è¿”å›åœ°å€çš„é‚£éƒ¨åˆ†æ•°æ®ã€‚</p><p><img src="/2023/03/23/QExtend/image-20230323103042610.png" alt="è·å–çš„æ•°æ®"></p><h2 id="ç¼–å†™è„šæœ¬"><a href="#ç¼–å†™è„šæœ¬" class="headerlink" title="ç¼–å†™è„šæœ¬"></a>ç¼–å†™è„šæœ¬</h2><h3 id="ç¨‹åºé€»è¾‘"><a href="#ç¨‹åºé€»è¾‘" class="headerlink" title="ç¨‹åºé€»è¾‘"></a>ç¨‹åºé€»è¾‘</h3><p>è·å–ç”¨æˆ·è¾“å…¥ï¼Œå°†{}ä¸­çš„å†…å®¹æå–å‡ºæ¥ï¼›</p><p>æ ¹æ®è¾“å…¥ï¼Œè¿›è¡Œhanoiæ¸¸æˆï¼Œå°†æ¯ä¸€å—ä»å¤§åˆ°å°æ”¾ç½®åœ¨ç¬¬äºŒåˆ—ä¸Šï¼›</p><p>å°†è¾“å…¥ç”Ÿæˆmd5ï¼Œè¿›è¡Œæ¯”è¾ƒï¼›</p><p>hanoiåˆå§‹çŠ¶æ€å’Œéœ€è¦è¾¾åˆ°çš„çŠ¶æ€ï¼š</p><p><img src="/2023/03/23/QExtend/image-20230323105523254.png" alt="æ•°æ®å½¢å¼"></p><p>æ‰‹åŠ¨ç©ä¸€ä¸‹ï¼Œå¾—åˆ°æµç¨‹ï¼š053254104123104524104ï¼Œä¹Ÿå¯ä»¥æ‰¾ä¸ªè„šæœ¬è·‘ä¸€ä¸‹ã€‚</p><p>å› ä¸ºç¨‹åºåœ¨switchæ—¶è¿›è¡Œäº†ä¸0xFç›¸ä¸å†å‡ä¸€çš„æ“ä½œï¼Œå› æ­¤æ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ä¸²æœ‰å¾ˆå¤šï¼Œä½†æœ€åéœ€è¦å­—ç¬¦ä¸²çš„md5ä¸ä¸Šé¢æ•°æ®ç›¸åŒï¼Œå³ï¼š<code>0x30, 0x46, 0x32, 0x45, 0x37, 0x45, 0x34, 0x34, 0x37, 0x35,0x39, 0x33, 0x45, 0x43, 0x39, 0x41, 0x46, 0x33, 0x34, 0x36, 0x33, 0x45, 0x39, 0x43, 0x38, 0x37, 0x34, 0x35, 0x42, 0x38, 0x39 , 0x32</code>ã€‚</p><h3 id="è„šæœ¬"><a href="#è„šæœ¬" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">oper = <span class="string">&quot;053254104123104524104&quot;</span></span><br><span class="line">oper = [<span class="built_in">int</span>(i) + <span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> oper]</span><br><span class="line"><span class="comment"># å…­ç§è¾“å…¥charå¯¹åº”å…­ç§caseæ–¹æ³•</span></span><br><span class="line"><span class="comment"># operæ˜¯ç¬¦åˆæ¡ä»¶è¾“å…¥çš„ä½ä½</span></span><br><span class="line"><span class="comment"># ç¬¦åˆæ¡ä»¶çš„è¾“å…¥ ä¸º oper è¡¥è¶³ å®ƒçš„é«˜ä½</span></span><br><span class="line">high_bit = [<span class="number">0x20</span>, <span class="number">0x30</span>, <span class="number">0x40</span>, <span class="number">0x50</span>, <span class="number">0x60</span>, <span class="number">0x70</span>]</span><br><span class="line">final = [</span><br><span class="line">    <span class="number">0x30</span>, <span class="number">0x46</span>, <span class="number">0x32</span>, <span class="number">0x45</span>, <span class="number">0x37</span>, <span class="number">0x45</span>, <span class="number">0x34</span>, <span class="number">0x34</span>, <span class="number">0x37</span>, <span class="number">0x35</span>,</span><br><span class="line">    <span class="number">0x39</span>, <span class="number">0x33</span>, <span class="number">0x45</span>, <span class="number">0x43</span>, <span class="number">0x39</span>, <span class="number">0x41</span>, <span class="number">0x46</span>, <span class="number">0x33</span>, <span class="number">0x34</span>, <span class="number">0x36</span>,</span><br><span class="line">    <span class="number">0x33</span>, <span class="number">0x45</span>, <span class="number">0x39</span>, <span class="number">0x43</span>, <span class="number">0x38</span>, <span class="number">0x37</span>, <span class="number">0x34</span>, <span class="number">0x35</span>, <span class="number">0x42</span>, <span class="number">0x38</span>,</span><br><span class="line">    <span class="number">0x39</span>, <span class="number">0x32</span></span><br><span class="line">]</span><br><span class="line">final_s = <span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> final)</span><br><span class="line">final_s = final_s.lower()</span><br><span class="line"><span class="built_in">print</span>(final_s)</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> high_bit:</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> high_bit:</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> high_bit:</span><br><span class="line">            <span class="keyword">for</span> d <span class="keyword">in</span> high_bit:</span><br><span class="line">                <span class="keyword">for</span> e <span class="keyword">in</span> high_bit:</span><br><span class="line">                    <span class="keyword">for</span> f <span class="keyword">in</span> high_bit:</span><br><span class="line">                        now_oper = []</span><br><span class="line">                        <span class="keyword">for</span> i <span class="keyword">in</span> oper:</span><br><span class="line">                            <span class="keyword">match</span> i:</span><br><span class="line">                                <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                                    now_oper.append(i + a)</span><br><span class="line">                                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                                    now_oper.append(i + b)</span><br><span class="line">                                <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                                    now_oper.append(i + c)</span><br><span class="line">                                <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                                    now_oper.append(i + d)</span><br><span class="line">                                <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                                    now_oper.append(i + e)</span><br><span class="line">                                <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">                                    now_oper.append(i + f)</span><br><span class="line">                        now_str = <span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> now_oper)</span><br><span class="line">                        md5 = hashlib.md5(now_str.encode())</span><br><span class="line">                        result = md5.hexdigest()</span><br><span class="line">                        <span class="keyword">if</span> result == final_s:</span><br><span class="line">                            <span class="built_in">print</span>(now_str)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SCU2022æ–°ç”Ÿèµ›</title>
      <link href="/2022/11/18/SCU2022%E6%96%B0%E7%94%9F%E8%B5%9B/"/>
      <url>/2022/11/18/SCU2022%E6%96%B0%E7%94%9F%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h1 id="SCU2022æ–°ç”Ÿèµ›"><a href="#SCU2022æ–°ç”Ÿèµ›" class="headerlink" title="SCU2022æ–°ç”Ÿèµ›"></a>SCU2022æ–°ç”Ÿèµ›</h1><h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><p><img src="/2022/11/18/SCU2022%E6%96%B0%E7%94%9F%E8%B5%9B/image-20221118153813903.png" alt="ç­¾åˆ°"></p><h1 id="Tower-of-Hanoi"><a href="#Tower-of-Hanoi" class="headerlink" title="Tower_of_Hanoi"></a>Tower_of_Hanoi</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> x[<span class="number">35</span>]=&#123;</span><br><span class="line"><span class="number">0x1BF21</span>, <span class="number">0x1BF31</span>, <span class="number">0x1BF27</span>, <span class="number">0x1BF31</span>, <span class="number">0x1BF26</span>, <span class="number">0x1BF34</span>, <span class="number">0x1BF29</span>,</span><br><span class="line"> <span class="number">0x1BF20</span>, <span class="number">0x1BF37</span>, <span class="number">0x1BF24</span>, <span class="number">0x1BF37</span>, <span class="number">0x1BF20</span>, <span class="number">0x1BF21</span>, <span class="number">0x1BF37</span>,</span><br><span class="line"> <span class="number">0x1BF0D</span>, <span class="number">0x1BF3B</span>, <span class="number">0x1BF21</span>, <span class="number">0x1BF0D</span>, <span class="number">0x1BF24</span>, <span class="number">0x1BF37</span>, <span class="number">0x1BF20</span>,</span><br><span class="line"> <span class="number">0x1BF2B</span>, <span class="number">0x1BF0D</span>, <span class="number">0x1BF3B</span>, <span class="number">0x1BF3C</span>, <span class="number">0x1BF26</span>, <span class="number">0x1BF37</span>, <span class="number">0x1BF20</span>,</span><br><span class="line"> <span class="number">0x1BF37</span>, <span class="number">0x1BF21</span>, <span class="number">0x1BF26</span>, <span class="number">0x1BF3B</span>, <span class="number">0x1BF3C</span>, <span class="number">0x1BF35</span>, <span class="number">0x1BF2F</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">35</span>;i++)&#123;</span><br><span class="line"><span class="built_in">putchar</span>(x[i]^<span class="number">0x1bf52</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ez-Android"><a href="#ez-Android" class="headerlink" title="ez_Android"></a>ez_Android</h1><h3 id="ä¸»ä½“é€»è¾‘"><a href="#ä¸»ä½“é€»è¾‘" class="headerlink" title="ä¸»ä½“é€»è¾‘"></a>ä¸»ä½“é€»è¾‘</h3><p><img src="/2022/11/18/SCU2022%E6%96%B0%E7%94%9F%E8%B5%9B/image-20221118154221715.png" alt="ä»£ç "></p><p>å³è¦è·å–ä¸€ä¸²0ä¸1ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œä½¿ç”¨checkå‡½æ•°æ£€æŸ¥ã€‚</p><h3 id="checkå‡½æ•°"><a href="#checkå‡½æ•°" class="headerlink" title="checkå‡½æ•°"></a>checkå‡½æ•°</h3><p>å°†apkè§£å‹ä»libæ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°soæ–‡ä»¶ï¼Œcheckå‡½æ•°å°±åœ¨é‡Œé¢ã€‚</p><p><img src="/2022/11/18/SCU2022%E6%96%B0%E7%94%9F%E8%B5%9B/image-20221118154650130.png" alt="ä»£ç "></p><p>æ ¹æ®ç‚¹å‡»å¾—åˆ°çš„10åºåˆ—å˜åŒ–åŸºæ•°1ï¼Œä»è€Œå¾—åˆ°æ•°ç»„fçš„ä¸‹æ ‡ï¼Œå†ä»è€Œå¾—åˆ°æŸç‰¹å®šçš„å€¼ï¼Œè¯¥å€¼åº”è¯¥å¯¹åº” likeAndroidå­—ç¬¦ä¸²çš„å¯¹åº”ä½çš„ASCIIå€¼</p><h3 id="è§£é¢˜è„šæœ¬"><a href="#è§£é¢˜è„šæœ¬" class="headerlink" title="è§£é¢˜è„šæœ¬"></a>è§£é¢˜è„šæœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">b = [</span><br><span class="line">    <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>,</span><br><span class="line">    ...</span><br><span class="line">    <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span></span><br><span class="line">]</span><br><span class="line">c = []</span><br><span class="line">d = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b)):</span><br><span class="line">    <span class="keyword">if</span> b[i] != <span class="number">0</span>:</span><br><span class="line">        c.append(b[i])</span><br><span class="line">        d.append(i)</span><br><span class="line"></span><br><span class="line">a = <span class="string">&quot;even if i only have seven seconds of memory, even if i forget the world, i still love android&quot;</span></span><br><span class="line">total = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    frq = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(i) == c[j]:</span><br><span class="line">            num = d[j]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> num == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;wrong&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">while</span> num != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> num % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            num = num // <span class="number">2</span></span><br><span class="line">            frq.append(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            num = (num - <span class="number">1</span>) // <span class="number">2</span></span><br><span class="line">            frq.append(<span class="number">1</span>)</span><br><span class="line">    frq.reverse()</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> frq:</span><br><span class="line">        total.append(t)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> total:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;1&quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> i == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;0&quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;wrong&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆå¾—åˆ°01å­—ç¬¦ä¸²</p><h1 id="DEGUB"><a href="#DEGUB" class="headerlink" title="DEGUB"></a>DEGUB</h1><h3 id="è°ƒè¯•è¿‡ç¨‹"><a href="#è°ƒè¯•è¿‡ç¨‹" class="headerlink" title="è°ƒè¯•è¿‡ç¨‹"></a>è°ƒè¯•è¿‡ç¨‹</h3><p>å½“æ‰§è¡Œåˆ°é™¤0å¼‚å¸¸æ—¶ï¼Œæ›´æ”¹eipï¼Œè·³è¿‡é™¤0å¼‚å¸¸ã€‚</p><p>ç”±è°ƒè¯•å¯å‘ç°ï¼Œç¨‹åºåªæ˜¯å¯¹Inputå­—ç¬¦ä¸²è¿›è¡Œä½ç½®å˜æ¢å¤„ç†ã€‚</p><p>æ•…ï¼Œå¯ä»¥æ ¹æ®è¾“å…¥çš„å­—ç¬¦ä¸²aå˜æ¢åçš„ç»“æœbï¼Œå»è·å–è¿™ä¸ªå˜æ¢çš„è¿‡ç¨‹ã€‚</p><h3 id="è§£é¢˜è„šæœ¬-1"><a href="#è§£é¢˜è„šæœ¬-1" class="headerlink" title="è§£é¢˜è„šæœ¬"></a>è§£é¢˜è„šæœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&quot;0123456789abcdefghijklmnopqrstuv&quot;</span></span><br><span class="line">b = [<span class="number">0x35</span>, <span class="number">0x67</span>, <span class="number">0x64</span>, <span class="number">0x33</span>, <span class="number">0x69</span>, <span class="number">0x75</span>, <span class="number">0x71</span>, <span class="number">0x68</span>, <span class="number">0x72</span>, <span class="number">0x6B</span>,</span><br><span class="line">     <span class="number">0x6A</span>, <span class="number">0x74</span>, <span class="number">0x30</span>, <span class="number">0x34</span>, <span class="number">0x37</span>, <span class="number">0x31</span>, <span class="number">0x38</span>, <span class="number">0x65</span>, <span class="number">0x36</span>, <span class="number">0x70</span>,</span><br><span class="line">     <span class="number">0x63</span>, <span class="number">0x6C</span>, <span class="number">0x39</span>, <span class="number">0x6E</span>, <span class="number">0x6F</span>, <span class="number">0x61</span>, <span class="number">0x6D</span>, <span class="number">0x73</span>, <span class="number">0x32</span>, <span class="number">0x62</span>,</span><br><span class="line">     <span class="number">0x76</span>, <span class="number">0x66</span>]</span><br><span class="line">c = <span class="string">&quot;fa+cmRG25L5Cst5cqO&#123;CLmy6YigZu6&#125;5&quot;</span></span><br><span class="line">d = [<span class="number">0</span>] * <span class="number">32</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        <span class="keyword">if</span> b[i] == <span class="built_in">ord</span>(a[j]):</span><br><span class="line">            d[j] = <span class="built_in">ord</span>(c[i])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> d:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i), end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># scuctf&#123;5qyi6L+O5a2m5Lmg6YCG5ZCR&#125;</span></span><br></pre></td></tr></table></figure><h1 id="base"><a href="#base" class="headerlink" title="base"></a>base</h1><h3 id="ç¨‹åºé€»è¾‘"><a href="#ç¨‹åºé€»è¾‘" class="headerlink" title="ç¨‹åºé€»è¾‘"></a>ç¨‹åºé€»è¾‘</h3><p>ç±»ä¼¼èµ°è¿·å®«ï¼Œdword_4D7258ä¸èƒ½è¿›è¡Œå˜æ¢ï¼Œå› æ­¤èµ°çš„ä½ç½®åœ¨mazeä¸­ä¸èƒ½ä¸º0ã€‚</p><p>go_way_1å’Œgo_way_2æ˜¯èµ°è¿·å®«çš„æ–¹å¼ï¼Œç›®æ ‡æ˜¯xã€yéƒ½ä¸º29</p><p><img src="/2022/11/18/SCU2022%E6%96%B0%E7%94%9F%E8%B5%9B/image-20221118162606895-16687601452271.png" alt="ä»£ç "></p><h3 id="è§£é¢˜è„šæœ¬-2"><a href="#è§£é¢˜è„šæœ¬-2" class="headerlink" title="è§£é¢˜è„šæœ¬"></a>è§£é¢˜è„šæœ¬</h3><p>ä½¿ç”¨DFSæ–¹æ³•èµ°è¿·å®«</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">a = [</span><br><span class="line">    <span class="number">0x20</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">    ...</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span></span><br><span class="line">]</span><br><span class="line">b = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a) // <span class="number">4</span>):</span><br><span class="line">    b.append(a[i * <span class="number">4</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b)):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">30</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line">    <span class="keyword">if</span> b[i] != <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;0&#x27;</span>, end=<span class="string">&quot;, &quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span>, end=<span class="string">&quot;, &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line">b[<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gomaze</span>(<span class="params">x, y, flag, maze</span>):</span><br><span class="line">    newflag = flag</span><br><span class="line">    newmaze = []</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> maze:</span><br><span class="line">        newmaze.append(t)</span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">29</span> <span class="keyword">and</span> y == <span class="number">29</span>:</span><br><span class="line">        <span class="built_in">print</span>(newflag)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="number">30</span> &gt; x + <span class="number">2</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> <span class="number">30</span> &gt; y - <span class="number">1</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> b[x + <span class="number">2</span> + <span class="number">30</span> * (y - <span class="number">1</span>)] != <span class="number">0</span>:</span><br><span class="line">        b[x + <span class="number">2</span> + <span class="number">30</span> * (y - <span class="number">1</span>)] = <span class="number">0</span></span><br><span class="line">        gomaze(x + <span class="number">2</span>, y - <span class="number">1</span>, flag + <span class="string">&#x27;0&#x27;</span>, newmaze)</span><br><span class="line">        b[x + <span class="number">2</span> + <span class="number">30</span> * (y - <span class="number">1</span>)] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="number">30</span> &gt; x + <span class="number">1</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> <span class="number">30</span> &gt; y - <span class="number">2</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> b[x + <span class="number">1</span> + <span class="number">30</span> * (y - <span class="number">2</span>)] != <span class="number">0</span>:</span><br><span class="line">        b[x + <span class="number">1</span> + <span class="number">30</span> * (y - <span class="number">2</span>)] = <span class="number">0</span></span><br><span class="line">        gomaze(x + <span class="number">1</span>, y - <span class="number">2</span>, flag + <span class="string">&#x27;1&#x27;</span>, newmaze)</span><br><span class="line">        b[x + <span class="number">1</span> + <span class="number">30</span> * (y - <span class="number">2</span>)] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="number">30</span> &gt; x - <span class="number">1</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> <span class="number">30</span> &gt; y - <span class="number">2</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> b[x - <span class="number">1</span> + <span class="number">30</span> * (y - <span class="number">2</span>)] != <span class="number">0</span>:</span><br><span class="line">        b[x - <span class="number">1</span> + <span class="number">30</span> * (y - <span class="number">2</span>)] = <span class="number">0</span></span><br><span class="line">        gomaze(x - <span class="number">1</span>, y - <span class="number">2</span>, flag + <span class="string">&#x27;2&#x27;</span>, newmaze)</span><br><span class="line">        b[x - <span class="number">1</span> + <span class="number">30</span> * (y - <span class="number">2</span>)] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="number">30</span> &gt; x - <span class="number">2</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> <span class="number">30</span> &gt; y - <span class="number">1</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> b[x - <span class="number">2</span> + <span class="number">30</span> * (y - <span class="number">1</span>)] != <span class="number">0</span>:</span><br><span class="line">        b[x - <span class="number">2</span> + <span class="number">30</span> * (y - <span class="number">1</span>)] = <span class="number">0</span></span><br><span class="line">        gomaze(x - <span class="number">2</span>, y - <span class="number">1</span>, flag + <span class="string">&#x27;3&#x27;</span>, newmaze)</span><br><span class="line">        b[x - <span class="number">2</span> + <span class="number">30</span> * (y - <span class="number">1</span>)] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="number">30</span> &gt; x + <span class="number">2</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> <span class="number">30</span> &gt; y + <span class="number">1</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> b[x + <span class="number">2</span> + <span class="number">30</span> * (y + <span class="number">1</span>)] != <span class="number">0</span>:</span><br><span class="line">        b[x + <span class="number">2</span> + <span class="number">30</span> * (y + <span class="number">1</span>)] = <span class="number">0</span></span><br><span class="line">        gomaze(x + <span class="number">2</span>, y + <span class="number">1</span>, flag + <span class="string">&#x27;4&#x27;</span>, newmaze)</span><br><span class="line">        b[x + <span class="number">2</span> + <span class="number">30</span> * (y + <span class="number">1</span>)] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="number">30</span> &gt; x + <span class="number">1</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> <span class="number">30</span> &gt; y + <span class="number">2</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> b[x + <span class="number">1</span> + <span class="number">30</span> * (y + <span class="number">2</span>)] != <span class="number">0</span>:</span><br><span class="line">        b[x + <span class="number">1</span> + <span class="number">30</span> * (y + <span class="number">2</span>)] = <span class="number">0</span></span><br><span class="line">        gomaze(x + <span class="number">1</span>, y + <span class="number">2</span>, flag + <span class="string">&#x27;5&#x27;</span>, newmaze)</span><br><span class="line">        b[x + <span class="number">1</span> + <span class="number">30</span> * (y + <span class="number">2</span>)] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="number">30</span> &gt; x - <span class="number">1</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> <span class="number">30</span> &gt; y + <span class="number">2</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> b[x - <span class="number">1</span> + <span class="number">30</span> * (y + <span class="number">2</span>)] != <span class="number">0</span>:</span><br><span class="line">        b[x - <span class="number">1</span> + <span class="number">30</span> * (y + <span class="number">2</span>)] = <span class="number">0</span></span><br><span class="line">        gomaze(x - <span class="number">1</span>, y + <span class="number">2</span>, flag + <span class="string">&#x27;6&#x27;</span>, newmaze)</span><br><span class="line">        b[x - <span class="number">1</span> + <span class="number">30</span> * (y + <span class="number">2</span>)] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="number">30</span> &gt; x - <span class="number">2</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> <span class="number">30</span> &gt; y + <span class="number">1</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> b[x - <span class="number">2</span> + <span class="number">30</span> * (y + <span class="number">1</span>)] != <span class="number">0</span>:</span><br><span class="line">        b[x - <span class="number">2</span> + <span class="number">30</span> * (y + <span class="number">1</span>)] = <span class="number">0</span></span><br><span class="line">        gomaze(x - <span class="number">2</span>, y + <span class="number">1</span>, flag + <span class="string">&#x27;7&#x27;</span>, newmaze)</span><br><span class="line">        b[x - <span class="number">2</span> + <span class="number">30</span> * (y + <span class="number">1</span>)] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">gomaze(<span class="number">0</span>, <span class="number">0</span>, <span class="string">&#x27;&#x27;</span>, b)</span><br></pre></td></tr></table></figure><h1 id="dp"><a href="#dp" class="headerlink" title="dp"></a>dp</h1><h3 id="è§£é¢˜è¿‡ç¨‹"><a href="#è§£é¢˜è¿‡ç¨‹" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h3><p>ä½¿ç”¨pyinstxtractorå°†exeè½¬åŒ–å›pyï¼Œå¾—åˆ°çš„t4æ–‡ä»¶ï¼Œåœ¨å…¶æ–‡ä»¶å¤´åŠ å…¥pycæ–‡ä»¶å¤´ï¼Œç„¶åä½¿ç”¨uncompyle6å°†pycè½¬åŒ–ä¸ºpyï¼Œå¾—åˆ°ç¨‹åºé€»è¾‘ã€‚</p><p>è¯¥ç¨‹åºéœ€è¦ç‚¹å‡»ä¸€å®šæ¬¡æ•°åå¼€å§‹è¿è¡Œflagå­—ç¬¦ä¸²ç”Ÿæˆï¼Œå…¶ç”Ÿæˆé€»è¾‘å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gogogo</span>(<span class="params">self, x</span>):</span><br><span class="line">    <span class="keyword">if</span> x &gt;= <span class="number">5</span>:</span><br><span class="line">        self.flag += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    self.gogogo(x + <span class="number">1</span>)</span><br><span class="line">    self.gogogo(x + <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_flag</span>(<span class="params">self</span>):</span><br><span class="line">    self.gogogo(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> self.flag</span><br></pre></td></tr></table></figure><p>ä¸¾å‡ ä¸ªä¾‹å­ï¼Œå¯ä»¥çœ‹å‡ºæ˜¯æ–æ³¢æ‹‰å¥‘æ•°åˆ—ï¼Œflagæ˜¯ç¬¬102é¡¹ï¼Œåœ¨ç½‘ä¸Šç›´æ¥æœç´¢å¯å¾—åˆ°ã€‚</p><h1 id="flower"><a href="#flower" class="headerlink" title="flower"></a>flower</h1><h3 id="è§£é¢˜è¿‡ç¨‹-1"><a href="#è§£é¢˜è¿‡ç¨‹-1" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h3><p>åŠ¨æ€è°ƒè¯•ç¨‹åºï¼Œç¨‹åºæŠ¥é”™ã€‚</p><p><img src="/2022/11/18/SCU2022%E6%96%B0%E7%94%9F%E8%B5%9B/image-20221118165700892.png" alt="ä»£ç "></p><p>ç”±ä¸Šå›¾å‘ç°ï¼Œidaæç¤ºtryï¼ŒçŒœæµ‹æ˜¯å¼‚å¸¸æŠ›å‡ºï¼Œç¨‹åºä¼šæ‰§è¡Œä¸‹é¢çš„è¿‡ç¨‹ï¼Œå› æ­¤æ›´æ”¹eipç›´æ¥æ‰§è¡Œä¸‹é¢çš„è¯­å¥ï¼Œç¨‹åºå¼€å§‹æ­£å¸¸è¿è¡Œã€‚</p><p>ç¨‹åºçš„é€»è¾‘ï¼š </p><p>åˆ¤å®š input[i] ^ (i%7) &#x3D;&#x3D; someStr[i]</p><p>someSträ¸ºç¨‹åºçš„æ•°ç»„ã€‚</p><h3 id="è§£é¢˜è„šæœ¬-3"><a href="#è§£é¢˜è„šæœ¬-3" class="headerlink" title="è§£é¢˜è„šæœ¬"></a>è§£é¢˜è„šæœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Str = [<span class="number">0x73</span>, <span class="number">0x62</span>, <span class="number">0x77</span>, <span class="number">0x60</span>, <span class="number">0x70</span>, <span class="number">0x63</span>, <span class="number">0x7D</span>, <span class="number">0x4F</span>, <span class="number">0x74</span>, <span class="number">0x70</span>,</span><br><span class="line">       <span class="number">0x5C</span>, <span class="number">0x70</span>, <span class="number">0x60</span>, <span class="number">0x67</span>, <span class="number">0x6D</span>, <span class="number">0x5E</span>, <span class="number">0x6B</span>, <span class="number">0x70</span>, <span class="number">0x5B</span>, <span class="number">0x6C</span>,</span><br><span class="line">       <span class="number">0x68</span>, <span class="number">0x5F</span>, <span class="number">0x74</span>, <span class="number">0x70</span>, <span class="number">0x64</span>, <span class="number">0x61</span>, <span class="number">0x6B</span>, <span class="number">0x72</span>, <span class="number">0x5F</span>, <span class="number">0x6F</span>,</span><br><span class="line">       <span class="number">0x67</span>, <span class="number">0x66</span>, <span class="number">0x60</span>, <span class="number">0x5A</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x5E</span>, <span class="number">0x70</span>, <span class="number">0x66</span>, <span class="number">0x72</span>,</span><br><span class="line">       <span class="number">0x60</span>, <span class="number">0x74</span>, <span class="number">0x73</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x73</span>, <span class="number">0x68</span>, <span class="number">0x64</span>, <span class="number">0x7F</span>, <span class="number">0x65</span>,</span><br><span class="line">       <span class="number">0x73</span>, <span class="number">0x71</span>, <span class="number">0x7E</span>]</span><br><span class="line">myinput = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Str)):</span><br><span class="line">    myinput.append(Str[i] ^ (i % <span class="number">7</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> myinput:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><h1 id="go"><a href="#go" class="headerlink" title="go"></a>go</h1><h3 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h3><p>çœ‹ç¨‹åºçš„main_mainã€main_main_func1ã€main_main_func2ã€main_main_func3ã€main_main_func4ã€main_main_func5å‡½æ•°</p><p>åé¢äº”ä¸ªfuncå‡½æ•°æ˜¯åˆ†åˆ«å¤„ç†è®¿é—®urlçš„å‚æ•°çš„ä¸åŒæ‰€æ‰§è¡Œçš„ã€‚</p><p>å…¶ä¸­func2å‡½æ•°ä¸­åŒ…å«scuctfå­—æ®µï¼ŒçŒœæµ‹å…¶ä¸ºæäº¤flagï¼Œå¹¶ä¸”æ£€æµ‹flagçš„åœ°æ–¹ã€‚</p><p>ä¸æ–­è°ƒè¯•è¯¥ç¨‹åºå¯ä»¥å‘ç°å˜æ¢flagçš„è¿‡ç¨‹ï¼Œé€šè¿‡åŠ¨æ€è°ƒè¯•å¯ä»¥å‘ç°flagçš„è½¬æ¢åªæ˜¯ä½ç½®ä¸Šçš„è½¬æ¢ï¼Œå› æ­¤ï¼Œå¯ä»¥æ ¹æ®è¾“å…¥çš„å­—ç¬¦ä¸²aå˜æ¢åçš„ç»“æœbï¼Œå»è·å–è¿™ä¸ªå˜æ¢çš„è¿‡ç¨‹</p><p><img src="/2022/11/18/SCU2022%E6%96%B0%E7%94%9F%E8%B5%9B/image-20221118170503198.png" alt="ä»£ç "></p><h3 id="è§£é¢˜è„šæœ¬-4"><a href="#è§£é¢˜è„šæœ¬-4" class="headerlink" title="è§£é¢˜è„šæœ¬"></a>è§£é¢˜è„šæœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">change = [<span class="number">0x30</span>, <span class="number">0x35</span>, <span class="number">0x61</span>, <span class="number">0x66</span>, <span class="number">0x6B</span>, <span class="number">0x70</span>, <span class="number">0x75</span>, <span class="number">0x31</span>, <span class="number">0x36</span>, <span class="number">0x62</span>,</span><br><span class="line">          <span class="number">0x67</span>, <span class="number">0x6C</span>, <span class="number">0x71</span>, <span class="number">0x76</span>, <span class="number">0x32</span>, <span class="number">0x37</span>, <span class="number">0x63</span>, <span class="number">0x68</span>, <span class="number">0x6D</span>, <span class="number">0x72</span>,</span><br><span class="line">          <span class="number">0x33</span>, <span class="number">0x38</span>, <span class="number">0x64</span>, <span class="number">0x69</span>, <span class="number">0x6E</span>, <span class="number">0x73</span>, <span class="number">0x34</span>, <span class="number">0x39</span>, <span class="number">0x65</span>, <span class="number">0x6A</span>,</span><br><span class="line">          <span class="number">0x6F</span>, <span class="number">0x74</span>]</span><br><span class="line">ch = <span class="string">&quot;0123456789abcdefghijklmnopqrstuv&quot;</span></span><br><span class="line">re = <span class="string">&quot;5r+cR6AoCc503=i45q/oR6Zyoq5LairI&quot;</span></span><br><span class="line">flag = [<span class="number">0</span>] * <span class="number">32</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(ch[i]) == change[j]:</span><br><span class="line">            flag[i] = <span class="built_in">ord</span>(re[j])</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><h1 id="logic"><a href="#logic" class="headerlink" title="logic"></a>logic</h1><h3 id="è§£é¢˜è¿‡ç¨‹-2"><a href="#è§£é¢˜è¿‡ç¨‹-2" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h3><p>æŸ¥è¯¢setjmpã€longjmpå‡½æ•°ç†æ¸…ç¨‹åºæµç¨‹ï¼Œä¸€å…±æœ‰ä¸‰ä¸ªå‡½æ•°ã€‚</p><p>ç¬¬ä¸€ä¸ªå‡½æ•°é€»è¾‘ä¸ºï¼šæ£€æŸ¥è¾“å…¥å­—ç¬¦ä¸²æ¯ä¸¤ä½ç»„åˆï¼Œå‰ä¸€ä¸ªç»„åˆç»„æˆçš„æ•°å°äºåä¸€ä¸ªç»„åˆç»„æˆçš„æ•°ï¼›</p><p>ç¬¬äºŒä¸ªå‡½æ•°é€»è¾‘ä¸ºï¼šæ ¹æ®è¾“å…¥å­—ç¬¦ä¸²å¯¹ä¸€ä¸ªæ•°ç»„è¿›è¡Œæ“ä½œï¼›</p><p>ç¬¬ä¸‰ä¸ªå‡½æ•°é€»è¾‘ä¸ºï¼šå…¶é€»è¾‘ç›¸å½“äºæ£€æŸ¥è¢«æ“ä½œæ•°ç»„çš„æ¯ä¸€ä¸ªå€¼ã€‚</p><p>ç”±äºè¢«æ“ä½œæ•°ç»„çš„ç»“æœæ­£çš„ç›¸åŠ ä¸º101ï¼Œä¸ºè¾“å…¥å­—ç¬¦ä¸²çš„ä¸€åŠï¼Œè€Œè´Ÿçš„ç›¸åŠ ä¸º96ï¼Œå¯ä»¥æ¨æ–­å‡ºæ¯ä¸ªç»„åˆçš„ç¬¬ä¸€ä¸ªæ•°å…¶å¯¹åº”æ•°ç»„çš„åœ°æ–¹åªåŠ ä¸å‡ï¼Œè€Œç¬¬äºŒä¸ªæ•°å…¶å¯¹åº”æ•°ç»„çš„åœ°æ–¹åªå‡ä¸åŠ ï¼Œä¸”å€’æ•°äº”ä¸ªç»„åˆçš„ç¬¬äºŒä¸ªæ•°å¿…é¡»ä¸ºZã€‚</p><h3 id="è§£é¢˜è„šæœ¬-5"><a href="#è§£é¢˜è„šæœ¬-5" class="headerlink" title="è§£é¢˜è„šæœ¬"></a>è§£é¢˜è„šæœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">changenum</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span> &lt;= num &lt;= <span class="number">9</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">chr</span>(num + <span class="number">48</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="number">10</span> &lt;= num &lt;= <span class="number">35</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">chr</span>(num + <span class="number">87</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="number">36</span> &lt;= num &lt;= <span class="number">62</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">chr</span>(num + <span class="number">29</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">changestr</span>(<span class="params">ch</span>):</span><br><span class="line">    num = <span class="built_in">ord</span>(ch)</span><br><span class="line">    <span class="keyword">if</span> <span class="number">48</span> &lt;= num &lt;= <span class="number">57</span>:</span><br><span class="line">        <span class="keyword">return</span> num - <span class="number">48</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="number">97</span> &lt;= num &lt;= <span class="number">122</span>:</span><br><span class="line">        <span class="keyword">return</span> num - <span class="number">87</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="number">65</span> &lt;= num &lt;= <span class="number">90</span>:</span><br><span class="line">        <span class="keyword">return</span> num - <span class="number">29</span></span><br><span class="line">a = [<span class="number">0x1</span>..<span class="number">.0</span>x5]</span><br><span class="line">frequencyOfNum = [<span class="number">0</span>] * <span class="number">62</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">62</span>):</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">        frequencyOfNum[i] = a[i]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        frequencyOfNum[i] = a[i] - a[i - <span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(frequencyOfNum[i], end=<span class="string">&quot;, &quot;</span>)</span><br><span class="line">result = [-<span class="number">1</span>] * <span class="number">202</span></span><br><span class="line">index1 = <span class="number">0</span></span><br><span class="line">index2 = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">62</span>):</span><br><span class="line">    <span class="keyword">if</span> frequencyOfNum[i] &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(frequencyOfNum[i]):</span><br><span class="line">            result[index1 * <span class="number">2</span>] = i</span><br><span class="line">            index1 += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> frequencyOfNum[i] &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(-frequencyOfNum[i]):</span><br><span class="line">            result[index2 * <span class="number">2</span> + <span class="number">1</span>] = i - <span class="number">1</span></span><br><span class="line">            index2 += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    result[index2 * <span class="number">2</span> + <span class="number">1</span>] = <span class="number">61</span></span><br><span class="line">    index2 += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span>, result)</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> result:</span><br><span class="line">    flag += changenum(i)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h1 id="pyc"><a href="#pyc" class="headerlink" title="pyc"></a>pyc</h1><p>å°†pycè½¬æ¢ä¸ºpyï¼Œå¯ä»¥çœ‹å‡ºç±»ä¼¼çŸ©é˜µè®¡ç®—ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">sss = <span class="string">&quot;99 ... 121674&quot;</span> // æ¡ä»¶ç­‰å¼</span><br><span class="line">ss = sss.split(<span class="string">&quot; and &quot;</span>)</span><br><span class="line">num = []</span><br><span class="line">r = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ss:</span><br><span class="line">    s = i.split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">    x = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">        x.append(<span class="built_in">int</span>(s[i * <span class="number">4</span>]))</span><br><span class="line">    num.append(x)</span><br><span class="line">    r.append(<span class="built_in">int</span>(s[<span class="number">100</span>]))</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">b = np.array(num)</span><br><span class="line">a = np.array(r)</span><br><span class="line">flag = np.linalg.solve(b, a)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">round</span>(i)), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><h1 id="xxx"><a href="#xxx" class="headerlink" title="xxx"></a>xxx</h1><p>ç¨‹åºä¸€å¼€å§‹ä¸ºæ£€æŸ¥å‡½æ•°è§£å¯†å‡ºæ¥ï¼Œè¿è¡Œå®Œè§£å¯†å‡½æ•°ï¼Œå°±å¯ä»¥çŸ¥é“æ£€æŸ¥å‡½æ•°äº†ï¼Œ</p><p>æ•…ä½¿ç”¨åŠ¨æ€è°ƒè¯•ï¼Œç„¶åçœ‹æ±‡ç¼–ä»£ç çŸ¥é“æ£€æŸ¥å‡½æ•°çš„æµç¨‹ï¼Œå¤§æ¦‚æ˜¯(input + 4) ^ 0x28ï¼Œç„¶åè¿›è¡Œæ¯”è¾ƒã€‚</p><h3 id="è§£é¢˜è„šæœ¬-6"><a href="#è§£é¢˜è„šæœ¬-6" class="headerlink" title="è§£é¢˜è„šæœ¬"></a>è§£é¢˜è„šæœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">b = [<span class="number">0x7E</span> ... <span class="number">0x00</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b) // <span class="number">4</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>((b[i * <span class="number">4</span>] ^ <span class="number">0x28</span>) - <span class="number">4</span>), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><h1 id="VM"><a href="#VM" class="headerlink" title="VM"></a>VM</h1><h3 id="è§£é¢˜è¿‡ç¨‹-3"><a href="#è§£é¢˜è¿‡ç¨‹-3" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h3><p>case0å¯¹åº”addï¼Œcase1å¯¹åº”subï¼Œcase2å¯¹åº”xorï¼Œcase3å¯¹åº”cmpï¼Œcase456å¯¹åº”å„ç±»jmpï¼Œcase7å¯¹åº”è·å–inputï¼Œcase8å¯¹åº”èµ‹å€¼inputï¼Œcase9å¯¹åº”è·å–å…·ä½“æ“ä½œã€‚</p><p>ä¸‰ä¸ªæ•°ç»„åˆ†åˆ«ä¸ºinputã€stackã€operationï¼Œindexè¢«æ”¾åœ¨äº†input[0x32]</p><p>ç„¶åå°±æ˜¯åŠ¨æ€è°ƒè¯•çœ‹ç¨‹åºçš„é€»è¾‘ï¼š</p><ul><li>input[i] &#x3D; input[i] ^ input[i+1]</li><li>input[i+1] &#x3D; ï¼ˆinput[i] - i) + input[i+1]</li><li>è¿›è¡Œç»“æœæ¯”è¾ƒ</li></ul><h3 id="è§£é¢˜è„šæœ¬-7"><a href="#è§£é¢˜è„šæœ¬-7" class="headerlink" title="è§£é¢˜è„šæœ¬"></a>è§£é¢˜è„šæœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">d = [<span class="number">0x3d</span>, <span class="number">0x56</span>, <span class="number">0x80</span>, <span class="number">0xb3</span>, <span class="number">0xc9</span>, <span class="number">0xf0</span>,</span><br><span class="line">     <span class="number">0x128</span>, <span class="number">0x15f</span>, <span class="number">0x180</span>, <span class="number">0x196</span>, <span class="number">0x1a7</span>, <span class="number">0x1a2</span>,</span><br><span class="line">     <span class="number">0x197</span>, <span class="number">0x19e</span>, <span class="number">0x19d</span>, <span class="number">0x1c1</span>, <span class="number">0x1e3</span>, <span class="number">0x1de</span>,</span><br><span class="line">     <span class="number">0x1ce</span>, <span class="number">0x1c6</span>, <span class="number">0x1b3</span>, <span class="number">0x1a5</span>, <span class="number">0x19a</span>, <span class="number">0x1e8</span>]</span><br><span class="line">c = [<span class="number">0</span>] * <span class="number">25</span></span><br><span class="line">d.reverse()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">23</span>):</span><br><span class="line">    c[i] = d[i] - d[i + <span class="number">1</span>] + (<span class="number">24</span> - i - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">23</span>):</span><br><span class="line">    c[i + <span class="number">1</span>] = c[i] ^ c[i + <span class="number">1</span>]</span><br><span class="line">c.reverse()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><h1 id="unity"><a href="#unity" class="headerlink" title="unity"></a>unity</h1><p>dnspyæ‰“å¼€Assembly-CSharp.dllï¼Œæ‰¾åˆ°å…¶æ–¹æ³•ã€å‡½æ•°ç­‰ï¼Œå‘ç°å…¶ä¸­æœ‰ä¸ªGameMangerï¼Œåº”è¯¥æ˜¯ç®¡ç†æ¸¸æˆçš„ç±»ï¼Œå†åœ¨å…¶ä¸­å‘ç°Updateæ–¹æ³•ï¼Œåº”è¯¥æ˜¯åˆ¤å®šæ¸¸æˆæ˜¯å¦å¯ä»¥ç»§ç»­ä»¥åŠç”»é¢æ›´æ–°çš„æ–¹æ³•ã€‚</p><p><img src="/2022/11/18/SCU2022%E6%96%B0%E7%94%9F%E8%B5%9B/clip_image002.png"></p><p>åœ¨å…¶ä¸­å‘ç°äº†Gameoverå˜é‡ï¼ŒçŒœæµ‹æ˜¯åˆ¤å®šæ¸¸æˆæ˜¯å¦å¯ä»¥ç»§ç»­çš„å€¼ï¼Œå°†èµ‹å€¼ä¸ºtrueçš„åœ°æ–¹æ›´æ”¹ä¸ºfalseï¼Œæ‰“å¼€æ¸¸æˆï¼Œæˆ‘ä¸æ­»äº†ã€‚</p><p><img src="/2022/11/18/SCU2022%E6%96%B0%E7%94%9F%E8%B5%9B/clip_image003.png" alt="ä»£ç "></p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TEAåŠ å¯†ä¸è§£å¯†</title>
      <link href="/2022/10/07/TEA%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86/"/>
      <url>/2022/10/07/TEA%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<h1 id="TEAåŠ å¯†è§£å¯†æµç¨‹"><a href="#TEAåŠ å¯†è§£å¯†æµç¨‹" class="headerlink" title="TEAåŠ å¯†è§£å¯†æµç¨‹"></a>TEAåŠ å¯†è§£å¯†æµç¨‹</h1><p>å‚è€ƒä»£ç ï¼š(æºè‡ªï¼š<a href="https://ctf-wiki.org/reverse/identify-encode-encryption/introduction/">å¸¸è§åŠ å¯†ç®—æ³•å’Œç¼–ç è¯†åˆ« - CTF Wiki (ctf-wiki.org)</a>)</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">encrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0</span>, i;           <span class="comment">/* set up */</span></span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                       <span class="comment">/* basic cycle start */</span></span><br><span class="line">        sum += delta;</span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);  </span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0xC6EF3720</span>, i;  <span class="comment">/* set up */</span></span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;                         <span class="comment">/* basic cycle start */</span></span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        sum -= delta;                                   </span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h3><ul><li>åœ¨å…¶ä»–çš„TEAåŠ å¯†è§£å¯†æµç¨‹ä¸­ï¼Œéƒ¨åˆ†è¿‡ç¨‹æˆ–è®¸æœ‰åå·®ï¼Œä½†æ•´ä½“ä¸Šè¿˜æ˜¯å¤§å·®ä¸å·®çš„ã€‚</li><li>æ³¨æ„ä½¿ç”¨çš„å˜é‡æ˜¯32ä½çš„unsigned intç±»å‹å˜é‡ã€‚</li></ul><h3 id="å…·ä½“ç¤ºä¾‹"><a href="#å…·ä½“ç¤ºä¾‹" class="headerlink" title="å…·ä½“ç¤ºä¾‹"></a>å…·ä½“ç¤ºä¾‹</h3><p>åœ¨æ­¤TEAåŠ å¯†æµç¨‹ä¸­ï¼Œv5ã€v6å¹¶ä¸å®Œå…¨æŒ‰ç…§ç¤ºä¾‹è¿›è¡Œï¼Œä½†åªè¦æŒ‰ç…§å…¶åæ€è·¯æ¥åšå°±å¯ä»¥äº†ã€‚</p><p><img src="/2022/10/07/TEA%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86/image-20221007171855238.png" alt="TEAåŠ å¯†"></p><p>è§£å¯†è„šæœ¬</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span><span class="params">(<span class="type">int</span> *res, <span class="type">int</span> *key)</span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v6=res[<span class="number">0</span>];</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v5=res[<span class="number">1</span>];</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> sum = <span class="number">0xC6EF3720</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> delta = <span class="number">0x61C88647</span>;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">0x1F</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">  v5 -= (((v6 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v6)) + v6) ^ (key[(sum&gt;&gt;<span class="number">11</span>)&amp;<span class="number">3</span>] + sum);</span><br><span class="line">    sum += <span class="number">0x61C88647</span>;</span><br><span class="line">    v6 -= (((v5 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v5)) + v5) ^ (key[sum&amp;<span class="number">3</span>] + sum);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;ç»“æœï¼š%x,%x\n&quot;</span>,v6,v5);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">encrypt</span><span class="params">(<span class="type">int</span> *res, <span class="type">int</span> *key)</span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v6=res[<span class="number">0</span>];</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v5=res[<span class="number">1</span>];</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> delta = <span class="number">0x61C88647</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">0x1F</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">  v6 += (((v5 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v5)) + v5) ^ (key[sum&amp;<span class="number">3</span>] + sum);</span><br><span class="line">  sum -= <span class="number">0x61C88647</span>;</span><br><span class="line">v5 += (((v6 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v6)) + v6) ^ (key[(sum&gt;&gt;<span class="number">11</span>)&amp;<span class="number">3</span>] + sum);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;ç»“æœï¼š%X,%X\n&quot;</span>,v6,v5);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="type">int</span> res[<span class="number">6</span>]=&#123;</span><br><span class="line"><span class="number">0xC11EE75A</span>, <span class="number">0xA4AD0973</span>,</span><br><span class="line"><span class="number">0xF61C9018</span>, <span class="number">0x32E37BCD</span>,</span><br><span class="line"><span class="number">0x2DCC1F26</span>, <span class="number">0x344380CC</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> key[<span class="number">4</span>]=&#123;</span><br><span class="line"><span class="number">0x010203</span>, <span class="number">0x04050607</span>, <span class="number">0x08090A0B</span>, <span class="number">0x0C0D0E0F</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</span><br><span class="line">decrypt(&amp;res[i*<span class="number">2</span>],key);</span><br><span class="line">&#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åæ‰€å¾—åˆ°çš„ç»“æœè¦æ³¨æ„æ˜¯å°ç«¯å­˜å‚¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ°ç‘çš„å½±åˆ†èº«â€”â€”bugku</title>
      <link href="/2022/10/05/%E6%9D%B0%E7%91%9E%E7%9A%84%E5%BD%B1%E5%88%86%E8%BA%AB%E2%80%94%E2%80%94bugku/"/>
      <url>/2022/10/05/%E6%9D%B0%E7%91%9E%E7%9A%84%E5%BD%B1%E5%88%86%E8%BA%AB%E2%80%94%E2%80%94bugku/</url>
      
        <content type="html"><![CDATA[<h1 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h1><p>ç®€å•æµè§ˆä¸‹ç¨‹åºæ€è·¯ï¼Œå¯ä»¥å‘ç°ç¨‹åºçš„è¾“å…¥ï¼Œä½†ç¨‹åºçš„ç»“æœæ¯”è¾ƒè¿‡ç¨‹åˆ™æ²¡æœ‰å‘ç°ã€‚</p><p><img src="/2022/10/05/%E6%9D%B0%E7%91%9E%E7%9A%84%E5%BD%B1%E5%88%86%E8%BA%AB%E2%80%94%E2%80%94bugku/image-20221005181311087.png" alt="main"></p><p><img src="/2022/10/05/%E6%9D%B0%E7%91%9E%E7%9A%84%E5%BD%B1%E5%88%86%E8%BA%AB%E2%80%94%E2%80%94bugku/image-20221005181336032.png" alt="sub_401670"></p><p><img src="/2022/10/05/%E6%9D%B0%E7%91%9E%E7%9A%84%E5%BD%B1%E5%88%86%E8%BA%AB%E2%80%94%E2%80%94bugku/image-20221005181419209.png" alt="sub_402770"></p><p>é€šè¿‡ç½‘ä¸Šæœç´¢ï¼Œåœ¨sub_402770çš„å‡½æ•°ä¸­Blockéƒ¨åˆ†åº”è¯¥ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘çŒœæµ‹å…·ä½“è¿‡ç¨‹æ˜¯ç”±å‰ä¸€å¥sub_401C40å‡½æ•°ç”Ÿæˆçš„ï¼Œå› æ­¤ç›´æ¥åœ¨è¿™ä¸‹æ–­ç‚¹ï¼Œç›´æ¥åŠ¨æ€è°ƒè¯•ã€‚</p><p>ç¨‹åºçš„æ¯”è¾ƒè¿‡ç¨‹è¿˜æ˜¯æ¯”è¾ƒæ˜æ˜¾çš„ï¼Œä½†è¿˜æ˜¯è°ƒè¯•äº†æˆ‘åŠå¤©ï¼Œå…·ä½“è¿‡ç¨‹å°±ä¸è´´å›¾äº†ã€‚</p><h3 id="ç¬¬ä¸€ä¸ªè¿‡ç¨‹"><a href="#ç¬¬ä¸€ä¸ªè¿‡ç¨‹" class="headerlink" title="ç¬¬ä¸€ä¸ªè¿‡ç¨‹"></a>ç¬¬ä¸€ä¸ªè¿‡ç¨‹</h3><p>å¯¹input[i]è¿›è¡Œå¼‚æˆ–4ï¼Œç„¶åå½“ i % 3 &#x3D;&#x3D; 1æ—¶ï¼Œè¿˜å°†input[i]ä¸ä¸€ä¸²å­—ç¬¦ä¸²ç¬¬ï¼ˆ3 * iï¼‰ä½å¼‚æˆ–ï¼ˆä½†æ ¹æ®è¯¥å­—ç¬¦ä¸²æ¥è¿›è¡Œè§£é¢˜æ—¶ï¼Œå‡ºç°çš„ç»“æœä¸å¤ªå¯¹ï¼Œå› æ­¤æˆ‘ç›´æ¥è®°å½•è¿›è¡Œå¼‚æˆ–çš„å­—ç¬¦ï¼Œç›´æ¥å¼‚æˆ–äº†ï¼‰</p><h3 id="ç¬¬äºŒä¸ªè¿‡ç¨‹"><a href="#ç¬¬äºŒä¸ªè¿‡ç¨‹" class="headerlink" title="ç¬¬äºŒä¸ªè¿‡ç¨‹"></a>ç¬¬äºŒä¸ªè¿‡ç¨‹</h3><p>å¯¹sub_4017B0å‡½æ•°ç”Ÿæˆçš„å­—ç¬¦ä¸²è¿›è¡Œå¤„ç†ã€‚</p><p><img src="/2022/10/05/%E6%9D%B0%E7%91%9E%E7%9A%84%E5%BD%B1%E5%88%86%E8%BA%AB%E2%80%94%E2%80%94bugku/image-20221005182710135.png" alt="sub_4017B0"></p><p>ç”±äºç¨‹åºçš„è¿›è¡Œï¼Œå¤„ç†åçš„å­—ç¬¦ä¸²å¯ä»¥ç›´æ¥è¯»å–ï¼Œå› æ­¤ä¸ç”¨ç®¡è¿‡ç¨‹ï¼Œç›´æ¥å¾—åˆ°ç»“æœã€‚</p><p><code>str1 = &quot;e4bdtRV02&quot;</code></p><p>åé¢çš„å­—ç¬¦è¢«ç¬¬åä½çš„ 0 æˆªæ–­äº†ï¼Œå› æ­¤åªæœ‰9ä½äº†ã€‚</p><h3 id="ç¬¬ä¸‰ä¸ªè¿‡ç¨‹"><a href="#ç¬¬ä¸‰ä¸ªè¿‡ç¨‹" class="headerlink" title="ç¬¬ä¸‰ä¸ªè¿‡ç¨‹"></a>ç¬¬ä¸‰ä¸ªè¿‡ç¨‹</h3><p>å°†å˜åŒ–åçš„input[i]ä¸sub_401BD0ï¼ˆiï¼‰æ‰€å¾—åˆ°çš„è¿”å›å€¼ + 2 è¿›è¡Œå¼‚æˆ–ã€‚</p><p><img src="/2022/10/05/%E6%9D%B0%E7%91%9E%E7%9A%84%E5%BD%B1%E5%88%86%E8%BA%AB%E2%80%94%E2%80%94bugku/image-20221005183346887.png" alt="subâ€”â€”401BD0"></p><p>åŒæ—¶å¦‚æœinputçš„å‰ä¹ä½ä¸str1çš„å‰ä¹ä½ç›¸åŠ ã€‚</p><p><img src="/2022/10/05/%E6%9D%B0%E7%91%9E%E7%9A%84%E5%BD%B1%E5%88%86%E8%BA%AB%E2%80%94%E2%80%94bugku/image-20221005183623391.png" alt="è°ƒè¯•å¾—åˆ°çš„ç¬¬ä¸‰ä¸ªè¿‡ç¨‹"></p><h1 id="è§£é¢˜è„šæœ¬"><a href="#è§£é¢˜è„šæœ¬" class="headerlink" title="è§£é¢˜è„šæœ¬"></a>è§£é¢˜è„šæœ¬</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">getnum</span>(<span class="params">a1</span>):</span><br><span class="line">    <span class="keyword">if</span> a1 == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">12</span></span><br><span class="line">    <span class="keyword">elif</span> a1 == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">11</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">str1 = <span class="string">&quot;e4bdtRV02&quot;</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;flag&#123;where is tom&#125;flag&#123;My cheese&#125;flag&#123;i miss tom&#125;&quot;</span></span><br><span class="line">str2 = <span class="string">&quot;gsleg&quot;</span></span><br><span class="line">strrrr = [<span class="number">0xD3</span>, <span class="number">0x38</span>, <span class="number">0xD1</span>, <span class="number">0xD3</span>, <span class="number">0x7B</span>, <span class="number">0xAD</span>, <span class="number">0xB3</span>, <span class="number">0x66</span>, <span class="number">0x71</span>, <span class="number">0x3A</span>,</span><br><span class="line">          <span class="number">0x59</span>, <span class="number">0x5F</span>, <span class="number">0x5F</span>, <span class="number">0x2D</span>, <span class="number">0x73</span>]</span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="number">9</span>:</span><br><span class="line">        flag.append((strrrr[i] - <span class="built_in">ord</span>(str1[i])) ^ getnum(i % <span class="number">3</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag.append((strrrr[i] ^ getnum(i % <span class="number">3</span>)))</span><br><span class="line">t = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">3</span> == <span class="number">1</span>:</span><br><span class="line">        flag[i] ^= <span class="built_in">ord</span>(str2[t])</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">    flag[i] ^= <span class="number">4</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Bingoâ€”â€”bugku</title>
      <link href="/2022/10/04/Bingo%E2%80%94%E2%80%94bugku/"/>
      <url>/2022/10/04/Bingo%E2%80%94%E2%80%94bugku/</url>
      
        <content type="html"><![CDATA[<h1 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h1><p>æ€è·¯ä¸»è¦å‚è€ƒç½‘ä¸Šwriteupï¼Œä¸€æ­¥æ­¥åšå‡ºæ¥çš„ã€‚</p><p>pngä¸­éšè—ç€exeæ–‡ä»¶</p><p><img src="/2022/10/04/Bingo%E2%80%94%E2%80%94bugku/1.png" alt="1"></p><p>MZæ–‡ä»¶å¤´ï¼Œå³ï¼ˆ4D5A9000â€¦)ï¼Œä»è¿™å¼€å§‹åˆ°æœ€åçš„å­—èŠ‚éƒ½æå–å‡ºæ¥ï¼Œä¸ºä¸€ä¸ªexeæ–‡ä»¶ã€‚æ­¤æ—¶çš„exeæ–‡ä»¶å› ä¸ºç¼ºå°‘PEå¤´æ— æ³•è¢«idaè¯†åˆ«ï¼Œå› æ­¤åŠ ä¸€ä¸ªPEå¤´ 50 45 00 00</p><p><img src="/2022/10/04/Bingo%E2%80%94%E2%80%94bugku/2.png" alt="2"></p><p>ä¹Ÿå¯ä»¥é€šè¿‡010editoråœ¨æ¨¡æ¿ä¸­ä¿®æ”¹</p><p><img src="/2022/10/04/Bingo%E2%80%94%E2%80%94bugku/3.png" alt="3"></p><p>ç”¨idaæ‰“å¼€è¯¥exeæ–‡ä»¶</p><p><img src="/2022/10/04/Bingo%E2%80%94%E2%80%94bugku/4.png" alt="4"></p><p>åˆ¤æ–­è¿™æ˜¯ä¸€ä¸ªè§£å¯†è¿‡ç¨‹ï¼Œå³ ä¸ºéƒ¨åˆ†å­—èŠ‚æ•°æ®è¿›è¡Œå¼‚æˆ–è§£å¯†ï¼Œç”¨è„šæœ¬è¿›è¡Œè§£å¯†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;C:\Users\hahbiubiubiu\Downloads\file\bingo.exe&quot;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:    </span><br><span class="line">    data = f.read() </span><br><span class="line">data = <span class="built_in">list</span>(data) </span><br><span class="line">text_segment_size = <span class="number">0x3E000</span> - <span class="number">0x1000</span> </span><br><span class="line"><span class="comment"># 0x3E000æ˜¯å¤§å° </span></span><br><span class="line"><span class="comment"># 0x1000æ˜¯åç§» </span></span><br><span class="line">key = <span class="number">0x22</span>  </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1000</span>, <span class="number">0x1000</span> + text_segment_size):</span><br><span class="line">    data[i] ^= key  </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;C:\Users\hahbiubiubiu\Downloads\file\bing0_xor.exe&quot;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f: </span><br><span class="line">    f.write(<span class="built_in">bytes</span>(data))</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œè„šæœ¬åå¾—åˆ°æ–°çš„exeæ–‡ä»¶ï¼Œidaæ‰“å¼€å®ƒ</p><p><img src="/2022/10/04/Bingo%E2%80%94%E2%80%94bugku/5.png" alt="5"></p><p>é™¤äº†å‰é¢çš„å¼‚æˆ–ï¼Œå®ƒè·³åˆ°äº†0x408BE0çš„ä½ç½®</p><p><img src="/2022/10/04/Bingo%E2%80%94%E2%80%94bugku/6.png" alt="6"></p><p> Edit-&gt;Segments-&gt;Rebase Progarmâ€¦-&gt;ä¿®æ”¹valueä¸º0</p><p><img src="/2022/10/04/Bingo%E2%80%94%E2%80%94bugku/7.png" alt="7"></p><p><img src="/2022/10/04/Bingo%E2%80%94%E2%80%94bugku/8.png" alt="8"></p><p>è¯¥å‡½æ•°åœ°å€ä¿®æ”¹ä¸º0x8BE0</p><p><img src="/2022/10/04/Bingo%E2%80%94%E2%80%94bugku/9.png" alt="9"></p><p>åœ¨010editorä¸­ä¿®æ”¹ç¨‹åºå…¥å£ç‚¹ä¸º0x8BE0</p><p><img src="/2022/10/04/Bingo%E2%80%94%E2%80%94bugku/10.png" alt="10"></p><p>å†æ¬¡ç”¨idaæ‰“å¼€exeæ–‡ä»¶å‘ç°ç¨‹åºå¤šäº†ä¸¤ä¸ªmainå‡½æ•°ï¼Œmain_0å‡½æ•°å°±æ˜¯ç¨‹åºä¸»é€»è¾‘</p><p><img src="/2022/10/04/Bingo%E2%80%94%E2%80%94bugku/11.png" alt="11"></p><p><img src="/2022/10/04/Bingo%E2%80%94%E2%80%94bugku/12.png" alt="12"></p><p>_strrevæ˜¯å¯¹å­—ç¬¦ä¸²è¿›è¡Œå€’è½¬çš„å‡½æ•°ï¼Œæ ¹æ®é€»è¾‘ï¼Œå†™å‡ºè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&quot;zaciWjV!Xm[_XSqeThmegndq&quot;</span> </span><br><span class="line">b = <span class="number">29</span> flag = <span class="string">&quot;&quot;</span> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    t = math.sqrt(<span class="built_in">pow</span>(<span class="built_in">ord</span>(a[<span class="built_in">int</span>(i/<span class="number">2</span>)]), <span class="number">2.0</span>) + <span class="built_in">pow</span>(b, <span class="number">2.0</span>)) + <span class="number">0.5</span>    </span><br><span class="line">    k = <span class="built_in">int</span>(t)    </span><br><span class="line">    b += <span class="number">1</span>    </span><br><span class="line">    flag += <span class="built_in">chr</span>(k)    </span><br><span class="line">    a = a[::-<span class="number">1</span>] <span class="built_in">print</span>(flag[::-<span class="number">1</span>]) </span><br><span class="line"><span class="comment"># flag&#123;woc_6p_tql_moshifu&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>babyLoginPlusâ€”â€”bugku</title>
      <link href="/2022/10/03/babyLoginPlus-bugku/"/>
      <url>/2022/10/03/babyLoginPlus-bugku/</url>
      
        <content type="html"><![CDATA[<h1 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h1><p>è¯¥é¢˜ä¸»è¦æ˜¯å‚ç…§å…¶ä»–å¤§ä½¬writeupçš„æ€è·¯ï¼Œå³æ‰¾åˆ°è¾“å…¥ï¼Œä¸‹æ–­ç‚¹ï¼Œæ ¹æ®æœ€åæ‰€å¾—åˆ°çš„æ¯”è¾ƒç­‰å¼æ¥ä¸€æ­¥æ­¥è°ƒè¯•å¾—åˆ°çš„ã€‚</p><h3 id="VM"><a href="#VM" class="headerlink" title="VM"></a>VM</h3><p>è¯¥å‡½æ•°åº”è¯¥æ˜¯ä½¿ç”¨vmå‡½æ•°çš„åœ°æ–¹</p><p><img src="/2022/10/03/babyLoginPlus-bugku/image-20221003131441527.png" alt="å…¥å£"></p><p>å› æ­¤åœ¨è¿™ä¸ªåœ°æ–¹ä¸‹äº†æ–­ç‚¹ä¹‹åï¼Œä¸€æ­¥æ­¥å¼€å§‹è°ƒè¯•ï¼Œçœ‹çœ‹ç¨‹åºçš„æ‰§è¡Œæµç¨‹</p><p>é¦–å…ˆï¼Œç¨‹åºçš„æ‰§è¡Œåˆ°è¿™ä¸ªåœ°æ–¹ï¼Œä¼šä¸æ–­é‡å¤æ‰§è¡Œï¼Œç„¶åæ ¹æ®è°ƒç”¨çš„å‡½æ•°æ¥è·å–è¾“å…¥ã€è¿›è¡Œæ¯”è¾ƒã€æ‰§è¡Œè¾“å‡ºã€‚</p><p>åœ¨å‰å‡ æ¬¡çš„æ‰§è¡Œä¸­ï¼ŒåŒ…å«äº†è·å–è¾“å…¥çš„å‡½æ•°ï¼Œå¾—åˆ°æˆ‘ä»¬çš„è¾“å…¥ã€‚</p><h3 id="æ¯”è¾ƒè¿‡ç¨‹"><a href="#æ¯”è¾ƒè¿‡ç¨‹" class="headerlink" title="æ¯”è¾ƒè¿‡ç¨‹"></a>æ¯”è¾ƒè¿‡ç¨‹</h3><p>è·å–è¾“å…¥åï¼Œç¨‹åºå¼€å§‹æ‰§è¡Œæ¯”è¾ƒï¼Œå…¶ä¸­æˆ‘ä¹Ÿä¸å¤ªæ¸…æ¥šéƒ¨åˆ†æ“ä½œçš„æµç¨‹ï¼Œå¯èƒ½æ˜¯è·å–æ•°æ®æˆ–è€…è§£ææ•°æ®ä»€ä¹ˆçš„ï¼Œå› æ­¤çœç•¥äº†ã€‚</p><p>è·å–input[i]çš„å­—ç¬¦æ›´æ–°ä¸ºinput[i]-9ã€‚</p><p><code>sub dex,ecx</code></p><p><img src="/2022/10/03/babyLoginPlus-bugku/image-20221003115001724.png" alt="input[i]-9"></p><p>è·å–æ“ä½œæ•° 0x26ã€‚</p><p><img src="/2022/10/03/babyLoginPlus-bugku/image-20221003115346614.png"></p><p>å°†input[i]ä¸ä¸Šä¸€ä¸ªå‡½æ•°è·å–çš„0x26å¼‚æˆ–ï¼Œå³input[i] &#x3D; input[i] ^ 0x26ã€‚</p><p><code>xor edx,ecx</code></p><p><img src="/2022/10/03/babyLoginPlus-bugku/image-20221003115613045.png" alt="å¼‚æˆ–0x26"></p><p>è·å–ç¨‹åºä¹‹å‰ç”Ÿæˆçš„Welcomeå­—ç¬¦ä¸²çš„ç¬¬iä¸ªå­—ç¬¦ã€‚</p><p><img src="/2022/10/03/babyLoginPlus-bugku/image-20221003120605295.png" alt="è·å–key"></p><p>å°†è·å–Welcomeå­—ç¬¦ä¸²çš„å­—ç¬¦å’Œä¹‹å‰å˜åŒ–åçš„input[i]è¿›è¡Œå¼‚æˆ–ã€‚</p><p><code>xor edx,ecx</code></p><p><img src="/2022/10/03/babyLoginPlus-bugku/image-20221003120903814.png" alt="å¼‚æˆ–key"></p><p>æ‰§è¡Œadd [eax], esi, å°†ä¸Šä¸€æ­¥å¼‚æˆ–å¾—åˆ°çš„çš„å­—ç¬¦åŠ ä¸Š6ã€‚</p><p><code>add [eax], esi</code></p><p><img src="/2022/10/03/babyLoginPlus-bugku/image-20221003121506365.png" alt="å˜åŒ–"></p><p>è·å–æœ€åç»“æœæ¯”è¾ƒæ‰€éœ€çš„æ•°ç»„ã€‚</p><p><img src="/2022/10/03/babyLoginPlus-bugku/image-20221003121637821.png"></p><p><img src="/2022/10/03/babyLoginPlus-bugku/image-20221003121735062.png"></p><p><img src="/2022/10/03/babyLoginPlus-bugku/image-20221003130820114.png" alt="ç»“æœæ•°ç»„"></p><p>è¿›è¡Œç»“æœæ¯”è¾ƒã€‚</p><p><code>cmp edi,ecx</code></p><p><img src="/2022/10/03/babyLoginPlus-bugku/image-20221003122048630.png" alt="ç»“æœæ¯”è¾ƒ"></p><h1 id="è§£é¢˜è„šæœ¬"><a href="#è§£é¢˜è„šæœ¬" class="headerlink" title="è§£é¢˜è„šæœ¬"></a>è§£é¢˜è„šæœ¬</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">result = [<span class="number">0x32</span>, <span class="number">0x26</span>, <span class="number">0x18</span>, <span class="number">0x21</span>, <span class="number">0x41</span>, <span class="number">0x23</span>, <span class="number">0x2A</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x29</span>, <span class="number">0x35</span>, <span class="number">0x12</span>, <span class="number">0x20</span>, <span class="number">0x17</span>, <span class="number">0x45</span>, <span class="number">0x1C</span>,</span><br><span class="line">       <span class="number">0x68</span>, <span class="number">0x2D</span>, <span class="number">0x7A</span>, <span class="number">0x79</span>, <span class="number">0x47</span>, <span class="number">0x7F</span>, <span class="number">0x44</span>, <span class="number">0x09</span>, <span class="number">0x1E</span>, <span class="number">0x75</span>, <span class="number">0x41</span>, <span class="number">0x2A</span>, <span class="number">0x19</span>, <span class="number">0x34</span>, <span class="number">0x76</span>, <span class="number">0x47</span>,</span><br><span class="line">       <span class="number">0x14</span>, <span class="number">0x50</span>, <span class="number">0x52</span>, <span class="number">0x76</span>, <span class="number">0x58</span>]</span><br><span class="line">key = [<span class="number">0x57</span>, <span class="number">0x65</span>, <span class="number">0x6C</span>, <span class="number">0x63</span>, <span class="number">0x6F</span>, <span class="number">0x6D</span>, <span class="number">0x65</span>, <span class="number">0x5F</span>, <span class="number">0x74</span>, <span class="number">0x6F</span>, <span class="number">0x5F</span>, <span class="number">0x73</span>, <span class="number">0x64</span>, <span class="number">0x6E</span>, <span class="number">0x69</span>, <span class="number">0x73</span>,</span><br><span class="line">       <span class="number">0x63</span>, <span class="number">0x5F</span>, <span class="number">0x32</span>, <span class="number">0x30</span>, <span class="number">0x31</span>, <span class="number">0x38</span>, <span class="number">0x5F</span>, <span class="number">0x42</span>, <span class="number">0x79</span>, <span class="number">0x2E</span>, <span class="number">0x5A</span>, <span class="number">0x65</span>, <span class="number">0x72</span>, <span class="number">0x6F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">       <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(((result[i]-<span class="number">0x6</span>) ^ <span class="number">0x26</span> ^ key[i])+<span class="number">9</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#flag&#123;_p1us_babyL0gin_pPpPpPpPp_p1us_&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ±¤å§†çš„è‹¹æœâ€”â€”bugku</title>
      <link href="/2022/09/27/%E6%B1%A4%E5%A7%86%E7%9A%84%E8%8B%B9%E6%9E%9C%E2%80%94%E2%80%94bugku/"/>
      <url>/2022/09/27/%E6%B1%A4%E5%A7%86%E7%9A%84%E8%8B%B9%E6%9E%9C%E2%80%94%E2%80%94bugku/</url>
      
        <content type="html"><![CDATA[<h1 id="è§£é¢˜è¿‡ç¨‹"><a href="#è§£é¢˜è¿‡ç¨‹" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h1><p>é¦–å…ˆï¼Œçœ‹<strong>MainActivity</strong>ï¼ŒçŒœæµ‹bä¸­<strong>handleMessage</strong>æ˜¯åˆ¤æ–­æœ€ç»ˆæ¡ä»¶ï¼Œ<strong>onClick</strong>æ˜¯æ£€éªŒflagæ–¹æ³•</p><p><img src="/2022/09/27/%E6%B1%A4%E5%A7%86%E7%9A%84%E8%8B%B9%E6%9E%9C%E2%80%94%E2%80%94bugku/1664414144444.png" alt="MainActivity"></p><p>ç„¶åæŸ¥çœ‹å¼•ç”¨è¾“å…¥å­—ç¬¦ä¸²objçš„aç±»ä¸­ï¼Œ<strong>doInBackground</strong>åº”è¯¥æ˜¯å¯¹è¾“å…¥å­—ç¬¦ä¸²è¿›è¡Œè§£å¯†</p><p><img src="/2022/09/27/%E6%B1%A4%E5%A7%86%E7%9A%84%E8%8B%B9%E6%9E%9C%E2%80%94%E2%80%94bugku/1664414485829.png" alt="ç±»a"></p><p>æŸ¥çœ‹<strong>doInBackground</strong>å¼•ç”¨çš„bç±»</p><p><img src="/2022/09/27/%E6%B1%A4%E5%A7%86%E7%9A%84%E8%8B%B9%E6%9E%9C%E2%80%94%E2%80%94bugku/1664414746576.png" alt="ç±»b"></p><p>å¯ä»¥çœ‹å‡ºè¿™æ˜¯å¯¹å­—ç¬¦ä¸²çš„ä¸€ä¸ªå¼‚æˆ–</p><p>å†å»çœ‹aç±»ä¸­çš„<strong>onPostExcute</strong>æ–¹æ³•ï¼Œä»¥åŠé™¤äº†aã€bç±»ä»¥å¤–çš„cç±»ï¼ŒçŒœæµ‹è¿™æ˜¯ä¸€èµ·ä¸ºæœ€åä¸ºæ£€æµ‹ç»“æœè¿›è¡Œåˆ¤å®šçš„æ–¹æ³•</p><p><img src="/2022/09/27/%E6%B1%A4%E5%A7%86%E7%9A%84%E8%8B%B9%E6%9E%9C%E2%80%94%E2%80%94bugku/1664414837113.png" alt="ç›®å½•"></p><p>cç±»ï¼Œå¯ä»¥çœ‹å‡ºè¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒç»“æœçš„æ–¹æ³•</p><p><img src="/2022/09/27/%E6%B1%A4%E5%A7%86%E7%9A%84%E8%8B%B9%E6%9E%9C%E2%80%94%E2%80%94bugku/1664414874587.png" alt="ç±»c"></p><h1 id="ç¨‹åºé€»è¾‘"><a href="#ç¨‹åºé€»è¾‘" class="headerlink" title="ç¨‹åºé€»è¾‘"></a>ç¨‹åºé€»è¾‘</h1><p>è¾“å…¥flagâ€“&gt;è¿›å…¥aç±»ä¸æ–­è¿›å…¥bç±»è¿›è¡Œå¾ªç¯â€“&gt;è¿›å…¥cç±»è¿›è¡Œç»“æœæ¯”è¾ƒ</p><h1 id="è§£é¢˜è„šæœ¬"><a href="#è§£é¢˜è„šæœ¬" class="headerlink" title="è§£é¢˜è„šæœ¬"></a>è§£é¢˜è„šæœ¬</h1><p>ç”±äºæŒ‰ç…§ç¨‹åºåŸæœ¬çš„é€»è¾‘ï¼Œæˆ‘å†™å‡ºçš„è„šæœ¬æ— æ³•ç”Ÿæˆflagï¼Œä¸”ç½‘ä¸Šæš‚æ—¶æ²¡æœ‰è¯¥é¢˜çš„writeupï¼Œæˆ‘åªå¥½ä½¿ç”¨å¦ä¸€ç§æ–¹æ³•ã€‚</p><p>ç¨‹åºçš„é€»è¾‘æ˜¯å°†å­—ç¬¦ä¸²ä¸æ–­åœ°è¿›è¡Œå¼‚æˆ–ï¼Œæœ€åçš„ç»“æœå…¶å®ç›¸å½“äºè¿›è¡Œä¸€æ¬¡å¼‚æˆ–ï¼Œè€Œè¿™ä¸€æ¬¡å¼‚æˆ–çš„æ•°å­—æ˜¯æœªçŸ¥ï¼Œå› æ­¤å¯ä»¥å†™ä¸€ä¸ªå¾ªç¯å»çˆ†ç ´å®ƒã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">final = [<span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;$&#x27;</span>, <span class="string">&#x27;%&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;v&#x27;</span>,</span><br><span class="line">         <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;a&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    num = [<span class="number">0</span>] * <span class="number">24</span></span><br><span class="line">    f = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> q <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(final)):</span><br><span class="line">        num[q] = (<span class="built_in">ord</span>(final[q]) ^ i)</span><br><span class="line">        <span class="keyword">if</span> num[q] &gt;= <span class="number">128</span>:</span><br><span class="line">            f = <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> num[q] &lt;= <span class="number">31</span>:</span><br><span class="line">            f = <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> f == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;the i is: &quot;</span>, i)</span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> num:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(t), end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"><span class="comment"># ç»“æœ</span></span><br><span class="line"><span class="comment"># the i is:  27</span></span><br><span class="line"><span class="comment"># akf`|mfntoa?&gt;543564mlmoz</span></span><br><span class="line"><span class="comment"># the i is:  28</span></span><br><span class="line"><span class="comment"># flag&#123;jaishf89234213jkjh&#125;</span></span><br><span class="line"><span class="comment"># the i is:  29</span></span><br><span class="line"><span class="comment"># gm`fzk`hrig98325302kjki|</span></span><br><span class="line"><span class="comment"># the i is:  30</span></span><br><span class="line"><span class="comment"># dnceyhckqjd:;016031hihj</span></span><br><span class="line"><span class="comment"># the i is:  31</span></span><br><span class="line"><span class="comment"># eobdxibjpke;:107120ihik~</span></span><br></pre></td></tr></table></figure><p><strong>flag{jaishf89234213jkjh}</strong></p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
